{"version":3,"file":"index.mjs","sources":["../lib/date.ts","../lib/registry.ts","../lib/translation.ts"],"sourcesContent":["/// <reference types=\"@nextcloud/typings\" />\n\ndeclare let window: Nextcloud.v27.WindowWithGlobals\n\n/**\n * Get the first day of the week\n *\n * @return {number}\n */\nexport function getFirstDay(): number {\n\tif (typeof window.firstDay === 'undefined') {\n\t\tconsole.warn('No firstDay found')\n\t\treturn 1\n\t}\n\n\treturn window.firstDay\n}\n\n/**\n * Get a list of day names (full names)\n *\n * @return {string[]}\n */\nexport function getDayNames(): string[] {\n\tif (typeof window.dayNames === 'undefined') {\n\t\tconsole.warn('No dayNames found')\n\t\treturn [\n\t\t\t'Sunday',\n\t\t\t'Monday',\n\t\t\t'Tuesday',\n\t\t\t'Wednesday',\n\t\t\t'Thursday',\n\t\t\t'Friday',\n\t\t\t'Saturday',\n\t\t]\n\t}\n\n\treturn window.dayNames\n}\n\n/**\n * Get a list of day names (short names)\n *\n * @return {string[]}\n */\nexport function getDayNamesShort(): string[] {\n\tif (typeof window.dayNamesShort === 'undefined') {\n\t\tconsole.warn('No dayNamesShort found')\n\t\treturn ['Sun.', 'Mon.', 'Tue.', 'Wed.', 'Thu.', 'Fri.', 'Sat.']\n\t}\n\n\treturn window.dayNamesShort\n}\n\n/**\n * Get a list of day names (minified names)\n *\n * @return {string[]}\n */\nexport function getDayNamesMin(): string[] {\n\tif (typeof window.dayNamesMin === 'undefined') {\n\t\tconsole.warn('No dayNamesMin found')\n\t\treturn ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa']\n\t}\n\n\treturn window.dayNamesMin\n}\n\n/**\n * Get a list of month names (full names)\n *\n * @return {string[]}\n */\nexport function getMonthNames(): string[] {\n\tif (typeof window.monthNames === 'undefined') {\n\t\tconsole.warn('No monthNames found')\n\t\treturn [\n\t\t\t'January',\n\t\t\t'February',\n\t\t\t'March',\n\t\t\t'April',\n\t\t\t'May',\n\t\t\t'June',\n\t\t\t'July',\n\t\t\t'August',\n\t\t\t'September',\n\t\t\t'October',\n\t\t\t'November',\n\t\t\t'December',\n\t\t]\n\t}\n\n\treturn window.monthNames\n}\n\n/**\n * Get a list of month names (short names)\n *\n * @return {string[]}\n */\nexport function getMonthNamesShort(): string[] {\n\tif (typeof window.monthNamesShort === 'undefined') {\n\t\tconsole.warn('No monthNamesShort found')\n\t\treturn [\n\t\t\t'Jan.',\n\t\t\t'Feb.',\n\t\t\t'Mar.',\n\t\t\t'Apr.',\n\t\t\t'May.',\n\t\t\t'Jun.',\n\t\t\t'Jul.',\n\t\t\t'Aug.',\n\t\t\t'Sep.',\n\t\t\t'Oct.',\n\t\t\t'Nov.',\n\t\t\t'Dec.',\n\t\t]\n\t}\n\n\treturn window.monthNamesShort\n}\n","/// <reference types=\"@nextcloud/typings\" />\n\n/**\n * Translation bundle\n *\n * @example For German translation\n * ```json\n\t{\n\t\t\"some\": \"einige\",\n\t\t\"_%n tree_::_%n trees_\": [\n\t\t\t\"%n Baum\",\n\t\t\t\"%n BÃ¤ume\"\n\t\t]\n\t}\n```\n */\nexport type Translations = Record<string, string | string[] | undefined>\n\n/**\n * Function for getting plural form index from translated number\n *\n * @param number Input number to translate\n * @return Index of translation plural form\n * @example For most languages, like English or German\n * ```js\n(number:number) => number === 1 ? 0 : 1\n```\n */\nexport type PluralFunction = (number: number) => number\n\n/**\n * Extended window interface with translation registry\n * Exported just for internal testing purpose\n *\n * @private\n */\nexport interface NextcloudWindowWithRegistry extends Nextcloud.v27.WindowWithGlobals {\n\t_oc_l10n_registry_translations?: Record<string, Translations>\n\t_oc_l10n_registry_plural_functions?: Record<string, PluralFunction>\n}\n\ndeclare const window: NextcloudWindowWithRegistry\n\ninterface AppTranslations {\n\ttranslations: Translations\n\tpluralFunction: PluralFunction\n}\n\n/**\n * Check if translations and plural function are set for given app\n *\n * @param {string} appId the app id\n * @return {boolean}\n */\nexport function hasAppTranslations(appId: string) {\n\treturn (\n\t\twindow._oc_l10n_registry_translations?.[appId] !== undefined\n\t\t&& window._oc_l10n_registry_plural_functions?.[appId] !== undefined\n\t)\n}\n\n/**\n * Register new, or extend available, translations for an app\n *\n * @param {string} appId the app id\n * @param {object} translations the translations list\n * @param {Function} pluralFunction the plural function\n */\nexport function registerAppTranslations(\n\tappId: string,\n\ttranslations: Translations,\n\tpluralFunction: PluralFunction,\n) {\n\twindow._oc_l10n_registry_translations = Object.assign(\n\t\twindow._oc_l10n_registry_translations || {},\n\t\t{\n\t\t\t[appId]: Object.assign(window._oc_l10n_registry_translations?.[appId] || {}, translations),\n\t\t},\n\t)\n\n\twindow._oc_l10n_registry_plural_functions = Object.assign(\n\t\twindow._oc_l10n_registry_plural_functions || {},\n\t\t{\n\t\t\t[appId]: pluralFunction,\n\t\t},\n\t)\n}\n\n/**\n * Unregister all translations and plural function for given app\n *\n * @param {string} appId the app id\n */\nexport function unregisterAppTranslations(appId: string) {\n\tdelete window._oc_l10n_registry_translations?.[appId]\n\tdelete window._oc_l10n_registry_plural_functions?.[appId]\n}\n\n/**\n * Get translations bundle for given app and current locale\n *\n * @param {string} appId the app id\n * @return {object}\n */\nexport function getAppTranslations(appId: string): AppTranslations {\n\treturn {\n\t\ttranslations: window._oc_l10n_registry_translations?.[appId] ?? {},\n\t\tpluralFunction: window._oc_l10n_registry_plural_functions?.[appId] ?? ((number: number) => number),\n\t}\n}\n","import type { Translations } from './registry'\nimport { getLanguage, getLocale } from './locale'\nimport {\n\tgetAppTranslations,\n\thasAppTranslations,\n\tregisterAppTranslations,\n\tunregisterAppTranslations,\n} from './registry'\nimport { generateFilePath } from '@nextcloud/router'\n\nimport DOMPurify from 'dompurify'\nimport escapeHTML from 'escape-html'\n\n/** @notExported */\ninterface TranslationOptions {\n\t/** enable/disable auto escape of placeholders (by default enabled) */\n\tescape?: boolean\n\t/** enable/disable sanitization (by default enabled) */\n\tsanitize?: boolean\n}\n\n/** @notExported */\ninterface TranslationVariableReplacementObject<T> {\n\t/** The value to use for the replacement */\n\tvalue: T\n\t/** Overwrite the `escape` option just for this replacement */\n\tescape: boolean\n}\n\n/** @notExported */\ntype TranslationVariables = Record<string, string | number | TranslationVariableReplacementObject<string | number>>\n\n/**\n * Translate a string\n *\n * @param {string} app the id of the app for which to translate the string\n * @param {string} text the string to translate\n * @param {object} vars map of placeholder key to value\n * @param {number} number to replace %n with\n * @param {object} [options] options object\n * @param {boolean} options.escape enable/disable auto escape of placeholders (by default enabled)\n * @param {boolean} options.sanitize enable/disable sanitization (by default enabled)\n *\n * @return {string}\n */\nexport function translate(\n\tapp: string,\n\ttext: string,\n\tvars?: TranslationVariables,\n\tnumber?: number,\n\toptions?: TranslationOptions,\n): string {\n\tconst allOptions = {\n\t\t// defaults\n\t\tescape: true,\n\t\tsanitize: true,\n\t\t// overwrite with user config\n\t\t...(options || {}),\n\t}\n\n\tconst identity = <T, >(value: T): T => value\n\tconst optSanitize = allOptions.sanitize ? DOMPurify.sanitize : identity\n\tconst optEscape = allOptions.escape ? escapeHTML : identity\n\n\tconst isValidReplacement = (value: unknown) => typeof value === 'string' || typeof value === 'number'\n\n\t// TODO: cache this function to avoid inline recreation\n\t// of the same function over and over again in case\n\t// translate() is used in a loop\n\tconst _build = (text: string, vars?: TranslationVariables, number?: number) => {\n\t\treturn text.replace(/%n/g, '' + number).replace(/{([^{}]*)}/g, (match, key) => {\n\t\t\tif (vars === undefined || !(key in vars)) {\n\t\t\t\treturn optEscape(match)\n\t\t\t}\n\n\t\t\tconst replacement = vars[key]\n\t\t\tif (isValidReplacement(replacement)) {\n\t\t\t\treturn optEscape(`${replacement}`)\n\t\t\t} else if (typeof replacement === 'object' && isValidReplacement(replacement.value)) {\n\t\t\t\t// Replacement is an object so indiviual escape handling\n\t\t\t\tconst escape = replacement.escape !== false ? escapeHTML : identity\n\t\t\t\treturn escape(`${replacement.value}`)\n\t\t\t} else {\n\t\t\t\t/* This should not happen,\n\t\t\t\t * but the variables are used defined so not allowed types could still be given,\n\t\t\t\t * in this case ignore the replacement and use the placeholder\n\t\t\t\t */\n\t\t\t\treturn optEscape(match)\n\t\t\t}\n\t\t})\n\t}\n\n\tconst bundle = getAppTranslations(app)\n\tlet translation = bundle.translations[text] || text\n\ttranslation = Array.isArray(translation) ? translation[0] : translation\n\n\tif (typeof vars === 'object' || number !== undefined) {\n\t\treturn optSanitize(_build(\n\t\t\ttranslation,\n\t\t\tvars,\n\t\t\tnumber,\n\t\t))\n\t} else {\n\t\treturn optSanitize(translation)\n\t}\n}\n\n/**\n * Translate a string containing an object which possibly requires a plural form\n *\n * @param {string} app the id of the app for which to translate the string\n * @param {string} textSingular the string to translate for exactly one object\n * @param {string} textPlural the string to translate for n objects\n * @param {number} number number to determine whether to use singular or plural\n * @param {object} vars of placeholder key to value\n * @param {object} options options object\n */\nexport function translatePlural(\n\tapp: string,\n\ttextSingular: string,\n\ttextPlural: string,\n\tnumber: number,\n\tvars?: Record<string, string | number>,\n\toptions?: TranslationOptions,\n): string {\n\tconst identifier = '_' + textSingular + '_::_' + textPlural + '_'\n\tconst bundle = getAppTranslations(app)\n\tconst value = bundle.translations[identifier]\n\n\tif (typeof value !== 'undefined') {\n\t\tconst translation = value\n\t\tif (Array.isArray(translation)) {\n\t\t\tconst plural = bundle.pluralFunction(number)\n\t\t\treturn translate(app, translation[plural], vars, number, options)\n\t\t}\n\t}\n\n\tif (number === 1) {\n\t\treturn translate(app, textSingular, vars, number, options)\n\t} else {\n\t\treturn translate(app, textPlural, vars, number, options)\n\t}\n}\n\n/**\n * Load an app's translation bundle if not loaded already.\n *\n * @param {string} appName name of the app\n * @param {Function} callback callback to be called when\n * the translations are loaded\n * @return {Promise} promise\n */\nexport function loadTranslations(appName: string, callback: (...args: []) => unknown) {\n\tinterface TranslationBundle {\n\t\ttranslations: Translations\n\t\tpluralForm: string\n\t}\n\n\tif (hasAppTranslations(appName) || getLocale() === 'en') {\n\t\treturn Promise.resolve().then(callback)\n\t}\n\n\tconst url = generateFilePath(appName, 'l10n', getLocale() + '.json')\n\n\tconst promise = new Promise<TranslationBundle>((resolve, reject) => {\n\t\tconst request = new XMLHttpRequest()\n\t\trequest.open('GET', url, true)\n\t\trequest.onerror = () => {\n\t\t\treject(new Error(request.statusText || 'Network error'))\n\t\t}\n\t\trequest.onload = () => {\n\t\t\tif (request.status >= 200 && request.status < 300) {\n\t\t\t\ttry {\n\t\t\t\t\tconst bundle = JSON.parse(request.responseText)\n\t\t\t\t\tif (typeof bundle.translations === 'object') resolve(bundle)\n\t\t\t\t} catch (error) {\n\t\t\t\t\t// error is probably a SyntaxError due to invalid response text, this is handled by next line\n\t\t\t\t}\n\t\t\t\treject(new Error('Invalid content of translation bundle'))\n\t\t\t} else {\n\t\t\t\treject(new Error(request.statusText))\n\t\t\t}\n\t\t}\n\t\trequest.send()\n\t})\n\n\t// load JSON translation bundle per AJAX\n\treturn promise\n\t\t.then((result) => {\n\t\t\tregister(appName, result.translations)\n\t\t\treturn result\n\t\t})\n\t\t.then(callback)\n}\n\n/**\n * Register an app's translation bundle.\n *\n * @param {string} appName name of the app\n * @param {Record<string, string>} bundle translation bundle\n */\nexport function register(appName: string, bundle: Translations) {\n\tregisterAppTranslations(appName, bundle, getPlural)\n}\n\n/**\n * Unregister all translations of an app\n *\n * @param appName name of the app\n * @since 2.1.0\n */\nexport function unregister(appName: string) {\n\treturn unregisterAppTranslations(appName)\n}\n\n/**\n * Get array index of translations for a plural form\n *\n *\n * @param {number} number the number of elements\n * @return {number} 0 for the singular form(, 1 for the first plural form, ...)\n */\nexport function getPlural(number: number) {\n\tlet language = getLanguage()\n\tif (language === 'pt-BR') {\n\t\t// temporary set a locale for brazilian\n\t\tlanguage = 'xbr'\n\t}\n\n\tif (language.length > 3) {\n\t\tlanguage = language.substring(0, language.lastIndexOf('-'))\n\t}\n\n\t/*\n\t * The plural rules are derived from code of the Zend Framework (2010-09-25),\n\t * which is subject to the new BSD license (http://framework.zend.com/license/new-bsd).\n\t * Copyright (c) 2005-2010 Zend Technologies USA Inc. (http://www.zend.com)\n\t */\n\tswitch (language) {\n\tcase 'az':\n\tcase 'bo':\n\tcase 'dz':\n\tcase 'id':\n\tcase 'ja':\n\tcase 'jv':\n\tcase 'ka':\n\tcase 'km':\n\tcase 'kn':\n\tcase 'ko':\n\tcase 'ms':\n\tcase 'th':\n\tcase 'tr':\n\tcase 'vi':\n\tcase 'zh':\n\t\treturn 0\n\n\tcase 'af':\n\tcase 'bn':\n\tcase 'bg':\n\tcase 'ca':\n\tcase 'da':\n\tcase 'de':\n\tcase 'el':\n\tcase 'en':\n\tcase 'eo':\n\tcase 'es':\n\tcase 'et':\n\tcase 'eu':\n\tcase 'fa':\n\tcase 'fi':\n\tcase 'fo':\n\tcase 'fur':\n\tcase 'fy':\n\tcase 'gl':\n\tcase 'gu':\n\tcase 'ha':\n\tcase 'he':\n\tcase 'hu':\n\tcase 'is':\n\tcase 'it':\n\tcase 'ku':\n\tcase 'lb':\n\tcase 'ml':\n\tcase 'mn':\n\tcase 'mr':\n\tcase 'nah':\n\tcase 'nb':\n\tcase 'ne':\n\tcase 'nl':\n\tcase 'nn':\n\tcase 'no':\n\tcase 'oc':\n\tcase 'om':\n\tcase 'or':\n\tcase 'pa':\n\tcase 'pap':\n\tcase 'ps':\n\tcase 'pt':\n\tcase 'so':\n\tcase 'sq':\n\tcase 'sv':\n\tcase 'sw':\n\tcase 'ta':\n\tcase 'te':\n\tcase 'tk':\n\tcase 'ur':\n\tcase 'zu':\n\t\treturn number === 1 ? 0 : 1\n\n\tcase 'am':\n\tcase 'bh':\n\tcase 'fil':\n\tcase 'fr':\n\tcase 'gun':\n\tcase 'hi':\n\tcase 'hy':\n\tcase 'ln':\n\tcase 'mg':\n\tcase 'nso':\n\tcase 'xbr':\n\tcase 'ti':\n\tcase 'wa':\n\t\treturn number === 0 || number === 1 ? 0 : 1\n\n\tcase 'be':\n\tcase 'bs':\n\tcase 'hr':\n\tcase 'ru':\n\tcase 'sh':\n\tcase 'sr':\n\tcase 'uk':\n\t\treturn number % 10 === 1 && number % 100 !== 11\n\t\t\t? 0\n\t\t\t: number % 10 >= 2\n\t\t\t\t  && number % 10 <= 4\n\t\t\t\t  && (number % 100 < 10 || number % 100 >= 20)\n\t\t\t\t? 1\n\t\t\t\t: 2\n\n\tcase 'cs':\n\tcase 'sk':\n\t\treturn number === 1 ? 0 : number >= 2 && number <= 4 ? 1 : 2\n\n\tcase 'ga':\n\t\treturn number === 1 ? 0 : number === 2 ? 1 : 2\n\n\tcase 'lt':\n\t\treturn number % 10 === 1 && number % 100 !== 11\n\t\t\t? 0\n\t\t\t: number % 10 >= 2 && (number % 100 < 10 || number % 100 >= 20)\n\t\t\t\t? 1\n\t\t\t\t: 2\n\n\tcase 'sl':\n\t\treturn number % 100 === 1\n\t\t\t? 0\n\t\t\t: number % 100 === 2\n\t\t\t\t? 1\n\t\t\t\t: number % 100 === 3 || number % 100 === 4\n\t\t\t\t\t? 2\n\t\t\t\t\t: 3\n\n\tcase 'mk':\n\t\treturn number % 10 === 1 ? 0 : 1\n\n\tcase 'mt':\n\t\treturn number === 1\n\t\t\t? 0\n\t\t\t: number === 0 || (number % 100 > 1 && number % 100 < 11)\n\t\t\t\t? 1\n\t\t\t\t: number % 100 > 10 && number % 100 < 20\n\t\t\t\t\t? 2\n\t\t\t\t\t: 3\n\n\tcase 'lv':\n\t\treturn number === 0\n\t\t\t? 0\n\t\t\t: number % 10 === 1 && number % 100 !== 11\n\t\t\t\t? 1\n\t\t\t\t: 2\n\n\tcase 'pl':\n\t\treturn number === 1\n\t\t\t? 0\n\t\t\t: number % 10 >= 2\n\t\t\t\t  && number % 10 <= 4\n\t\t\t\t  && (number % 100 < 12 || number % 100 > 14)\n\t\t\t\t? 1\n\t\t\t\t: 2\n\n\tcase 'cy':\n\t\treturn number === 1\n\t\t\t? 0\n\t\t\t: number === 2\n\t\t\t\t? 1\n\t\t\t\t: number === 8 || number === 11\n\t\t\t\t\t? 2\n\t\t\t\t\t: 3\n\n\tcase 'ro':\n\t\treturn number === 1\n\t\t\t? 0\n\t\t\t: number === 0 || (number % 100 > 0 && number % 100 < 20)\n\t\t\t\t? 1\n\t\t\t\t: 2\n\n\tcase 'ar':\n\t\treturn number === 0\n\t\t\t? 0\n\t\t\t: number === 1\n\t\t\t\t? 1\n\t\t\t\t: number === 2\n\t\t\t\t\t? 2\n\t\t\t\t\t: number % 100 >= 3 && number % 100 <= 10\n\t\t\t\t\t\t? 3\n\t\t\t\t\t\t: number % 100 >= 11 && number % 100 <= 99\n\t\t\t\t\t\t\t? 4\n\t\t\t\t\t\t\t: 5\n\n\tdefault:\n\t\treturn 0\n\t}\n}\n\n// Export short-hand\n\nexport {\n\ttranslate as t,\n\ttranslatePlural as n,\n}\n"],"names":["text","vars","number"],"mappings":"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"}