/*! third party licenses: js/vendor.LICENSE.txt */
import{n as H,V as Yt,s as ii,e as De,u as ed,d as Kr,g as nd,v as id,c as Ps,a as ma,b as ce,f as zs,r as ad,B as ne,U as Jr,h as Qr,_ as ga}from"./index-C8Z_p2SP.chunk.mjs";import{n as he,N as sd,u as od,c as rd,g as cd,a as ld,t as ud,l as dd,b as Ze,d as hd,e as pd,f as Bn,h as tc,L as fd,i as fi,j as Ht,k as ti,m as Ke,o as Bs,p as Xe,q as Jt,r as Je,s as ec,v as nc,w as md,x as $s,y as fn,I as Rs,z as ya,A as gd,B as yd,C as Hs,D as Ys,E as vd,F as _d,G as bd,V as ic,H as Cd}from"./index-D_VjvwME.chunk.mjs";import{s as ac,a as tt,C as sc,j as wd,M as kd,I as Pe,P as xd,e as is,b as as,c as Gt,d as Sd,f as Un,D as Md,g as Ad,S as ss,h as mn,i as va,k as Nd,l as Od,m as oc,n as Vs,N as Dd,o as Ld,t as za,p as Td,q as mi,r as Ed,O as Id,u as Us,v as ve,_ as Pd,w as rc,x as cc,y as zd,z as Bd,A as $d,B as lc,E as uc,F as Rd,G as Hd,H as ai,J as Yd,K as Gs,L as qo,Q as Vd,R as dc,T as Ud,U as Pi,V as Gd,W as hc,X as pc,Y as fc,Z as Ba,$ as zi,a0 as Fd,a1 as Bi,a2 as $a,a3 as os,a4 as $i,a5 as jd,a6 as Wd,a7 as qd,a8 as Xo}from"./style-DAlIvp5c.chunk.mjs";import{l as hn}from"./index-BiMVUFfi.chunk.mjs";import{e as Xd}from"./index-BQgRUePv.chunk.mjs";const Xr="contacts",Zr="7.3.1";var Zd=function(e,i,a){var s=(a||{}).moduleName||"route";e.registerModule(s,{namespaced:!0,state:rs(i.currentRoute),mutations:{ROUTE_CHANGED:function(h,u){e.state[s]=rs(u.to,u.from)}}});var o=!1,r,c=e.watch(function(h){return h[s]},function(h){var u=h.fullPath;u!==r&&(r!=null&&(o=!0,i.push(h)),r=u)},{sync:!0}),l=i.afterEach(function(h,u){if(o){o=!1;return}r=h.fullPath,e.commit(s+"/ROUTE_CHANGED",{to:h,from:u})});return function(){l?.(),c?.(),e.unregisterModule(s)}};function rs(e,i){var a={name:e.name,path:e.path,hash:e.hash,query:e.query,params:e.params,fullPath:e.fullPath,meta:e.meta};return i&&(a.from=rs(i)),Object.freeze(a)}const Kd={name:"ContactsRoot"};var Jd=function(){var e=this,i=e._self._c;return i("router-view")},Qd=[],th=H(Kd,Jd,Qd,!1,null,null);const eh=th.exports,nh={name:"NcActionSeparator"};var ih=function(){var e=this,i=e._self._c;return i("li",{staticClass:"action action-separator action--disabled",attrs:{role:"separator"}})},ah=[],sh=he(nh,ih,ah,!1,null,"3e2324b7");const oh=sh.exports,rh={name:"NcAppContentDetails"};var ch=function(){var e=this,i=e._self._c;return i("div",{staticClass:"app-content-details"},[e._t("default")],2)},lh=[],uh=he(rh,ch,lh,!1,null,null);const dh=uh.exports,hh={name:"NcAppContentList",props:{selection:{type:Boolean,default:!1},showDetails:{type:Boolean,default:!1}}};var ph=function(){var e=this,i=e._self._c;return i("div",{staticClass:"app-content-list",class:{selection:e.selection,showdetails:e.showDetails}},[e._t("default")],2)},fh=[],mh=he(hh,ph,fh,!1,null,null);const gh=mh.exports,yh={name:"NcAppNavigationList"};var vh=function(){var e=this,i=e._self._c;return i("ul",{staticClass:"app-navigation-list"},[e._t("default")],2)},_h=[],bh=he(yh,vh,_h,!1,null,"058e6060");const Ch=bh.exports,wh={name:"NcAppNavigation",components:{NcAppNavigationList:Ch,NcAppNavigationToggle:sd},inject:{setHasAppNavigation:{default:()=>()=>Yt.util.warn("NcAppNavigation is not mounted inside NcContent, this is probably an error."),from:"NcContent:setHasAppNavigation"}},props:{ariaLabel:{type:String,default:""},ariaLabelledby:{type:String,default:""}},setup(){return{isMobile:od()}},data(){return{open:!this.isMobile,focusTrap:null}},watch:{isMobile(){this.open=!this.isMobile,this.toggleFocusTrap()},open(){this.toggleFocusTrap()}},mounted(){this.setHasAppNavigation(!0),ii("toggle-navigation",this.toggleNavigationByEventBus),De("navigation-toggled",{open:this.open}),this.focusTrap=rd(this.$refs.appNavigationContainer,{allowOutsideClick:!0,fallbackFocus:this.$refs.appNavigationContainer,trapStack:cd(),escapeDeactivates:!1}),this.toggleFocusTrap(),ld("n",this.onKeyDown,{prevent:!0,stop:!0})},unmounted(){this.setHasAppNavigation(!1),ed("toggle-navigation",this.toggleNavigationByEventBus),this.focusTrap.deactivate()},methods:{async toggleNavigation(e){if(this.open===e){De("navigation-toggled",{open:this.open});return}this.open=typeof e>"u"?!this.open:e;const i=getComputedStyle(document.body),a=parseInt(i.getPropertyValue("--animation-quick"))||100;this.open&&(await this.$nextTick(),this.focusFirstElement()),setTimeout(()=>{De("navigation-toggled",{open:this.open})},1.5*a)},toggleNavigationByEventBus({open:e}){this.toggleNavigation(e)},toggleFocusTrap(){this.isMobile&&this.open?this.focusTrap.activate():this.focusTrap.deactivate()},handleEsc(){this.isMobile&&this.open&&this.toggleNavigation(!1)},focusFirstElement(){const e=ud(this.$refs.appNavigationContainer)[0];e&&(e.focus(),dd.debug("Focusing first element in the navigation",{element:e}))},onKeyDown(e){if(e.key==="n"){if(!this.open){this.toggleNavigation(!0);return}this.isFocusWithinNavigation()&&this.toggleNavigation(!1)}},isFocusWithinNavigation(){const e=document.activeElement;return this.$refs.appNavigationContainer?.contains(e)}}};var kh=function(){var e=this,i=e._self._c;return i("div",{ref:"appNavigationContainer",staticClass:"app-navigation",class:{"app-navigation--close":!e.open}},[i("nav",{staticClass:"app-navigation__content",attrs:{id:"app-navigation-vue","aria-hidden":e.open?"false":"true","aria-label":e.ariaLabel||void 0,"aria-labelledby":e.ariaLabelledby||void 0,inert:!e.open||void 0},on:{keydown:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"esc",27,a.key,["Esc","Escape"])?null:e.handleEsc.apply(null,arguments)}}},[i("div",{staticClass:"app-navigation__search"},[e._t("search")],2),i("div",{staticClass:"app-navigation__body",class:{"app-navigation__body--no-list":!e.$scopedSlots.list}},[e._t("default")],2),e.$scopedSlots.list?i("NcAppNavigationList",{staticClass:"app-navigation__list"},[e._t("list")],2):e._e(),e._t("footer")],2),i("NcAppNavigationToggle",{attrs:{open:e.open},on:{"update:open":e.toggleNavigation}})],1)},xh=[],Sh=he(wh,kh,xh,!1,null,"6d2acd3d");const Mh=Sh.exports,Ah={name:"NcAppNavigationCaption",components:{NcActions:Ze},inheritAttrs:!1,props:{name:{type:String,required:!0},headingId:{type:String,default:null},isHeading:{type:Boolean,default:!1},headingLevel:{type:Number,default:2}," ":{}},computed:{wrapperTag(){return this.isHeading?"div":"li"},captionTag(){const e=Math.max(2,this.headingLevel);return this.isHeading?`h${e}`:"span"},hasActions(){return!!this.$slots.actions}}};var Nh=function(){var e=this,i=e._self._c;return i(e.wrapperTag,{tag:"component",staticClass:"app-navigation-caption",class:{"app-navigation-caption--heading":e.isHeading}},[i(e.captionTag,{tag:"component",staticClass:"app-navigation-caption__name",attrs:{id:e.headingId}},[e._v(" "+e._s(e.name)+" ")]),e.hasActions?i("div",{staticClass:"app-navigation-caption__actions"},[i("NcActions",e._g(e._b({scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("actionsTriggerIcon")]},proxy:!0}],null,!0)},"NcActions",e.$attrs,!1),e.$listeners),[e._t("actions")],2)],1):e._e()],1)},Oh=[],Dh=he(Ah,Nh,Oh,!1,null,"1133b4da");const Lh=Dh.exports,Th={name:"NcAppSettingsSection",inject:["registerSection","unregisterSection"],props:{name:{type:String,required:!0},id:{type:String,required:!0,validator(e){return/^[a-z0-9\-_]+$/.test(e)}}},computed:{htmlId(){return"settings-section_"+this.id}},watch:{id(e,i){this.unregisterSection(i),this.registerSection(e,this.name,this.$slots?.icon)},name(e){this.unregisterSection(this.id),this.registerSection(this.id,e,this.$slots?.icon)}},mounted(){this.registerSection(this.id,this.name,this.$slots?.icon)},beforeDestroy(){this.unregisterSection(this.id)}};var Eh=function(){var e=this,i=e._self._c;return i("section",{staticClass:"app-settings-section",attrs:{id:e.htmlId,"aria-labelledby":`${e.htmlId}--label`}},[i("h3",{staticClass:"app-settings-section__name",attrs:{id:`${e.htmlId}--label`}},[e._v(" "+e._s(e.name)+" ")]),e._t("default"),e._e()],2)},Ih=[],Ph=he(Th,Eh,Ih,!1,null,"e970c9f7");const zh=Ph.exports,Bh={name:"NcCounterBubble",props:{type:{type:String,default:"",validator(e){return["highlighted","outlined",""].includes(e)}},active:{type:Boolean,default:!1},count:{type:Number,required:!1,default:void 0},raw:{type:Boolean,required:!1,default:!1}},computed:{counterClassObject(){return{"counter-bubble__counter--highlighted":this.type==="highlighted","counter-bubble__counter--outlined":this.type==="outlined",active:this.active}},humanizedCount(){return this.humanizeCount(this.count)}},methods:{humanizeCount(e){return this.raw?e.toString():new Intl.NumberFormat(hd(),{notation:"compact",compactDisplay:"short"}).format(e)},getHumanizedCount(){if(this.count!==void 0)return{humanized:this.humanizedCount,original:this.count.toString()};if(!this.raw&&this.$slots.default?.length===1){const e=this.$slots.default[0].text?.trim();if(e&&/^\d+$/.test(e)){const i=parseInt(e,10);return{humanized:this.humanizeCount(i),original:e}}}}},render(e){const i=this.getHumanizedCount();return e("div",{staticClass:"counter-bubble__counter",class:this.counterClassObject,attrs:{title:i&&i.original!==i.humanized?i.original:void 0}},[i?.humanized??this.$slots.default])}},$h=null,Rh=null;var Hh=he(Bh,$h,Rh,!1,null,"f1abaa29");const _a=Hh.exports,Yh={name:"NcListItem",components:{NcActions:Ze,NcCounterBubble:_a,NcVNodes:pd},props:{details:{type:String,default:""},name:{type:String,default:void 0},exact:{type:Boolean,default:!1},to:{type:[String,Object],default:null},href:{type:String,default:"#"},target:{type:String,default:""},anchorId:{type:String,default:""},bold:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},active:{type:Boolean,default:!1},linkAriaLabel:{type:String,default:""},actionsAriaLabel:{type:String,default:void 0},counterNumber:{type:[Number,String],default:0},counterType:{type:String,default:"",validator(e){return["highlighted","outlined",""].indexOf(e)!==-1}},forceDisplayActions:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},oneLine:{type:Boolean,default:!1}},emits:["click","update:menuOpen"],setup(){const[e]=window._oc_config?.version.split(".",2)??[];return{isLegacy:e&&Number.parseInt(e)<30}},data(){return{hovered:!1,hasActions:!1,hasSubname:!1,displayActionsOnHoverFocus:!1,menuOpen:!1,hasIndicator:!1,hasDetails:!1}},computed:{showAdditionalElements(){return!this.displayActionsOnHoverFocus||this.forceDisplayActions},showDetails(){return(this.details!==""||this.hasDetails)&&(!this.displayActionsOnHoverFocus||this.forceDisplayActions)}},watch:{menuOpen(e){!e&&!this.hovered&&(this.displayActionsOnHoverFocus=!1)}},mounted(){this.checkSlots()},updated(){this.checkSlots()},methods:{onClick(e,i,a){this.$emit("click",e),!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&a&&(i?.(e),e.preventDefault())},showActions(){this.hasActions&&(this.displayActionsOnHoverFocus=!0),this.hovered=!1},hideActions(){this.displayActionsOnHoverFocus=!1},handleBlur(e){this.menuOpen||this.$refs["list-item"].contains(e.relatedTarget)||this.hideActions()},handleMouseleave(){this.menuOpen||(this.displayActionsOnHoverFocus=!1),this.hovered=!1},handleMouseover(){this.showActions(),this.hovered=!0},handleActionsUpdateOpen(e){this.menuOpen=e,this.$emit("update:menuOpen",e)},checkSlots(){this.hasActions!==!!this.$slots.actions&&(this.hasActions=!!this.$slots.actions),this.hasSubname!==!!this.$slots.subname&&(this.hasSubname=!!this.$slots.subname),this.hasIndicator!==!!this.$slots.indicator&&(this.hasIndicator=!!this.$slots.indicator),this.hasDetails!==!!this.$slots.details&&(this.hasDetails=!!this.$slots.details)}}};var Vh=function(){var e=this,i=e._self._c;return i(e.to?"router-link":"NcVNodes",{tag:"component",attrs:{custom:e.to?!0:null,to:e.to,exact:e.to?e.exact:null},scopedSlots:e._u([{key:"default",fn:function({href:a,navigate:s,isActive:o}){return[i("li",{staticClass:"list-item__wrapper",class:{"list-item__wrapper--active":o||e.active}},[i("div",{ref:"list-item",staticClass:"list-item",class:{"list-item--compact":e.compact,"list-item--legacy":e.isLegacy,"list-item--one-line":e.oneLine},on:{mouseover:e.handleMouseover,mouseleave:e.handleMouseleave}},[i("a",{staticClass:"list-item__anchor",attrs:{id:e.anchorId||void 0,"aria-label":e.linkAriaLabel,href:a||e.href,target:e.target||(e.href==="#"?void 0:"_blank"),rel:e.href==="#"?void 0:"noopener noreferrer"},on:{focus:e.showActions,focusout:e.handleBlur,click:function(r){return e.onClick(r,s,a)},keydown:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"esc",27,r.key,["Esc","Escape"])?null:e.hideActions.apply(null,arguments)}}},[e._t("icon"),i("div",{staticClass:"list-item-content"},[i("div",{staticClass:"list-item-content__main"},[i("div",{staticClass:"list-item-content__name"},[e._t("name",function(){return[e._v(e._s(e.name))]})],2),e.hasSubname?i("div",{staticClass:"list-item-content__subname",class:{"list-item-content__subname--bold":e.bold}},[e._t("subname")],2):e._e()]),i("div",{staticClass:"list-item-content__details"},[e.showDetails?i("div",{staticClass:"list-item-details__details"},[e._t("details",function(){return[e._v(e._s(e.details))]})],2):e._e(),e.counterNumber||e.hasIndicator?i("div",{directives:[{name:"show",rawName:"v-show",value:e.showAdditionalElements,expression:"showAdditionalElements"}],staticClass:"list-item-details__extra"},[e.counterNumber?i("NcCounterBubble",{staticClass:"list-item-details__counter",attrs:{active:o||e.active,type:e.counterType}},[e._v(" "+e._s(e.counterNumber)+" ")]):e._e(),e.hasIndicator?i("span",{staticClass:"list-item-details__indicator"},[e._t("indicator")],2):e._e()],1):e._e()])])],2),e.$slots["extra-actions"]?i("div",{staticClass:"list-item-content__extra-actions"},[e._t("extra-actions")],2):e._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:e.forceDisplayActions||e.displayActionsOnHoverFocus,expression:"forceDisplayActions || displayActionsOnHoverFocus"}],staticClass:"list-item-content__actions",on:{focusout:e.handleBlur}},[i("NcActions",{ref:"actions",attrs:{primary:o||e.active,"force-menu":e.forceMenu,"aria-label":e.actionsAriaLabel},on:{"update:open":e.handleActionsUpdateOpen},scopedSlots:e._u([e.$slots["actions-icon"]?{key:"icon",fn:function(){return[e._t("actions-icon")]},proxy:!0}:null],null,!0)},[e._t("actions")],2)],1),e.$slots.extra?i("div",{staticClass:"list-item__extra"},[e._t("extra")],2):e._e()])])]}}],null,!0)})},Uh=[],Gh=he(Yh,Vh,Uh,!1,null,"40599719");const mc=Gh.exports,Fh={name:"NcUserBubbleDiv"};var jh=function(){var e=this,i=e._self._c;return i("div",[e._t("trigger")],2)},Wh=[],qh=he(Fh,jh,Wh,!1,null,null);const Xh=qh.exports,Zh={name:"NcUserBubble",components:{NcAvatar:Bn,NcPopover:tc,NcUserBubbleDiv:Xh},props:{avatarImage:{type:String,default:void 0},user:{type:String,default:void 0},displayName:{type:String,default:void 0},showUserStatus:{type:Boolean,default:!1},url:{type:String,default:void 0,validator:e=>{try{return e=new URL(e,e?.startsWith?.("/")?window.location.href:void 0),!0}catch{return!1}}},to:{type:[String,Object],default:void 0},open:{type:Boolean,default:!1},primary:{type:Boolean,default:!1},size:{type:Number,default:20},margin:{type:Number,default:2}},emits:["click","update:open"],computed:{isPopoverComponent(){return this.popoverEmpty?"NcUserBubbleDiv":"NcPopover"},isAvatarUrl(){if(!this.avatarImage)return!1;try{return!!new URL(this.avatarImage)}catch{return!1}},isCustomAvatar(){return!!this.avatarImage},hasUrl(){return this.url&&this.url.trim()!==""},isLinkComponent(){return this.hasUrl?"a":this.to?fd:"div"},popoverEmpty(){return!("default"in this.$slots)},styles(){return{content:{height:this.size+"px",lineHeight:this.size+"px",borderRadius:this.size/2+"px"},avatar:{marginInlineStart:this.margin+"px"}}}},mounted(){!this.displayName&&!this.user&&Yt.util.warn("[NcUserBubble] At least `displayName` or `user` property should be set.")},methods:{onOpenChange(e){this.$emit("update:open",e)},onClick(e){this.$emit("click",e)}}};var Kh=function(){var e=this,i=e._self._c;return i(e.isPopoverComponent,{tag:"component",staticClass:"user-bubble__wrapper",attrs:{trigger:"hover focus",shown:e.open},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"trigger",fn:function({attrs:a}){return[i(e.isLinkComponent,e._b({tag:"component",staticClass:"user-bubble__content",class:{"user-bubble__content--primary":e.primary},style:e.styles.content,attrs:{to:e.to,href:e.hasUrl?e.url:null},on:{click:e.onClick}},"component",a,!1),[i("NcAvatar",{staticClass:"user-bubble__avatar",style:e.styles.avatar,attrs:{url:e.isCustomAvatar&&e.isAvatarUrl?e.avatarImage:void 0,"icon-class":e.isCustomAvatar&&!e.isAvatarUrl?e.avatarImage:void 0,user:e.user,"display-name":e.displayName,size:e.size-e.margin*2,"disable-tooltip":!0,"disable-menu":!0,"show-user-status":e.showUserStatus}}),i("span",{staticClass:"user-bubble__name"},[e._v(" "+e._s(e.displayName||e.user)+" ")]),e.$slots.name?i("span",{staticClass:"user-bubble__secondary"},[e._t("name")],2):e._e()],1)]}}],null,!0)},[e._t("default")],2)},Jh=[],Qh=he(Zh,Kh,Jh,!1,null,"a62a9496");const Fs=Qh.exports,tp={name:"AccountGroupOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ep=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon account-group-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,5A3.5,3.5 0 0,0 8.5,8.5A3.5,3.5 0 0,0 12,12A3.5,3.5 0 0,0 15.5,8.5A3.5,3.5 0 0,0 12,5M12,7A1.5,1.5 0 0,1 13.5,8.5A1.5,1.5 0 0,1 12,10A1.5,1.5 0 0,1 10.5,8.5A1.5,1.5 0 0,1 12,7M5.5,8A2.5,2.5 0 0,0 3,10.5C3,11.44 3.53,12.25 4.29,12.68C4.65,12.88 5.06,13 5.5,13C5.94,13 6.35,12.88 6.71,12.68C7.08,12.47 7.39,12.17 7.62,11.81C6.89,10.86 6.5,9.7 6.5,8.5C6.5,8.41 6.5,8.31 6.5,8.22C6.2,8.08 5.86,8 5.5,8M18.5,8C18.14,8 17.8,8.08 17.5,8.22C17.5,8.31 17.5,8.41 17.5,8.5C17.5,9.7 17.11,10.86 16.38,11.81C16.5,12 16.63,12.15 16.78,12.3C16.94,12.45 17.1,12.58 17.29,12.68C17.65,12.88 18.06,13 18.5,13C18.94,13 19.35,12.88 19.71,12.68C20.47,12.25 21,11.44 21,10.5A2.5,2.5 0 0,0 18.5,8M12,14C9.66,14 5,15.17 5,17.5V19H19V17.5C19,15.17 14.34,14 12,14M4.71,14.55C2.78,14.78 0,15.76 0,17.5V19H3V17.07C3,16.06 3.69,15.22 4.71,14.55M19.29,14.55C20.31,15.22 21,16.06 21,17.07V19H24V17.5C24,15.76 21.22,14.78 19.29,14.55M12,16C13.53,16 15.24,16.5 16.23,17H7.77C8.76,16.5 10.47,16 12,16Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},np=[],ip=H(tp,ep,np,!1,null,null);const ba=ip.exports,ap={name:"CogOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var sp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon cog-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.93C8.5,18.68 7.96,18.34 7.44,17.94L4.95,18.95C4.73,19.03 4.46,18.95 4.34,18.73L2.34,15.27C2.21,15.05 2.27,14.78 2.46,14.63L4.57,12.97L4.5,12L4.57,11L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.5,5.32 9.13,5.07L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.07C15.5,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.79,8.95 21.73,9.22 21.54,9.37L19.43,11L19.5,12L19.43,13L21.54,14.63C21.73,14.78 21.79,15.05 21.66,15.27L19.66,18.73C19.54,18.95 19.27,19.04 19.05,18.95L16.56,17.95C16.04,18.34 15.5,18.68 14.87,18.93L14.5,21.58C14.46,21.82 14.25,22 14,22H10M11.25,4L10.88,6.61C9.68,6.86 8.62,7.5 7.85,8.39L5.44,7.35L4.69,8.65L6.8,10.2C6.4,11.37 6.4,12.64 6.8,13.8L4.68,15.36L5.43,16.66L7.86,15.62C8.63,16.5 9.68,17.14 10.87,17.38L11.24,20H12.76L13.13,17.39C14.32,17.14 15.37,16.5 16.14,15.62L18.57,16.66L19.32,15.36L17.2,13.81C17.6,12.64 17.6,11.37 17.2,10.2L19.31,8.65L18.56,7.35L16.15,8.39C15.38,7.5 14.32,6.86 13.12,6.62L12.75,4H11.25Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},op=[],rp=H(ap,sp,op,!1,null,null);const js=rp.exports,cp={name:"LoginIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var lp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon login-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M11 7L9.6 8.4L12.2 11H2V13H12.2L9.6 15.6L11 17L16 12L11 7M20 19H12V21H20C21.1 21 22 20.1 22 19V5C22 3.9 21.1 3 20 3H12V5H20V19Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},up=[],dp=H(cp,lp,up,!1,null,null);const hp=dp.exports,pp={name:"LogoutIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var fp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon logout-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M17 7L15.59 8.41L18.17 11H8V13H18.17L15.59 15.58L17 17L22 12M4 5H12V3H4C2.9 3 2 3.9 2 5V19C2 20.1 2.9 21 4 21H12V19H4V5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},mp=[],gp=H(pp,fp,mp,!1,null,null);const gc=gp.exports,yp={name:"AccountPlusOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var vp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon account-plus-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4M15,5.9C16.16,5.9 17.1,6.84 17.1,8C17.1,9.16 16.16,10.1 15,10.1A2.1,2.1 0 0,1 12.9,8A2.1,2.1 0 0,1 15,5.9M4,7V10H1V12H4V15H6V12H9V10H6V7H4M15,13C12.33,13 7,14.33 7,17V20H23V17C23,14.33 17.67,13 15,13M15,14.9C17.97,14.9 21.1,16.36 21.1,17V18.1H8.9V17C8.9,16.36 12,14.9 15,14.9Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},_p=[],bp=H(yp,vp,_p,!1,null,null);const yc=bp.exports,Cp={name:"FileDocumentOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var wp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon file-document-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M6,2A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6M6,4H13V9H18V20H6V4M8,12V14H16V12H8M8,16V18H13V16H8Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},kp=[],xp=H(Cp,wp,kp,!1,null,null);const Sp=xp.exports,vc={data(){return{copied:!1,copyLoading:!1,copySuccess:!1}},computed:{copyLinkIcon(){return this.copySuccess?"icon-checkmark":this.copyLoading?"icon-loading-small":"icon-public"}},methods:{async copyToClipboard(e){this.copyLoading=!0;try{await navigator.clipboard.writeText(e),this.copySuccess=!0,this.copied=!0,ac(t("contacts","Link copied to the clipboard"))}catch{this.copySuccess=!1,this.copied=!0,tt(t("contacts","Could not copy link to the clipboard."))}finally{this.copyLoading=!1,setTimeout(()=>{this.copied=!1,this.copySuccess=!1},2e3)}}}},_c={props:{circle:{type:sc,required:!0}},mixins:[vc],data(){return{loadingAction:!1,loadingJoin:!1}},computed:{copyButtonText(){return this.copied?this.copySuccess?t("contacts","Copied"):t("contacts","Could not copy"):t("contacts","Copy link")},circleUrl(){const e=this.$router.resolve(this.circle.router);return window.location.origin+e.href},joinButtonTitle(){return this.circle.requireJoinAccept?t("contacts","Request to join"):t("contacts","Join team")}},methods:{confirmLeaveCircle(){window.OC.dialogs.confirmDestructive(t("contacts",`You are about to leave {circle}.
Are you sure?`,{circle:this.circle.displayName}),t("contacts","Please confirm team leave"),window.OC.dialogs.YES_NO_BUTTONS,this.leaveCircle,!0)},async leaveCircle(e){if(!e){this.logger.debug("Circle leave cancelled");return}this.loadingAction=!0;const i=this.circle.initiator;try{await this.$store.dispatch("deleteMemberFromCircle",{member:i,leave:!0}),this.circle.initiator=null}catch(a){console.error("Could not leave the circle",i,a),tt(t("contacts","Could not leave the team {displayName}",this.circle))}finally{this.loadingAction=!1}},async joinCircle(){this.loadingJoin=!0;try{const e=await wd(this.circle.id),i=new kd(e,this.circle);this.circle.initiator=i,i.circle.addMember(i)}catch(e){tt(t("contacts","Unable to join the team")),console.error("Unable to join the circle",e)}finally{this.loadingJoin=!1}},confirmDeleteCircle(){window.OC.dialogs.confirmDestructive(t("contacts",`You are about to delete {circle}.
Are you sure?`,{circle:this.circle.displayName}),t("contacts","Please confirm team deletion"),window.OC.dialogs.YES_NO_BUTTONS,this.deleteCircle,!0)},async deleteCircle(e){if(!e){this.logger.debug("Circle deletion cancelled");return}this.loadingAction=!0;try{this.$store.dispatch("deleteCircle",this.circle.id)}catch{tt(t("contacts","Unable to delete the team"))}finally{this.loadingAction=!1}},async addMemberToCircle(){try{await this.$router.push(this.circle.router)}catch{}De("contacts:circles:append",this.circle.id)}}},Gn="enforce_password",Fn="password_single_enabled",ki="password_single",Mp={name:"CirclePasswordSettings",components:{CheckboxRadioSwitch:fi,Button:Ht},props:{circle:{type:Object,required:!0}},data(){return{ENFORCE_PASSWORD_PROTECTION:Gn,USE_UNIQUE_PASSWORD:Fn,UNIQUE_PASSWORD:ki,loading:[],uniquePassword:"",uniquePasswordError:!1,showUniquePasswordInput:!1}},computed:{circleId(){return this.circle._data.id},enforcePasswordProtection(){const e=this.circle._data.settings[Gn];return e==="1"||e==="true"},useUniquePassword(){const e=this.circle._data.settings[Fn];return e==="1"||e==="true"}},methods:{async changePasswordProtection(){this.loading.push(Gn);try{const e=!this.enforcePasswordProtection;!e&&this.useUniquePassword&&await this.saveUseUniquePassword(!1),!e&&this.showUniquePasswordInput&&(this.showUniquePasswordInput=!1),await this.$store.dispatch("editCircleSetting",{circleId:this.circleId,setting:{setting:Gn,value:e.toString()}})}finally{this.loading=this.loading.filter(e=>e!==Gn)}},async changeUseUniquePassword(){if(!this.useUniquePassword){this.showUniquePasswordInput=!this.showUniquePasswordInput;return}await this.saveUseUniquePassword(!this.useUniquePassword)},async saveUseUniquePassword(e){this.loading.push(Fn);try{await this.$store.dispatch("editCircleSetting",{circleId:this.circleId,setting:{setting:Fn,value:e.toString()}}),e||(this.uniquePassword="",this.showUniquePasswordInput=!1)}finally{this.loading=this.loading.filter(i=>i!==Fn)}},async saveUniquePassword(){if(this.uniquePassword.length!==0){this.loading.push(ki),this.uniquePasswordError=!1;try{this.useUniquePassword||await this.saveUseUniquePassword(!0),await this.$store.dispatch("editCircleSetting",{circleId:this.circleId,setting:{setting:ki,value:this.uniquePassword}}),this.showUniquePasswordInput=!1,this.uniquePassword=""}catch{this.uniquePasswordError=!0}finally{this.loading=this.loading.filter(e=>e!==ki)}}},onClickChangePassword(){this.showUniquePasswordInput=!0}}};var Ap=function(){var e=this,i=e._self._c;return i("ul",[i("li",{staticClass:"circle-config"},[i("ul",{staticClass:"circle-config__list"},[i("CheckboxRadioSwitch",{attrs:{checked:e.enforcePasswordProtection,loading:e.loading.includes(e.ENFORCE_PASSWORD_PROTECTION),disabled:e.loading.length>0,"wrapper-element":"li"},on:{"update:checked":e.changePasswordProtection}},[e._v(" "+e._s(e.t("contacts","Enforce password protection on files shared to this team"))+" ")]),e.enforcePasswordProtection?i("CheckboxRadioSwitch",{attrs:{checked:e.useUniquePassword||e.showUniquePasswordInput,loading:e.loading.includes(e.USE_UNIQUE_PASSWORD),disabled:e.loading.length>0,"wrapper-element":"li"},on:{"update:checked":e.changeUseUniquePassword}},[e._v(" "+e._s(e.t("contacts","Use a unique password for all shares to this team"))+" ")]):e._e(),i("li",{staticClass:"unique-password"},[e.showUniquePasswordInput?[i("input",{directives:[{name:"model",rawName:"v-model",value:e.uniquePassword,expression:"uniquePassword"}],attrs:{disabled:e.loading.length>0,placeholder:e.t("contacts","Unique password …"),type:"text"},domProps:{value:e.uniquePassword},on:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.saveUniquePassword.apply(null,arguments)},input:function(a){a.target.composing||(e.uniquePassword=a.target.value)}}}),i("Button",{attrs:{type:"tertiary-no-background",disabled:e.loading.length>0||e.uniquePassword.length===0},on:{click:e.saveUniquePassword}},[e._v(" "+e._s(e.t("contacts","Save"))+" ")])]:e.useUniquePassword?i("Button",{staticClass:"change-unique-password",on:{click:e.onClickChangePassword}},[e._v(" "+e._s(e.t("contacts","Change unique password"))+" ")]):e._e(),e.uniquePasswordError?i("div",{staticClass:"unique-password-error"},[e._v(" "+e._s(e.t("contacts","Failed to save password. Please try again later."))+" ")]):e._e()],2)],1)])])},Np=[],Op=H(Mp,Ap,Np,!1,null,"22fb4012");const Dp=Op.exports,Lp={name:"ContentHeading",props:{loading:{type:Boolean,default:!1}}};var Tp=function(){var e=this,i=e._self._c;return i("h3",{staticClass:"app-content-heading"},[e._t("default"),e.loading?i("div",{staticClass:"app-content-heading__loader icon-loading-small"}):e._e()],2)},Ep=[],Ip=H(Lp,Tp,Ep,!1,null,"614dccab");const bc=Ip.exports,Pp=Kr({name:"CircleSettings",components:{ContentHeading:bc,CirclePasswordSettings:Dp,IconDelete:Pe,IconLogout:gc,NcButton:Ht,NcCheckboxRadioSwitch:fi},props:{circle:{type:Object,required:!0}},emits:["leave","delete"],setup(){return{t:ti}},data(){return{PUBLIC_CIRCLE_CONFIG:xd,loading:!1}},methods:{isChecked(e){return(this.circle.config&e)!==0},async onChange(e,i){this.logger.debug(`Circle config ${e} is set to ${i}`),this.loading=e;const a=this.circle.config;i?e=a|e:e=a&~e;try{const s=await is(this.circle.id,as.Config,e);this.circle.config=s.config}catch(s){this.logger.error("Unable to edit circle config",{prevConfig:a,config:e,error:s}),tt(ti("contacts","An error happened during the config change"))}finally{this.loading=!1}}}});var zp=function(){var e=this,i=e._self._c;return e._self._setupProxy,i("div",{staticClass:"circle-settings"},[i("ul",e._l(e.PUBLIC_CIRCLE_CONFIG,function(a,s){return i("li",{key:s,staticClass:"circle-config"},[i("ContentHeading",{staticClass:"circle-config__title"},[e._v(" "+e._s(s)+" ")]),i("ul",{staticClass:"circle-config__list"},e._l(a,function(o,r){return i("NcCheckboxRadioSwitch",{key:"circle-config"+r,attrs:{checked:e.isChecked(r),loading:e.loading===r,disabled:e.loading!==!1,"wrapper-element":"li"},on:{"update:checked":function(c){return e.onChange(r,c)}}},[e._v(" "+e._s(o)+" ")])}),1)],1)}),0),i("CirclePasswordSettings",{attrs:{circle:e.circle}}),e.circle.canLeave?i("NcButton",{attrs:{type:"warning"},on:{click:function(a){return e.$emit("leave")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLogout",{attrs:{size:16}})]},proxy:!0}],null,!1,917689676)},[e._v(" "+e._s(e.t("contacts","Leave team"))+" ")]):e._e(),e.circle.canDelete?i("NcButton",{attrs:{type:"error",href:"#"},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.$emit("delete")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)},[e._v(" "+e._s(e.t("contacts","Delete team"))+" ")]):e._e()],1)},Bp=[],$p=H(Pp,zp,Bp,!1,null,"1e7ee70b");const Rp=$p.exports,Hp={name:"CheckOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Yp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon check-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19.78,2.2L24,6.42L8.44,22L0,13.55L4.22,9.33L8.44,13.55L19.78,2.2M19.78,5L8.44,16.36L4.22,12.19L2.81,13.55L8.44,19.17L21.19,6.42L19.78,5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Vp=[],Up=H(Hp,Yp,Vp,!1,null,null);const Gp=Up.exports,Fp={name:"CloseOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var jp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon close-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M3,16.74L7.76,12L3,7.26L7.26,3L12,7.76L16.74,3L21,7.26L16.24,12L21,16.74L16.74,21L12,16.24L7.26,21L3,16.74M12,13.41L16.74,18.16L18.16,16.74L13.41,12L18.16,7.26L16.74,5.84L12,10.59L7.26,5.84L5.84,7.26L10.59,12L5.84,16.74L7.26,18.16L12,13.41Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Wp=[],qp=H(Fp,jp,Wp,!1,null,null);const Xp=qp.exports,Zp={name:"ExitToAppIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Kp=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon exit-to-app-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Jp=[],Qp=H(Zp,Kp,Jp,!1,null,null);const Cc=Qp.exports,tf={name:"ShieldCheckOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ef=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon shield-check-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M21,11C21,16.55 17.16,21.74 12,23C6.84,21.74 3,16.55 3,11V5L12,1L21,5V11M12,21C15.75,20 19,15.54 19,11.22V6.3L12,3.18L5,6.3V11.22C5,15.54 8.25,20 12,21M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},nf=[],af=H(tf,ef,nf,!1,null,null);const sf=af.exports,Qe={computed:{selectedContact(){return this.$route.params.selectedContact},selectedGroup(){return this.$route.params.selectedGroup},selectedCircle(){return this.$route.params.selectedCircle},selectedChart(){return this.$route.params.selectedChart}}},of={name:"MemberGridItem",components:{NcAvatar:Bn,IconAccountGroupOutline:ba,NcActions:Ze,NcActionButton:Ke,NcActionSeparator:oh,NcActionText:Bs,IconDeleteOutline:Pe,IconExitToApp:Cc,IconShieldCheckOutline:sf,IconCheckOutline:Gp,IconCloseOutline:Xp,NcButton:Ht},mixins:[Qe],props:{member:{type:Object,required:!0},isTeam:{type:Boolean,default:!1}},data(){return{loading:!1}},computed:{circle(){return this.$store.getters.getCircle(this.selectedCircle)},currentUserLevel(){return this.circle?.initiator?.level||Gt.MEMBER},currentUserId(){return this.circle?.initiator?.singleId},availableLevelsChange(){const e=[];return this.member.level===Gt.OWNER||this.isCurrentUser||(this.currentUserLevel>=Gt.MODERATOR&&this.member.level!==Gt.ADMIN&&e.push(Gt.ADMIN),this.currentUserLevel>=Gt.ADMIN&&(this.member.level!==Gt.MODERATOR&&e.push(Gt.MODERATOR),this.member.level!==Gt.MEMBER&&e.push(Gt.MEMBER))),e},isCurrentUser(){return this.member.id===this.currentUserId},isPendingApproval(){return this.member.level===Gt.NONE&&this.member.status===Sd.PENDING},canChangeLevel(){return this.circle.canManageMembers&&this.availableLevelsChange.length>0&&!this.isCurrentUser},canDelete(){return this.circle.canManageMembers&&this.member.level<=this.currentUserLevel&&!this.isCurrentUser},memberRole(){return!this.member.level||this.member.level===Gt.NONE?null:Un[this.member.level]||null}},methods:{levelChangeLabel(e){return e===Gt.OWNER?t("contacts","Promote as sole owner"):this.member.level<e?t("contacts","Promote to {level}",{level:Un[e]}):t("contacts","Demote to {level}",{level:Un[e]})},async deleteMember(){if(!this.isCurrentUser){await this.doDeleteMember();return}try{await new Md().setName(t("contacts","Leave team")).setText(t("contacts","Are you sure you want to leave this team? This action cannot be undone.")).setButtons([{label:t("contacts","Cancel"),type:"secondary",callback:()=>{}},{label:t("contacts","Leave team"),type:"error",callback:async()=>{try{await this.doDeleteMember()}catch(e){this.logger.error("Error in delete member callback",{e}),tt(t("contacts","Leave team failed."))}}}]).build().show()}catch{}},async doDeleteMember(){this.loading=!0;try{await this.$store.dispatch("deleteMemberFromCircle",{member:this.member,leave:this.isCurrentUser})}catch(e){if(e?.response?.status===404){this.logger.debug("Member is not in circle");return}this.logger.error("Could not delete the member",{member:this.member,error:e}),tt(t("contacts","Could not delete the member {displayName}",this.member))}finally{this.loading=!1}},async changeLevel(e){this.loading=!0;try{if(await Ad(this.circle.id,this.member.id,e),this.showLevelMenu=!1,e===Gt.OWNER){await this.$store.dispatch("getCircle",this.circle.id),await this.$store.dispatch("getCircleMembers",this.circle.id);return}this.member.level=e}catch(i){this.logger.error("Could not change the member level",{level:Un[e],error:i}),tt(t("contacts","Could not change the member level to {level}",{level:Un[e]}))}finally{this.loading=!1}},async acceptMember(){this.loading=!0;try{await await this.$store.dispatch("acceptCircleMember",{circleId:this.circle.id,memberId:this.member.id})}catch(e){this.logger.error("Could not accept membership request",{member:this.member,error:e}),tt(t("contacts","Could not accept membership request"))}finally{this.loading=!1}}}};var rf=function(){var e=this,i=e._self._c;return i("div",{staticClass:"member-grid-item"},[e.isTeam?i("NcAvatar",{attrs:{"display-name":e.member.displayName,"is-no-user":!0,size:32},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAccountGroupOutline",{attrs:{size:20}})]},proxy:!0}],null,!1,1052497117)}):i("NcAvatar",{attrs:{user:e.member.userId,"display-name":e.member.displayName,size:32}}),i("div",{staticClass:"member-info"},[i("span",{staticClass:"member-name"},[e._v(e._s(e.member.displayName))]),e.memberRole?i("span",{staticClass:"member-role"},[e._v(e._s(e.memberRole))]):e._e()]),!e.loading&&e.isPendingApproval&&e.circle.canManageMembers?i("div",{staticClass:"member-grid-item__actions"},[i("NcButton",{attrs:{"aria-label":e.t("contacts","Accept membership request")},on:{click:e.acceptMember},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCheckOutline",{attrs:{size:20}})]},proxy:!0}],null,!1,3080050949)}),i("NcButton",{attrs:{"aria-label":e.t("contacts","Reject membership request")},on:{click:e.deleteMember},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCloseOutline",{attrs:{size:20}})]},proxy:!0}],null,!1,768915989)})],1):i("NcActions",[e.loading?i("NcActionText",{attrs:{icon:"icon-loading-small"}},[e._v(" "+e._s(e.t("contacts","Loading …"))+" ")]):[e.canChangeLevel?[i("NcActionText",{scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconShieldCheckOutline",{attrs:{size:16}})]},proxy:!0}],null,!1,1883558015)},[e._v(" "+e._s(e.t("contacts","Manage level"))+" ")]),e._l(e.availableLevelsChange,function(a){return i("NcActionButton",{key:a,attrs:{icon:""},on:{click:function(s){return e.changeLevel(a)}}},[e._v(" "+e._s(e.levelChangeLabel(a))+" ")])}),i("NcActionSeparator")]:e._e(),e.isCurrentUser&&!e.circle.isOwner?i("NcActionButton",{on:{click:e.deleteMember},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconExitToApp",{attrs:{size:16}})]},proxy:!0}],null,!1,1644731612)},[e._v(" "+e._s(e.t("contacts","Leave team"))+" ")]):e.canDelete?i("NcActionButton",{on:{click:e.deleteMember},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDeleteOutline",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Remove member"))+" ")]):e._e()]],2)],1)},cf=[],lf=H(of,rf,cf,!1,null,"92e847a4");const uf=lf.exports;var wc={exports:{}};const df=nd(id);(function(e,i){(function(a,s){e.exports=s(df)})(Ps,function(a){a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a;function s(x,w){var y=Object.keys(x);if(Object.getOwnPropertySymbols){var N=Object.getOwnPropertySymbols(x);w&&(N=N.filter(function(O){return Object.getOwnPropertyDescriptor(x,O).enumerable})),y.push.apply(y,N)}return y}function o(x){for(var w=1;w<arguments.length;w++){var y=arguments[w]!=null?arguments[w]:{};w%2?s(Object(y),!0).forEach(function(N){h(x,N,y[N])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(y)):s(Object(y)).forEach(function(N){Object.defineProperty(x,N,Object.getOwnPropertyDescriptor(y,N))})}return x}function r(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function c(x,w){for(var y=0;y<w.length;y++){var N=w[y];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}function l(x,w,y){return w&&c(x.prototype,w),Object.defineProperty(x,"prototype",{writable:!1}),x}function h(x,w,y){return w in x?Object.defineProperty(x,w,{value:y,enumerable:!0,configurable:!0,writable:!0}):x[w]=y,x}function u(x){return m(x)||g(x)||b(x)||A()}function m(x){if(Array.isArray(x))return k(x)}function g(x){if(typeof Symbol<"u"&&x[Symbol.iterator]!=null||x["@@iterator"]!=null)return Array.from(x)}function b(x,w){if(x){if(typeof x=="string")return k(x,w);var y=Object.prototype.toString.call(x).slice(8,-1);if(y==="Object"&&x.constructor&&(y=x.constructor.name),y==="Map"||y==="Set")return Array.from(x);if(y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(y))return k(x,w)}}function k(x,w){(w==null||w>x.length)&&(w=x.length);for(var y=0,N=new Array(w);y<w;y++)N[y]=x[y];return N}function A(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var T={FRONT:"FRONT",BEHIND:"BEHIND"},B={INIT:"INIT",FIXED:"FIXED",DYNAMIC:"DYNAMIC"},z=0,j=function(){function x(w,y){r(this,x),this.init(w,y)}return l(x,[{key:"init",value:function(w,y){this.param=w,this.callUpdate=y,this.sizes=new Map,this.firstRangeTotalSize=0,this.firstRangeAverageSize=0,this.fixedSizeValue=0,this.calcType=B.INIT,this.offset=0,this.direction="",this.range=Object.create(null),w&&this.checkRange(0,w.keeps-1)}},{key:"destroy",value:function(){this.init(null,null)}},{key:"getRange",value:function(){var w=Object.create(null);return w.start=this.range.start,w.end=this.range.end,w.padFront=this.range.padFront,w.padBehind=this.range.padBehind,w}},{key:"isBehind",value:function(){return this.direction===T.BEHIND}},{key:"isFront",value:function(){return this.direction===T.FRONT}},{key:"getOffset",value:function(w){return(w<1?0:this.getIndexOffset(w))+this.param.slotHeaderSize}},{key:"updateParam",value:function(w,y){var N=this;this.param&&w in this.param&&(w==="uniqueIds"&&this.sizes.forEach(function(O,Y){y.includes(Y)||N.sizes.delete(Y)}),this.param[w]=y)}},{key:"saveSize",value:function(w,y){this.sizes.set(w,y),this.calcType===B.INIT?(this.fixedSizeValue=y,this.calcType=B.FIXED):this.calcType===B.FIXED&&this.fixedSizeValue!==y&&(this.calcType=B.DYNAMIC,delete this.fixedSizeValue),this.calcType!==B.FIXED&&typeof this.firstRangeTotalSize<"u"&&(this.sizes.size<Math.min(this.param.keeps,this.param.uniqueIds.length)?(this.firstRangeTotalSize=u(this.sizes.values()).reduce(function(N,O){return N+O},0),this.firstRangeAverageSize=Math.round(this.firstRangeTotalSize/this.sizes.size)):delete this.firstRangeTotalSize)}},{key:"handleDataSourcesChange",value:function(){var w=this.range.start;this.isFront()?w=w-z:this.isBehind()&&(w=w+z),w=Math.max(w,0),this.updateRange(this.range.start,this.getEndByStart(w))}},{key:"handleSlotSizeChange",value:function(){this.handleDataSourcesChange()}},{key:"handleScroll",value:function(w){this.direction=w<this.offset||w===0?T.FRONT:T.BEHIND,this.offset=w,this.param&&(this.direction===T.FRONT?this.handleFront():this.direction===T.BEHIND&&this.handleBehind())}},{key:"handleFront",value:function(){var w=this.getScrollOvers();if(!(w>this.range.start)){var y=Math.max(w-this.param.buffer,0);this.checkRange(y,this.getEndByStart(y))}}},{key:"handleBehind",value:function(){var w=this.getScrollOvers();w<this.range.start+this.param.buffer||this.checkRange(w,this.getEndByStart(w))}},{key:"getScrollOvers",value:function(){var w=this.offset-this.param.slotHeaderSize;if(w<=0)return 0;if(this.isFixedType())return Math.floor(w/this.fixedSizeValue);for(var y=0,N=0,O=0,Y=this.param.uniqueIds.length;y<=Y;){if(N=y+Math.floor((Y-y)/2),O=this.getIndexOffset(N),O===w)return N;O<w?y=N+1:O>w&&(Y=N-1)}return y>0?--y:0}},{key:"getIndexOffset",value:function(w){if(!w)return 0;for(var y=0,N=0,O=0;O<w;O++)N=this.sizes.get(this.param.uniqueIds[O]),y=y+(typeof N=="number"?N:this.getEstimateSize());return y}},{key:"isFixedType",value:function(){return this.calcType===B.FIXED}},{key:"getLastIndex",value:function(){return this.param.uniqueIds.length-1}},{key:"checkRange",value:function(w,y){var N=this.param.keeps,O=this.param.uniqueIds.length;O<=N?(w=0,y=this.getLastIndex()):y-w<N-1&&(w=y-N+1),this.range.start!==w&&this.updateRange(w,y)}},{key:"updateRange",value:function(w,y){this.range.start=w,this.range.end=y,this.range.padFront=this.getPadFront(),this.range.padBehind=this.getPadBehind(),this.callUpdate(this.getRange())}},{key:"getEndByStart",value:function(w){var y=w+this.param.keeps-1,N=Math.min(y,this.getLastIndex());return N}},{key:"getPadFront",value:function(){return this.isFixedType()?this.fixedSizeValue*this.range.start:this.getIndexOffset(this.range.start)}},{key:"getPadBehind",value:function(){var w=this.range.end,y=this.getLastIndex();return this.isFixedType()?(y-w)*this.fixedSizeValue:(y-w)*this.getEstimateSize()}},{key:"getEstimateSize",value:function(){return this.isFixedType()?this.fixedSizeValue:this.firstRangeAverageSize||this.param.estimateSize}}]),x}(),F={dataKey:{type:[String,Function],required:!0},dataSources:{type:Array,required:!0},dataComponent:{type:[Object,Function],required:!0},keeps:{type:Number,default:30},extraProps:{type:Object},estimateSize:{type:Number,default:50},direction:{type:String,default:"vertical"},start:{type:Number,default:0},offset:{type:Number,default:0},topThreshold:{type:Number,default:0},bottomThreshold:{type:Number,default:0},pageMode:{type:Boolean,default:!1},rootTag:{type:String,default:"div"},wrapTag:{type:String,default:"div"},wrapClass:{type:String,default:""},wrapStyle:{type:Object},itemTag:{type:String,default:"div"},itemClass:{type:String,default:""},itemClassAdd:{type:Function},itemStyle:{type:Object},headerTag:{type:String,default:"div"},headerClass:{type:String,default:""},headerStyle:{type:Object},footerTag:{type:String,default:"div"},footerClass:{type:String,default:""},footerStyle:{type:Object},itemScopedSlots:{type:Object}},X={index:{type:Number},event:{type:String},tag:{type:String},horizontal:{type:Boolean},source:{type:Object},component:{type:[Object,Function]},slotComponent:{type:Function},uniqueKey:{type:[String,Number]},extraProps:{type:Object},scopedSlots:{type:Object}},st={event:{type:String},uniqueKey:{type:String},tag:{type:String},horizontal:{type:Boolean}},ut={created:function(){this.shapeKey=this.horizontal?"offsetWidth":"offsetHeight"},mounted:function(){var x=this;typeof ResizeObserver<"u"&&(this.resizeObserver=new ResizeObserver(function(){x.dispatchSizeChange()}),this.resizeObserver.observe(this.$el))},updated:function(){this.resizeObserver.observe(this.$el)},beforeDestroy:function(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)},methods:{getCurrentSize:function(){return this.$el?this.$el[this.shapeKey]:0},dispatchSizeChange:function(){this.$parent.$emit(this.event,this.uniqueKey,this.getCurrentSize(),this.hasInitial)}}},it=a.component("virtual-list-item",{mixins:[ut],props:X,render:function(x){var w=this.tag,y=this.component,N=this.extraProps,O=N===void 0?{}:N,Y=this.index,G=this.source,q=this.scopedSlots,Z=q===void 0?{}:q,J=this.uniqueKey,ot=this.slotComponent,xt=o(o({},O),{},{source:G,index:Y});return x(w,{key:J,attrs:{role:"listitem"}},[ot?ot({item:G,index:Y,scope:xt}):x(y,{props:xt,scopedSlots:Z})])}}),yt=a.component("virtual-list-slot",{mixins:[ut],props:st,render:function(x){var w=this.tag,y=this.uniqueKey;return x(w,{key:y,attrs:{role:y}},this.$slots.default)}}),vt={ITEM:"item_resize",SLOT:"slot_resize"},_t={HEADER:"thead",FOOTER:"tfoot"},S=a.component("virtual-list",{props:F,data:function(){return{range:null}},watch:{"dataSources.length":function(){this.virtual.updateParam("uniqueIds",this.getUniqueIdFromDataSources()),this.virtual.handleDataSourcesChange()},keeps:function(x){this.virtual.updateParam("keeps",x),this.virtual.handleSlotSizeChange()},start:function(x){this.scrollToIndex(x)},offset:function(x){this.scrollToOffset(x)}},created:function(){this.isHorizontal=this.direction==="horizontal",this.directionKey=this.isHorizontal?"scrollLeft":"scrollTop",this.installVirtual(),this.$on(vt.ITEM,this.onItemResized),(this.$slots.header||this.$slots.footer)&&this.$on(vt.SLOT,this.onSlotResized)},activated:function(){this.scrollToOffset(this.virtual.offset),this.pageMode&&document.addEventListener("scroll",this.onScroll,{passive:!1})},deactivated:function(){this.pageMode&&document.removeEventListener("scroll",this.onScroll)},mounted:function(){this.start?this.scrollToIndex(this.start):this.offset&&this.scrollToOffset(this.offset),this.pageMode&&(this.updatePageModeFront(),document.addEventListener("scroll",this.onScroll,{passive:!1}))},beforeDestroy:function(){this.virtual.destroy(),this.pageMode&&document.removeEventListener("scroll",this.onScroll)},methods:{getSize:function(x){return this.virtual.sizes.get(x)},getSizes:function(){return this.virtual.sizes.size},getOffset:function(){if(this.pageMode)return document.documentElement[this.directionKey]||document.body[this.directionKey];var x=this.$refs.root;return x?Math.ceil(x[this.directionKey]):0},getClientSize:function(){var x=this.isHorizontal?"clientWidth":"clientHeight";if(this.pageMode)return document.documentElement[x]||document.body[x];var w=this.$refs.root;return w?Math.ceil(w[x]):0},getScrollSize:function(){var x=this.isHorizontal?"scrollWidth":"scrollHeight";if(this.pageMode)return document.documentElement[x]||document.body[x];var w=this.$refs.root;return w?Math.ceil(w[x]):0},scrollToOffset:function(x){if(this.pageMode)document.body[this.directionKey]=x,document.documentElement[this.directionKey]=x;else{var w=this.$refs.root;w&&(w[this.directionKey]=x)}},scrollToIndex:function(x){if(x>=this.dataSources.length-1)this.scrollToBottom();else{var w=this.virtual.getOffset(x);this.scrollToOffset(w)}},scrollToBottom:function(){var x=this,w=this.$refs.shepherd;if(w){var y=w[this.isHorizontal?"offsetLeft":"offsetTop"];this.scrollToOffset(y),setTimeout(function(){x.getOffset()+x.getClientSize()+1<x.getScrollSize()&&x.scrollToBottom()},3)}},updatePageModeFront:function(){var x=this.$refs.root;if(x){var w=x.getBoundingClientRect(),y=x.ownerDocument.defaultView,N=this.isHorizontal?w.left+y.pageXOffset:w.top+y.pageYOffset;this.virtual.updateParam("slotHeaderSize",N)}},reset:function(){this.virtual.destroy(),this.scrollToOffset(0),this.installVirtual()},installVirtual:function(){this.virtual=new j({slotHeaderSize:0,slotFooterSize:0,keeps:this.keeps,estimateSize:this.estimateSize,buffer:Math.round(this.keeps/3),uniqueIds:this.getUniqueIdFromDataSources()},this.onRangeChanged),this.range=this.virtual.getRange()},getUniqueIdFromDataSources:function(){var x=this.dataKey;return this.dataSources.map(function(w){return typeof x=="function"?x(w):w[x]})},onItemResized:function(x,w){this.virtual.saveSize(x,w),this.$emit("resized",x,w)},onSlotResized:function(x,w,y){x===_t.HEADER?this.virtual.updateParam("slotHeaderSize",w):x===_t.FOOTER&&this.virtual.updateParam("slotFooterSize",w),y&&this.virtual.handleSlotSizeChange()},onRangeChanged:function(x){this.range=x},onScroll:function(x){var w=this.getOffset(),y=this.getClientSize(),N=this.getScrollSize();w<0||w+y>N+1||!N||(this.virtual.handleScroll(w),this.emitEvent(w,y,N,x))},emitEvent:function(x,w,y,N){this.$emit("scroll",N,this.virtual.getRange()),this.virtual.isFront()&&this.dataSources.length&&x-this.topThreshold<=0?this.$emit("totop"):this.virtual.isBehind()&&x+w+this.bottomThreshold>=y&&this.$emit("tobottom")},getRenderSlots:function(x){for(var w=[],y=this.range,N=y.start,O=y.end,Y=this.dataSources,G=this.dataKey,q=this.itemClass,Z=this.itemTag,J=this.itemStyle,ot=this.isHorizontal,xt=this.extraProps,mt=this.dataComponent,Tt=this.itemScopedSlots,Bt=this.$scopedSlots&&this.$scopedSlots.item,St=N;St<=O;St++){var Nt=Y[St];if(Nt){var qt=typeof G=="function"?G(Nt):Nt[G];typeof qt=="string"||typeof qt=="number"?w.push(x(it,{props:{index:St,tag:Z,event:vt.ITEM,horizontal:ot,uniqueKey:qt,source:Nt,extraProps:xt,component:mt,slotComponent:Bt,scopedSlots:Tt},style:J,class:"".concat(q).concat(this.itemClassAdd?" "+this.itemClassAdd(St):"")})):console.warn("Cannot get the data-key '".concat(G,"' from data-sources."))}else console.warn("Cannot get the index '".concat(St,"' from data-sources."))}return w}},render:function(x){var w=this.$slots,y=w.header,N=w.footer,O=this.range,Y=O.padFront,G=O.padBehind,q=this.isHorizontal,Z=this.pageMode,J=this.rootTag,ot=this.wrapTag,xt=this.wrapClass,mt=this.wrapStyle,Tt=this.headerTag,Bt=this.headerClass,St=this.headerStyle,Nt=this.footerTag,qt=this.footerClass,Hn=this.footerStyle,yn={padding:q?"0px ".concat(G,"px 0px ").concat(Y,"px"):"".concat(Y,"px 0px ").concat(G,"px")},bi=mt?Object.assign({},mt,yn):yn;return x(J,{ref:"root",on:{"&scroll":!Z&&this.onScroll}},[y?x(yt,{class:Bt,style:St,props:{tag:Tt,event:vt.SLOT,uniqueKey:_t.HEADER}},y):null,x(ot,{class:xt,attrs:{role:"group"},style:bi},this.getRenderSlots(x)),N?x(yt,{class:qt,style:Hn,props:{tag:Nt,event:vt.SLOT,uniqueKey:_t.FOOTER}},N):null,x("div",{ref:"shepherd",style:{width:q?"0px":"100%",height:q?"100%":"0px"}})])}});return S})})(wc);var hf=wc.exports;const kc=ma(hf),pf={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ff=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},mf=[],gf=H(pf,ff,mf,!1,null,null);const yf=gf.exports,vf={name:"EntityBubble",components:{UserBubble:Fs},props:{id:{type:String,required:!0},label:{type:String,required:!0},type:{type:String,required:!0}},methods:{onDelete(){this.$emit("delete",{id:this.id,type:this.type})}}};var _f=function(){var e=this,i=e._self._c;return i("UserBubble",{staticClass:"entity-picker__bubble",attrs:{margin:0,size:22,"display-name":e.label},scopedSlots:e._u([{key:"name",fn:function(){return[i("a",{staticClass:"entity-picker__bubble-delete icon-close",attrs:{href:"#",title:e.t("contacts","Remove {type}",{type:e.type})},on:{click:e.onDelete}})]},proxy:!0}])})},bf=[],Cf=H(vf,_f,bf,!1,null,"5c279f5d");const wf=Cf.exports,kf={name:"EntitySearchResult",components:{UserBubble:Fs},props:{source:{type:Object,default(){return{}}},onClick:{type:Function,default(){}},selection:{type:Object,default:()=>({})}},computed:{isSelected(){return this.source.id in this.selection}}};var xf=function(){var e=this,i=e._self._c;return e.source.heading?i("h4",{key:e.source.id,staticClass:"entity-picker__option-caption"},[e._v(" "+e._s(e.t("contacts","Add {type}",{type:e.source.label.toLowerCase()}))+" ")]):i("UserBubble",{staticClass:"entity-picker__bubble",class:{"entity-picker__bubble--selected":e.isSelected},attrs:{"display-name":e.source.label,user:e.source.user,margin:6,size:44,url:"#"},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.onClick(e.source)}},scopedSlots:e._u([{key:"title",fn:function(){return[i("span",{staticClass:"entity-picker__bubble-checkmark icon-checkmark"})]},proxy:!0}])})},Sf=[],Mf=H(kf,xf,Sf,!1,null,"bc6ac935");const Af=Mf.exports,Nf={name:"EntityPicker",components:{Button:Ht,EmptyContent:Xe,EntityBubble:wf,IconAccountPlusOutline:yc,IconSearch:yf,IconLoading:Jt,Modal:Je,VirtualList:kc},props:{loading:{type:Boolean,default:!1},dataTypes:{type:Array,required:!0,validator:e=>{const i=e.filter(a=>!a.id&&!a.label);return i.length>0?(console.error("The following types MUST have a proper id and label key",i),!1):!0}},dataSet:{type:Array,required:!0,validator:e=>(e.forEach(i=>{(!i.id||!i.label)&&console.error("The following source MUST have a proper id and label key",i)}),!0)},sort:{type:String,default:"label"},confirmLabel:{type:String,default:t("contacts","Add to group")},internalSearch:{type:Boolean,default:!0},selection:{type:Object,default:null},emptyDataSetDescription:{type:String,default:""}},data(){return{canInviteGuests:!!window?.OCA?.Guests?.openGuestDialog,searchQuery:"",localSelection:{},EntitySearchResult:Af}},computed:{selectionSet:{get(){return this.selection!==null?this.selection:this.localSelection},set(e){this.selection!==null&&this.$emit("update:selection",e),this.localSelection=e}},isSingleType(){return!(this.dataTypes.length>1)},isEmptySelection(){return Object.keys(this.selectionSet).length===0},searchPlaceholderTypes(){return`${this.dataTypes.map(e=>e.label).join(", ")}…`},searchSet(){return this.internalSearch&&this.searchQuery&&this.searchQuery.trim!==""?this.dataSet.filter(e=>e.label.toLowerCase().indexOf(this.searchQuery.toLowerCase())>-1):this.dataSet},availableEntities(){return this.isSingleType?this.searchSet:this.dataTypes.map(e=>{const i=this.searchSet.filter(s=>s.type===e.id),a=[{id:e.id,label:e.label,heading:!0},...i];return i.length===0?[]:a}).flat()}},mounted(){this.$nextTick(()=>{this.$refs.input.focus(),this.$refs.input.select()}),this.canInviteGuests&&ii("guests:user:created",this.addGuest)},methods:{onCancel(){this.$emit("close")},onSubmit(){this.$emit("submit",Object.values(this.selectionSet))},onSearch:ec(function(){this.$emit("search",this.searchQuery)},200),onDelete(e){this.$delete(this.selectionSet,e.id,e),console.debug("Removing entity from selection",e)},onClick(e){if(e.id in this.selectionSet){this.$delete(this.selectionSet,e.id),console.debug("Removed entity to selection",e);return}this.$set(this.selectionSet,e.id,e),console.debug("Added entity to selection",e)},onToggle(e){e.id in this.selectionSet?this.onDelete(e):this.onPick(e)},onGuestButtonClick(){this.canInviteGuests&&window?.OCA?.Guests?.openGuestDialog("contacts")}}};var Of=function(){var e=this,i=e._self._c;return i("Modal",{attrs:{size:"normal"},on:{close:e.onCancel}},[i("div",{staticClass:"entity-picker"},[i("div",{staticClass:"entity-picker__heading"},[i("h2",{staticClass:"entity-picker__title"},[e._v(" "+e._s(e.t("contacts","Invite members to team"))+" ")])]),i("div",{staticClass:"entity-picker__search-container"},[i("div",{staticClass:"entity-picker__search"},[i("div",{staticClass:"entity-picker__search-icon icon-search"}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],ref:"input",staticClass:"entity-picker__search-input",attrs:{placeholder:e.t("contacts","Search {types}",{types:e.searchPlaceholderTypes}),type:"search"},domProps:{value:e.searchQuery},on:{input:[function(a){a.target.composing||(e.searchQuery=a.target.value)},e.onSearch]}})]),e.canInviteGuests?i("Button",{attrs:{type:"button",variant:"tertiary-no-background",title:e.t("contacts","Add guest"),"aria-label":e.t("contacts","Add guest")},on:{click:e.onGuestButtonClick}},[i("IconAccountPlusOutline",{attrs:{size:20}})],1):e._e()],1),e.loading?i("EmptyContent",{attrs:{name:e.t("contacts","Loading …")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)}):[Object.keys(e.selectionSet).length>0?i("transition-group",{staticClass:"entity-picker__selection",attrs:{name:"zoom",tag:"ul"}},e._l(e.selectionSet,function(a){return i("EntityBubble",e._b({key:a.key||`entity-${a.type}-${a.id}`,on:{delete:function(s){return e.onDelete(a)}}},"EntityBubble",a,!1))}),1):e._e(),e.dataSet.length===0?i("EmptyContent",{attrs:{name:e.t("contacts","Search for people to add"),description:e.emptyDataSetDescription},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconSearch",{attrs:{size:20}})]},proxy:!0}],null,!1,2588625165)}):e.searchSet.length>0&&e.availableEntities.length>0?i("VirtualList",{staticClass:"entity-picker__options",attrs:{"data-key":"id","data-sources":e.availableEntities,"data-component":e.EntitySearchResult,"estimate-size":44,"extra-props":{selection:e.selectionSet,onClick:e.onClick}}}):e.searchQuery?i("EmptyContent",{attrs:{name:e.t("contacts","No results")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconSearch",{attrs:{size:20}})]},proxy:!0}])}):e._e(),i("div",{staticClass:"entity-picker__navigation"},[i("button",{staticClass:"navigation__button-left",attrs:{disabled:e.loading},on:{click:e.onCancel}},[e._v(" "+e._s(e.t("contacts","Cancel"))+" ")]),i("button",{staticClass:"navigation__button-right primary",attrs:{disabled:e.isEmptySelection||e.loading},on:{click:e.onSubmit}},[e._v(" "+e._s(e.confirmLabel)+" ")])])]],2)])},Df=[],Lf=H(Nf,Of,Df,!1,null,"242f4fb3");const xc=Lf.exports,Sc=Object.keys(ss),Tf=parseInt(window.OC.config["sharing.maxAutocompleteResults"],10)||25,Zo=async function(e){const i=await ce.get(zs("apps/files_sharing/api/v1/sharees"),{params:{format:"json",itemType:"contacts",search:e,perPage:Tf,shareType:Sc,lookup:!1}}),a=i.data.ocs.data,s=i.data.ocs.data.exact;a.exact=[];const o=Object.values(s).reduce((g,b)=>g.concat(b),[]),r=Object.values(a).reduce((g,b)=>g.concat(b),[]),c=o.filter(g=>typeof g=="object").map(g=>cs(g)).sort((g,b)=>g.shareType-b.shareType),l=r.filter(g=>typeof g=="object").map(g=>cs(g)).sort((g,b)=>g.shareType-b.shareType),h=c.concat(l),u=h.reduce((g,b)=>(b.displayName&&(g[b.displayName]||(g[b.displayName]=0),g[b.displayName]++),g),{}),m=h.map(g=>u[g.displayName]>1&&!g.desc?{...g,desc:g.shareWithDisplayNameUnique}:g);return console.info("suggestions",m),m},Ef=async function(){const e=(await ce.get(zs("apps/files_sharing/api/v1/sharees_recommended"),{params:{format:"json",itemType:"contacts",shareType:Sc}})).data.ocs.data.exact,i=Object.values(e).reduce((a,s)=>a.concat(s),[]).map(a=>cs(a));return console.info("recommendations",i),i},cs=function(e){const i=`picker-${e.value.shareType}`;return{label:e.label,id:`${i}-${e.value.shareWith}`,user:[window.OC.Share.SHARE_TYPE_USER,window.OC.Share.SHARE_TYPE_REMOTE].indexOf(e.value.shareType)>-1?e.value.shareWith:null,type:i,...e.value}},If=Kr({name:"MemberList",components:{EntityPicker:xc,IconContact:mn,MemberGridItem:uf,NcEmptyContent:Xe},mixins:[va,Qe],props:{list:{type:Array,required:!0},loading:{type:Boolean,default:!1}},data(){return{pickerLoading:!1,showPicker:!1,showPickerIntro:!0,recommendations:[],pickerCircle:null,pickerData:[],pickerSelection:{},pickerTypes:Nd}},computed:{circle(){return this.$store.getters.getCircle(this.selectedCircle)},filteredPickerData(){return this.pickerData.filter(e=>{const i=ss[e.shareType],a=this.list.filter(({userType:s})=>s===i);return a?a.find(s=>s.userId===e.shareWith)===void 0:!0})},flatList(){const e=this.list.filter(a=>!a.isUser),i=this.list.filter(a=>a.isUser);return[...e,...i]},hasMembers(){return this.flatList.length>0}},mounted(){ii("contacts:circles:append",this.onShowPicker),ii("guests:user:created",this.onGuestCreated)},methods:{async onShowPicker(e){this.showPicker=!0,this.pickerLoading=!0,this.pickerCircle=e;try{const i=await Ef();this.recommendations=i,this.pickerData=i}catch(i){console.error("Unable to get the recommendations list",i)}finally{this.pickerLoading=!1}},async onSearch(e){if(e.trim()===""){this.pickerData=this.recommendations;return}this.pickerLoading=!0;try{const i=await Zo(e);this.pickerData=i}catch(i){console.error("Unable to get the results",i),tt(ti("contacts","Unable to get the results"))}finally{this.pickerLoading=!1}},async onPickerPick(e){this.logger.info("Adding selection to circle",{selection:e,pickerCircle:this.pickerCircle}),this.pickerLoading=!0,e=e.map(i=>({id:i.shareWith,type:ss[i.shareType]}));try{if((await this.$store.dispatch("addMembersToCircle",{circleId:this.pickerCircle,selection:e})).length<e.length){Od(ti("contacts","Some members could not be added")),this.pickerSelection={};return}this.resetPicker()}catch(i){tt(ti("contacts","There was an issue adding members to the team")),console.error("There was an issue adding members to the circle",this.pickerCircle,i)}finally{this.pickerLoading=!1}},resetPicker(){this.showPicker=!1,this.pickerCircle=null,this.pickerData=[],this.pickerSelection={}},async onGuestCreated(e){const i=await Zo(e.username);this.$refs.entityPicker.onClick(i[0])}}});var Pf=function(){var e=this,i=e._self._c;return e._self._setupProxy,i("section",{staticClass:"member-list"},[e.loading?i("NcEmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","Loading members list …")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)}):e.circle.isMember?e.hasMembers?i("div",{staticClass:"member-grid"},e._l(e.flatList,function(a){return i("MemberGridItem",{key:`member-grid-item-${a.id}`,attrs:{member:a,"is-team":!a.isUser}})}),1):i("NcEmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","You currently have no access to the member list")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0}])}):i("NcEmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","The list of members is only visible to members of this team")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0}])}),e.showPicker?i("EntityPicker",{ref:"entityPicker",attrs:{"confirm-label":e.t("contacts","Add to {circle}",{circle:e.circle.displayName}),"data-types":e.pickerTypes,"data-set":e.filteredPickerData,"internal-search":!1,loading:e.pickerLoading,selection:e.pickerSelection},on:{"update:selection":function(a){e.pickerSelection=a},close:e.resetPicker,search:e.onSearch,submit:e.onPickerPick}}):e._e()],1)},zf=[],Bf=H(If,Pf,zf,!1,null,"fb291c11");const $f=Bf.exports,Rf={name:"CircleDetails",components:{AccountPlusIcon:yc,Avatar:Bn,Button:Ht,ContentHeading:bc,ListItem:mc,CogIcon:js,CopyIcon:oc,IconAccountGroup:ba,FileDocumentOutline:Sp,LoginIcon:hp,LogoutIcon:gc,MemberList:$f,CircleSettings:Rp,NcEmptyContent:Xe,NcLoadingIcon:Jt,NcPopover:tc,PencilIcon:Vs,UserBubble:Fs,NcTextField:nc,NcTextArea:Dd},mixins:[_c],setup(){const e=ad(),{width:i}=md(e);return{avatarList:e,width:i}},data(){return{active:!1,isEditing:!1,showMembersModal:!1,loading:!1,loadingJoin:!1,loadingLeave:!1,loadingName:!1,loadingDescription:!1,isSettingsPopoverShown:!1,resources:[],originalDisplayName:"",originalDescription:""}},computed:{descriptionPlaceholder(){return this.circle.description.trim()===""?t("contacts","There is no description for this team"):t("contacts","Enter a description for the team")},isEmptyDescription(){return this.circle.description.trim()===""},showDescription(){return this.circle.isOwner?!0:!this.isEmptyDescription},members(){return Object.values(this.$store.getters.getCircle(this.circle.id)?.members||[])},circleUrl(){return window.location.href},canManageTeam(){return(this.circle.isOwner||this.circle.isAdmin)&&!this.circle.isPersonal},maxMembers(){const e=parseInt(window.getComputedStyle(document.body).getPropertyValue("--default-clickable-area"))+12,i=Math.floor(this.width/e);return this.members.length>i?i-1:i},memberLimit(){return Math.min(this.members.length,this.maxMembers)},membersLimited(){return this.members.slice(0,this.memberLimit)},hasExtraMembers(){return this.members.length>this.maxMembers},groupedResources(){return this.resources.reduce((e,i)=>{const a=i.provider.id;return e[a]||(e[a]={name:i.provider.name,resources:[]}),e[a].resources.push(i),e},{})},resourcesForProvider(){return e=>this.resources?.filter(i=>i.provider.id===e)??[]}},watch:{"circle.id":{handler(){this.fetchTeamResources()},immediate:!0}},methods:{addMembers(){this.$refs.memberList.onShowPicker(this.circle.id)},onLeave(){this.isSettingsPopoverShown=!1,this.confirmLeaveCircle()},onDelete(){this.isSettingsPopoverShown=!1,this.confirmDeleteCircle()},startEditing(){this.originalDisplayName=this.circle.displayName,this.originalDescription=this.circle.description,this.isEditing=!0},cancelEditing(){this.circle.displayName=this.originalDisplayName,this.circle.description=this.originalDescription,this.isEditing=!1},async fetchTeamResources(){const e=await ce.get(zs(`/teams/${this.circle.id}/resources`));this.resources=e.data.ocs.data.resources,console.debug("Team resources",this.resources)},onAutocomplete(e,i){i([])},async saveChanges(){const e=[];if(this.circle.displayName!==this.originalDisplayName){this.loadingName=!0;try{await is(this.circle.id,as.Name,this.circle.displayName),this.originalDisplayName=this.circle.displayName}catch(i){console.error("Unable to edit name",this.circle.displayName,i),e.push("name"),this.circle.displayName=this.originalDisplayName}finally{this.loadingName=!1}}if(this.circle.description!==this.originalDescription){this.loadingDescription=!0;try{await is(this.circle.id,as.Description,this.circle.description),this.originalDescription=this.circle.description}catch(i){console.error("Unable to edit team description",this.circle.description,i),e.push("description"),this.circle.description=this.originalDescription}finally{this.loadingDescription=!1}}if(e.length>0){const i=e.join(" and ");tt(t("contacts","An error happened while saving {fields}",{fields:i}));return}this.isEditing=!1}}};var Hf=function(){var e=this,i=e._self._c;return i("div",{staticClass:"circle-details-container"},[i("div",{staticClass:"circle-details-grid",class:{"is-editing":e.isEditing}},[i("div",{staticClass:"circle-details__header-wrapper"},[i("div",{staticClass:"circle-details-grid__avatar"},[i("Avatar",{attrs:{"disable-tooltip":!0,"display-name":e.circle.displayName,"is-no-user":!0,size:75}})],1),i("div",{staticClass:"circle-details__header"},[i("div",{staticClass:"circle-name-wrapper"},[e.isEditing?i("NcTextField",{attrs:{placeholder:e.t("contacts","Team name"),label:"Team name"},model:{value:e.circle.displayName,callback:function(a){e.$set(e.circle,"displayName",a)},expression:"circle.displayName"}}):i("h2",{staticClass:"circle-name"},[i("span",{attrs:{title:e.circle.displayName}},[e._v(e._s(e.circle.displayName))]),e.loadingName?i("NcLoading",{attrs:{size:24}}):e._e()],1)],1),e.isEditing?e._e():i("div",{staticClass:"subtitle"},[i("span",[e._v(e._s(e.t("files","Team owner")))]),e._v(" "),i("UserBubble",{attrs:{user:e.circle.owner.userId,"display-name":e.circle.isOwner?"you":e.circle.owner.displayName}})],1),e.showDescription?i("div",{staticClass:"circle-description-wrapper"},[e.isEditing?i("NcTextArea",{attrs:{placeholder:e.descriptionPlaceholder,label:"Description",maxlength:1024},model:{value:e.circle.description,callback:function(a){e.$set(e.circle,"description",a)},expression:"circle.description"}}):i("div",{staticClass:"circle-description"},[e._v(" "+e._s(e.circle.description)+" ")])],1):e._e(),i("div",{staticClass:"actions"},[e.isEditing?[i("Button",{attrs:{type:"secondary"},on:{click:e.cancelEditing}},[e._v(" "+e._s(e.t("contacts","Cancel"))+" ")]),i("Button",{attrs:{type:"primary"},on:{click:e.saveChanges}},[e._v(" "+e._s(e.t("contacts","Save"))+" ")])]:[e.canManageTeam?i("Button",{attrs:{type:"primary"},on:{click:e.startEditing},scopedSlots:e._u([{key:"icon",fn:function(){return[i("PencilIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,4260349822)},[e._v(" "+e._s(e.t("contacts","Edit"))+" ")]):e._e(),i("Button",{attrs:{type:"secondary",href:e.circleUrl},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.copyToClipboard(e.circleUrl)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("CopyIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,1902929638)},[e._v(" "+e._s(e.t("contacts","Copy link"))+" ")]),e.canManageTeam?i("NcPopover",{attrs:{shown:e.isSettingsPopoverShown,"popup-role":"dialog"},on:{"update:shown":function(a){e.isSettingsPopoverShown=a}},scopedSlots:e._u([{key:"trigger",fn:function(){return[i("Button",{on:{click:function(a){e.isSettingsPopoverShown=!0}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("CogIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,1255914024)})]},proxy:!0}],null,!1,3469609916)},[i("CircleSettings",{attrs:{circle:e.circle},on:{leave:e.onLeave,delete:e.onDelete}})],1):e._e()],!e.circle.isPendingMember&&!e.circle.isMember&&e.circle.canJoin?i("Button",{staticClass:"primary",attrs:{disabled:e.loadingJoin},on:{click:e.joinCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("LoginIcon",{attrs:{size:16}})]},proxy:!0}],null,!1,3447354053)},[e._v(" "+e._s(e.t("contacts","Request to join"))+" ")]):e._e(),e.circle.isMember&&e.circle.canLeave?i("Button",{attrs:{disabled:e.loadingLeave,type:"warning"},on:{click:e.confirmLeaveCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("LogoutIcon",{attrs:{size:16}})]},proxy:!0}],null,!1,3151835404)},[e._v(" "+e._s(e.t("contacts","Leave team"))+" ")]):e._e()],2)])]),i("div",{staticClass:"circle-details__main-content"},[e.circle.isMember?i("section",[e._l(e.groupedResources,function(a,s){return i("div",{key:s,staticClass:"circle-details-section"},[i("div",{staticClass:"section-header"},[i("ContentHeading",[e._v(e._s(a.name))])],1),i("ul",{staticClass:"item-list"},e._l(a.resources,function(o){return i("ListItem",{key:o.id,attrs:{href:o.link,name:o.label},scopedSlots:e._u([{key:"icon",fn:function(){return[o.iconSvg?i("div",{staticClass:"resource__icon",domProps:{innerHTML:e._s(o.iconSvg)}}):o.iconURL?i("img",{staticClass:"resource__icon",attrs:{src:o.iconURL}}):i("FileDocumentOutline",{attrs:{size:20}})]},proxy:!0}],null,!0)})}),1)])}),i("div",{staticClass:"circle-details-section"},[i("div",{staticClass:"member-section-layout"},[i("div",{staticClass:"section-header"},[i("ContentHeading",[e._v(e._s(e.t("contacts","Members")))]),e.circle.canManageMembers?i("Button",{attrs:{type:"tertiary"},on:{click:e.addMembers},scopedSlots:e._u([{key:"icon",fn:function(){return[i("AccountPlusIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,233241304)},[e._v(" "+e._s(e.t("contacts","Add"))+" ")]):e._e()],1),i("MemberList",{ref:"memberList",attrs:{list:e.members}})],1)])],2):[e.circle.isPendingMember?i("NcEmptyContent",{attrs:{name:e.t("contacts","Your request to join this team is pending approval")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("NcLoadingIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,3155754792)}):i("NcEmptyContent",{attrs:{name:e.t("contacts","You are not a member of {circle}",{circle:e.circle.displayName})},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAccountGroup",{attrs:{size:20}})]},proxy:!0}],null,!1,2121133277)})]],2)])])},Yf=[],Vf=H(Rf,Hf,Yf,!1,null,"d64d7845");const Uf=Vf.exports,Gf={name:"CircleContent",components:{AppContent:$s,CircleDetails:Uf,EmptyContent:Xe,AccountGroup:ba,IconLoading:Jt},mixins:[va,Qe],props:{loading:{type:Boolean,default:!0}},data(){return{loadingList:!1}},computed:{circles(){return this.$store.getters.getCircles},circle(){return this.$store.getters.getCircle(this.selectedCircle)},members(){return Object.values(this.circle?.members||[])},isEmptyCircle(){return this.members.length===0}},watch:{circle(e){e?.id&&this.fetchCircleMembers(e.id)}},beforeMount(){this.circle?.id&&this.fetchCircleMembers(this.circle.id)},methods:{async fetchCircleMembers(e){this.loadingList=!0,this.logger.debug("Fetching members for",{circleId:e});try{await this.$store.dispatch("getCircleMembers",e)}catch(i){console.error(i),tt(t("contacts","There was an error fetching the member list"))}finally{this.loadingList=!1}}}};var Ff=function(){var e=this,i=e._self._c;return i("AppContent",[e.circle?e.loading?i("EmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","Loading team…")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}])}):i("CircleDetails",{attrs:{circle:e.circle}}):i("EmptyContent",{attrs:{name:e.t("contacts","Please select a team")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("AccountGroup",{attrs:{size:20}})]},proxy:!0}],null,!1,4176711638)})],1)},jf=[],Wf=H(Gf,Ff,jf,!1,null,"0dbb2f42");const qf=Wf.exports;function Xf(e,i){var a=0,s=0;return Float64Array.from(e,i===void 0?o=>a+=+o||0:o=>a+=+i(o,s++,e)||0)}function Zf(e,i){let a;if(i===void 0)for(const s of e)s!=null&&(a<s||a===void 0&&s>=s)&&(a=s);else{let s=-1;for(let o of e)(o=i(o,++s,e))!=null&&(a<o||a===void 0&&o>=o)&&(a=o)}return a}function Kf(e,i){let a;if(i===void 0)for(const s of e)s!=null&&(a>s||a===void 0&&s>=s)&&(a=s);else{let s=-1;for(let o of e)(o=i(o,++s,e))!=null&&(a>o||a===void 0&&o>=o)&&(a=o)}return a}function Jf(e,i){let a=0;if(i===void 0)for(let s of e)(s=+s)&&(a+=s);else{let s=-1;for(let o of e)(o=+i(o,++s,e))&&(a+=o)}return a}var Qf={value:()=>{}};function Ws(){for(var e=0,i=arguments.length,a={},s;e<i;++e){if(!(s=arguments[e]+"")||s in a||/[\s.]/.test(s))throw new Error("illegal type: "+s);a[s]=[]}return new Ri(a)}function Ri(e){this._=e}function t1(e,i){return e.trim().split(/^|\s+/).map(function(a){var s="",o=a.indexOf(".");if(o>=0&&(s=a.slice(o+1),a=a.slice(0,o)),a&&!i.hasOwnProperty(a))throw new Error("unknown type: "+a);return{type:a,name:s}})}Ri.prototype=Ws.prototype={constructor:Ri,on:function(e,i){var a=this._,s=t1(e+"",a),o,r=-1,c=s.length;if(arguments.length<2){for(;++r<c;)if((o=(e=s[r]).type)&&(o=e1(a[o],e.name)))return o;return}if(i!=null&&typeof i!="function")throw new Error("invalid callback: "+i);for(;++r<c;)if(o=(e=s[r]).type)a[o]=Ko(a[o],e.name,i);else if(i==null)for(o in a)a[o]=Ko(a[o],e.name,null);return this},copy:function(){var e={},i=this._;for(var a in i)e[a]=i[a].slice();return new Ri(e)},call:function(e,i){if((o=arguments.length-2)>0)for(var a=new Array(o),s=0,o,r;s<o;++s)a[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(r=this._[e],s=0,o=r.length;s<o;++s)r[s].value.apply(i,a)},apply:function(e,i,a){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],o=0,r=s.length;o<r;++o)s[o].value.apply(i,a)}};function e1(e,i){for(var a=0,s=e.length,o;a<s;++a)if((o=e[a]).name===i)return o.value}function Ko(e,i,a){for(var s=0,o=e.length;s<o;++s)if(e[s].name===i){e[s]=Qf,e=e.slice(0,s).concat(e.slice(s+1));break}return a!=null&&e.push({name:i,value:a}),e}var ls="http://www.w3.org/1999/xhtml";const Jo={svg:"http://www.w3.org/2000/svg",xhtml:ls,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ca(e){var i=e+="",a=i.indexOf(":");return a>=0&&(i=e.slice(0,a))!=="xmlns"&&(e=e.slice(a+1)),Jo.hasOwnProperty(i)?{space:Jo[i],local:e}:e}function n1(e){return function(){var i=this.ownerDocument,a=this.namespaceURI;return a===ls&&i.documentElement.namespaceURI===ls?i.createElement(e):i.createElementNS(a,e)}}function i1(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Mc(e){var i=Ca(e);return(i.local?i1:n1)(i)}function a1(){}function qs(e){return e==null?a1:function(){return this.querySelector(e)}}function s1(e){typeof e!="function"&&(e=qs(e));for(var i=this._groups,a=i.length,s=new Array(a),o=0;o<a;++o)for(var r=i[o],c=r.length,l=s[o]=new Array(c),h,u,m=0;m<c;++m)(h=r[m])&&(u=e.call(h,h.__data__,m,r))&&("__data__"in h&&(u.__data__=h.__data__),l[m]=u);return new Kt(s,this._parents)}function o1(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function r1(){return[]}function Ac(e){return e==null?r1:function(){return this.querySelectorAll(e)}}function c1(e){return function(){return o1(e.apply(this,arguments))}}function l1(e){typeof e=="function"?e=c1(e):e=Ac(e);for(var i=this._groups,a=i.length,s=[],o=[],r=0;r<a;++r)for(var c=i[r],l=c.length,h,u=0;u<l;++u)(h=c[u])&&(s.push(e.call(h,h.__data__,u,c)),o.push(h));return new Kt(s,o)}function Nc(e){return function(){return this.matches(e)}}function Oc(e){return function(i){return i.matches(e)}}var u1=Array.prototype.find;function d1(e){return function(){return u1.call(this.children,e)}}function h1(){return this.firstElementChild}function p1(e){return this.select(e==null?h1:d1(typeof e=="function"?e:Oc(e)))}var f1=Array.prototype.filter;function m1(){return Array.from(this.children)}function g1(e){return function(){return f1.call(this.children,e)}}function y1(e){return this.selectAll(e==null?m1:g1(typeof e=="function"?e:Oc(e)))}function v1(e){typeof e!="function"&&(e=Nc(e));for(var i=this._groups,a=i.length,s=new Array(a),o=0;o<a;++o)for(var r=i[o],c=r.length,l=s[o]=[],h,u=0;u<c;++u)(h=r[u])&&e.call(h,h.__data__,u,r)&&l.push(h);return new Kt(s,this._parents)}function Dc(e){return new Array(e.length)}function _1(){return new Kt(this._enter||this._groups.map(Dc),this._parents)}function Ki(e,i){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=i}Ki.prototype={constructor:Ki,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,i){return this._parent.insertBefore(e,i)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function b1(e){return function(){return e}}function C1(e,i,a,s,o,r){for(var c=0,l,h=i.length,u=r.length;c<u;++c)(l=i[c])?(l.__data__=r[c],s[c]=l):a[c]=new Ki(e,r[c]);for(;c<h;++c)(l=i[c])&&(o[c]=l)}function w1(e,i,a,s,o,r,c){var l,h,u=new Map,m=i.length,g=r.length,b=new Array(m),k;for(l=0;l<m;++l)(h=i[l])&&(b[l]=k=c.call(h,h.__data__,l,i)+"",u.has(k)?o[l]=h:u.set(k,h));for(l=0;l<g;++l)k=c.call(e,r[l],l,r)+"",(h=u.get(k))?(s[l]=h,h.__data__=r[l],u.delete(k)):a[l]=new Ki(e,r[l]);for(l=0;l<m;++l)(h=i[l])&&u.get(b[l])===h&&(o[l]=h)}function k1(e){return e.__data__}function x1(e,i){if(!arguments.length)return Array.from(this,k1);var a=i?w1:C1,s=this._parents,o=this._groups;typeof e!="function"&&(e=b1(e));for(var r=o.length,c=new Array(r),l=new Array(r),h=new Array(r),u=0;u<r;++u){var m=s[u],g=o[u],b=g.length,k=S1(e.call(m,m&&m.__data__,u,s)),A=k.length,T=l[u]=new Array(A),B=c[u]=new Array(A),z=h[u]=new Array(b);a(m,g,T,B,z,k,i);for(var j=0,F=0,X,st;j<A;++j)if(X=T[j]){for(j>=F&&(F=j+1);!(st=B[F])&&++F<A;);X._next=st||null}}return c=new Kt(c,s),c._enter=l,c._exit=h,c}function S1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function M1(){return new Kt(this._exit||this._groups.map(Dc),this._parents)}function A1(e,i,a){var s=this.enter(),o=this,r=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),i!=null&&(o=i(o),o&&(o=o.selection())),a==null?r.remove():a(r),s&&o?s.merge(o).order():o}function N1(e){for(var i=e.selection?e.selection():e,a=this._groups,s=i._groups,o=a.length,r=s.length,c=Math.min(o,r),l=new Array(o),h=0;h<c;++h)for(var u=a[h],m=s[h],g=u.length,b=l[h]=new Array(g),k,A=0;A<g;++A)(k=u[A]||m[A])&&(b[A]=k);for(;h<o;++h)l[h]=a[h];return new Kt(l,this._parents)}function O1(){for(var e=this._groups,i=-1,a=e.length;++i<a;)for(var s=e[i],o=s.length-1,r=s[o],c;--o>=0;)(c=s[o])&&(r&&c.compareDocumentPosition(r)^4&&r.parentNode.insertBefore(c,r),r=c);return this}function D1(e){e||(e=L1);function i(g,b){return g&&b?e(g.__data__,b.__data__):!g-!b}for(var a=this._groups,s=a.length,o=new Array(s),r=0;r<s;++r){for(var c=a[r],l=c.length,h=o[r]=new Array(l),u,m=0;m<l;++m)(u=c[m])&&(h[m]=u);h.sort(i)}return new Kt(o,this._parents).order()}function L1(e,i){return e<i?-1:e>i?1:e>=i?0:NaN}function T1(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function E1(){return Array.from(this)}function I1(){for(var e=this._groups,i=0,a=e.length;i<a;++i)for(var s=e[i],o=0,r=s.length;o<r;++o){var c=s[o];if(c)return c}return null}function P1(){let e=0;for(const i of this)++e;return e}function z1(){return!this.node()}function B1(e){for(var i=this._groups,a=0,s=i.length;a<s;++a)for(var o=i[a],r=0,c=o.length,l;r<c;++r)(l=o[r])&&e.call(l,l.__data__,r,o);return this}function $1(e){return function(){this.removeAttribute(e)}}function R1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function H1(e,i){return function(){this.setAttribute(e,i)}}function Y1(e,i){return function(){this.setAttributeNS(e.space,e.local,i)}}function V1(e,i){return function(){var a=i.apply(this,arguments);a==null?this.removeAttribute(e):this.setAttribute(e,a)}}function U1(e,i){return function(){var a=i.apply(this,arguments);a==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,a)}}function G1(e,i){var a=Ca(e);if(arguments.length<2){var s=this.node();return a.local?s.getAttributeNS(a.space,a.local):s.getAttribute(a)}return this.each((i==null?a.local?R1:$1:typeof i=="function"?a.local?U1:V1:a.local?Y1:H1)(a,i))}function Lc(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function F1(e){return function(){this.style.removeProperty(e)}}function j1(e,i,a){return function(){this.style.setProperty(e,i,a)}}function W1(e,i,a){return function(){var s=i.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,a)}}function q1(e,i,a){return arguments.length>1?this.each((i==null?F1:typeof i=="function"?W1:j1)(e,i,a??"")):Tn(this.node(),e)}function Tn(e,i){return e.style.getPropertyValue(i)||Lc(e).getComputedStyle(e,null).getPropertyValue(i)}function X1(e){return function(){delete this[e]}}function Z1(e,i){return function(){this[e]=i}}function K1(e,i){return function(){var a=i.apply(this,arguments);a==null?delete this[e]:this[e]=a}}function J1(e,i){return arguments.length>1?this.each((i==null?X1:typeof i=="function"?K1:Z1)(e,i)):this.node()[e]}function Tc(e){return e.trim().split(/^|\s+/)}function Xs(e){return e.classList||new Ec(e)}function Ec(e){this._node=e,this._names=Tc(e.getAttribute("class")||"")}Ec.prototype={add:function(e){var i=this._names.indexOf(e);i<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var i=this._names.indexOf(e);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ic(e,i){for(var a=Xs(e),s=-1,o=i.length;++s<o;)a.add(i[s])}function Pc(e,i){for(var a=Xs(e),s=-1,o=i.length;++s<o;)a.remove(i[s])}function Q1(e){return function(){Ic(this,e)}}function tm(e){return function(){Pc(this,e)}}function em(e,i){return function(){(i.apply(this,arguments)?Ic:Pc)(this,e)}}function nm(e,i){var a=Tc(e+"");if(arguments.length<2){for(var s=Xs(this.node()),o=-1,r=a.length;++o<r;)if(!s.contains(a[o]))return!1;return!0}return this.each((typeof i=="function"?em:i?Q1:tm)(a,i))}function im(){this.textContent=""}function am(e){return function(){this.textContent=e}}function sm(e){return function(){var i=e.apply(this,arguments);this.textContent=i??""}}function om(e){return arguments.length?this.each(e==null?im:(typeof e=="function"?sm:am)(e)):this.node().textContent}function rm(){this.innerHTML=""}function cm(e){return function(){this.innerHTML=e}}function lm(e){return function(){var i=e.apply(this,arguments);this.innerHTML=i??""}}function um(e){return arguments.length?this.each(e==null?rm:(typeof e=="function"?lm:cm)(e)):this.node().innerHTML}function dm(){this.nextSibling&&this.parentNode.appendChild(this)}function hm(){return this.each(dm)}function pm(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fm(){return this.each(pm)}function mm(e){var i=typeof e=="function"?e:Mc(e);return this.select(function(){return this.appendChild(i.apply(this,arguments))})}function gm(){return null}function ym(e,i){var a=typeof e=="function"?e:Mc(e),s=i==null?gm:typeof i=="function"?i:qs(i);return this.select(function(){return this.insertBefore(a.apply(this,arguments),s.apply(this,arguments)||null)})}function vm(){var e=this.parentNode;e&&e.removeChild(this)}function _m(){return this.each(vm)}function bm(){var e=this.cloneNode(!1),i=this.parentNode;return i?i.insertBefore(e,this.nextSibling):e}function Cm(){var e=this.cloneNode(!0),i=this.parentNode;return i?i.insertBefore(e,this.nextSibling):e}function wm(e){return this.select(e?Cm:bm)}function km(e){return arguments.length?this.property("__data__",e):this.node().__data__}function xm(e){return function(i){e.call(this,i,this.__data__)}}function Sm(e){return e.trim().split(/^|\s+/).map(function(i){var a="",s=i.indexOf(".");return s>=0&&(a=i.slice(s+1),i=i.slice(0,s)),{type:i,name:a}})}function Mm(e){return function(){var i=this.__on;if(i){for(var a=0,s=-1,o=i.length,r;a<o;++a)r=i[a],(!e.type||r.type===e.type)&&r.name===e.name?this.removeEventListener(r.type,r.listener,r.options):i[++s]=r;++s?i.length=s:delete this.__on}}}function Am(e,i,a){return function(){var s=this.__on,o,r=xm(i);if(s){for(var c=0,l=s.length;c<l;++c)if((o=s[c]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=r,o.options=a),o.value=i;return}}this.addEventListener(e.type,r,a),o={type:e.type,name:e.name,value:i,listener:r,options:a},s?s.push(o):this.__on=[o]}}function Nm(e,i,a){var s=Sm(e+""),o,r=s.length,c;if(arguments.length<2){var l=this.node().__on;if(l){for(var h=0,u=l.length,m;h<u;++h)for(o=0,m=l[h];o<r;++o)if((c=s[o]).type===m.type&&c.name===m.name)return m.value}return}for(l=i?Am:Mm,o=0;o<r;++o)this.each(l(s[o],i,a));return this}function zc(e,i,a){var s=Lc(e),o=s.CustomEvent;typeof o=="function"?o=new o(i,a):(o=s.document.createEvent("Event"),a?(o.initEvent(i,a.bubbles,a.cancelable),o.detail=a.detail):o.initEvent(i,!1,!1)),e.dispatchEvent(o)}function Om(e,i){return function(){return zc(this,e,i)}}function Dm(e,i){return function(){return zc(this,e,i.apply(this,arguments))}}function Lm(e,i){return this.each((typeof i=="function"?Dm:Om)(e,i))}function*Tm(){for(var e=this._groups,i=0,a=e.length;i<a;++i)for(var s=e[i],o=0,r=s.length,c;o<r;++o)(c=s[o])&&(yield c)}var Bc=[null];function Kt(e,i){this._groups=e,this._parents=i}function En(){return new Kt([[document.documentElement]],Bc)}function Em(){return this}Kt.prototype=En.prototype={constructor:Kt,select:s1,selectAll:l1,selectChild:p1,selectChildren:y1,filter:v1,data:x1,enter:_1,exit:M1,join:A1,merge:N1,selection:Em,order:O1,sort:D1,call:T1,nodes:E1,node:I1,size:P1,empty:z1,each:B1,attr:G1,style:q1,property:J1,classed:nm,text:om,html:um,raise:hm,lower:fm,append:mm,insert:ym,remove:_m,clone:wm,datum:km,on:Nm,dispatch:Lm,[Symbol.iterator]:Tm};function jt(e){return typeof e=="string"?new Kt([[document.querySelector(e)]],[document.documentElement]):new Kt([[e]],Bc)}function Im(e){let i;for(;i=e.sourceEvent;)e=i;return e}function sn(e,i){if(e=Im(e),i===void 0&&(i=e.currentTarget),i){var a=i.ownerSVGElement||i;if(a.createSVGPoint){var s=a.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(i.getScreenCTM().inverse()),[s.x,s.y]}if(i.getBoundingClientRect){var o=i.getBoundingClientRect();return[e.clientX-o.left-i.clientLeft,e.clientY-o.top-i.clientTop]}}return[e.pageX,e.pageY]}const us={capture:!0,passive:!1};function ds(e){e.preventDefault(),e.stopImmediatePropagation()}function Pm(e){var i=e.document.documentElement,a=jt(e).on("dragstart.drag",ds,us);"onselectstart"in i?a.on("selectstart.drag",ds,us):(i.__noselect=i.style.MozUserSelect,i.style.MozUserSelect="none")}function zm(e,i){var a=e.document.documentElement,s=jt(e).on("dragstart.drag",null);i&&(s.on("click.drag",ds,us),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in a?s.on("selectstart.drag",null):(a.style.MozUserSelect=a.__noselect,delete a.__noselect)}function Zs(e,i,a){e.prototype=i.prototype=a,a.constructor=e}function $c(e,i){var a=Object.create(e.prototype);for(var s in i)a[s]=i[s];return a}function gi(){}var si=.7,Ji=1/si,An="\\s*([+-]?\\d+)\\s*",oi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_e="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Bm=/^#([0-9a-f]{3,8})$/,$m=new RegExp(`^rgb\\(${An},${An},${An}\\)$`),Rm=new RegExp(`^rgb\\(${_e},${_e},${_e}\\)$`),Hm=new RegExp(`^rgba\\(${An},${An},${An},${oi}\\)$`),Ym=new RegExp(`^rgba\\(${_e},${_e},${_e},${oi}\\)$`),Vm=new RegExp(`^hsl\\(${oi},${_e},${_e}\\)$`),Um=new RegExp(`^hsla\\(${oi},${_e},${_e},${oi}\\)$`),Qo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Zs(gi,ri,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:tr,formatHex:tr,formatHex8:Gm,formatHsl:Fm,formatRgb:er,toString:er});function tr(){return this.rgb().formatHex()}function Gm(){return this.rgb().formatHex8()}function Fm(){return Rc(this).formatHsl()}function er(){return this.rgb().formatRgb()}function ri(e){var i,a;return e=(e+"").trim().toLowerCase(),(i=Bm.exec(e))?(a=i[1].length,i=parseInt(i[1],16),a===6?nr(i):a===3?new Wt(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):a===8?xi(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):a===4?xi(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=$m.exec(e))?new Wt(i[1],i[2],i[3],1):(i=Rm.exec(e))?new Wt(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=Hm.exec(e))?xi(i[1],i[2],i[3],i[4]):(i=Ym.exec(e))?xi(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=Vm.exec(e))?sr(i[1],i[2]/100,i[3]/100,1):(i=Um.exec(e))?sr(i[1],i[2]/100,i[3]/100,i[4]):Qo.hasOwnProperty(e)?nr(Qo[e]):e==="transparent"?new Wt(NaN,NaN,NaN,0):null}function nr(e){return new Wt(e>>16&255,e>>8&255,e&255,1)}function xi(e,i,a,s){return s<=0&&(e=i=a=NaN),new Wt(e,i,a,s)}function jm(e){return e instanceof gi||(e=ri(e)),e?(e=e.rgb(),new Wt(e.r,e.g,e.b,e.opacity)):new Wt}function hs(e,i,a,s){return arguments.length===1?jm(e):new Wt(e,i,a,s??1)}function Wt(e,i,a,s){this.r=+e,this.g=+i,this.b=+a,this.opacity=+s}Zs(Wt,hs,$c(gi,{brighter(e){return e=e==null?Ji:Math.pow(Ji,e),new Wt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?si:Math.pow(si,e),new Wt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Wt(un(this.r),un(this.g),un(this.b),Qi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ir,formatHex:ir,formatHex8:Wm,formatRgb:ar,toString:ar}));function ir(){return`#${cn(this.r)}${cn(this.g)}${cn(this.b)}`}function Wm(){return`#${cn(this.r)}${cn(this.g)}${cn(this.b)}${cn((isNaN(this.opacity)?1:this.opacity)*255)}`}function ar(){const e=Qi(this.opacity);return`${e===1?"rgb(":"rgba("}${un(this.r)}, ${un(this.g)}, ${un(this.b)}${e===1?")":`, ${e})`}`}function Qi(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function un(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function cn(e){return e=un(e),(e<16?"0":"")+e.toString(16)}function sr(e,i,a,s){return s<=0?e=i=a=NaN:a<=0||a>=1?e=i=NaN:i<=0&&(e=NaN),new se(e,i,a,s)}function Rc(e){if(e instanceof se)return new se(e.h,e.s,e.l,e.opacity);if(e instanceof gi||(e=ri(e)),!e)return new se;if(e instanceof se)return e;e=e.rgb();var i=e.r/255,a=e.g/255,s=e.b/255,o=Math.min(i,a,s),r=Math.max(i,a,s),c=NaN,l=r-o,h=(r+o)/2;return l?(i===r?c=(a-s)/l+(a<s)*6:a===r?c=(s-i)/l+2:c=(i-a)/l+4,l/=h<.5?r+o:2-r-o,c*=60):l=h>0&&h<1?0:c,new se(c,l,h,e.opacity)}function qm(e,i,a,s){return arguments.length===1?Rc(e):new se(e,i,a,s??1)}function se(e,i,a,s){this.h=+e,this.s=+i,this.l=+a,this.opacity=+s}Zs(se,qm,$c(gi,{brighter(e){return e=e==null?Ji:Math.pow(Ji,e),new se(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?si:Math.pow(si,e),new se(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,i=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,s=a+(a<.5?a:1-a)*i,o=2*a-s;return new Wt(Ra(e>=240?e-240:e+120,o,s),Ra(e,o,s),Ra(e<120?e+240:e-120,o,s),this.opacity)},clamp(){return new se(or(this.h),Si(this.s),Si(this.l),Qi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Qi(this.opacity);return`${e===1?"hsl(":"hsla("}${or(this.h)}, ${Si(this.s)*100}%, ${Si(this.l)*100}%${e===1?")":`, ${e})`}`}}));function or(e){return e=(e||0)%360,e<0?e+360:e}function Si(e){return Math.max(0,Math.min(1,e||0))}function Ra(e,i,a){return(e<60?i+(a-i)*e/60:e<180?a:e<240?i+(a-i)*(240-e)/60:i)*255}const Hc=e=>()=>e;function Xm(e,i){return function(a){return e+a*i}}function Zm(e,i,a){return e=Math.pow(e,a),i=Math.pow(i,a)-e,a=1/a,function(s){return Math.pow(e+s*i,a)}}function Km(e){return(e=+e)==1?Yc:function(i,a){return a-i?Zm(i,a,e):Hc(isNaN(i)?a:i)}}function Yc(e,i){var a=i-e;return a?Xm(e,a):Hc(isNaN(e)?i:e)}const rr=function e(i){var a=Km(i);function s(o,r){var c=a((o=hs(o)).r,(r=hs(r)).r),l=a(o.g,r.g),h=a(o.b,r.b),u=Yc(o.opacity,r.opacity);return function(m){return o.r=c(m),o.g=l(m),o.b=h(m),o.opacity=u(m),o+""}}return s.gamma=e,s}(1);function Ge(e,i){return e=+e,i=+i,function(a){return e*(1-a)+i*a}}var ps=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ha=new RegExp(ps.source,"g");function Jm(e){return function(){return e}}function Qm(e){return function(i){return e(i)+""}}function tg(e,i){var a=ps.lastIndex=Ha.lastIndex=0,s,o,r,c=-1,l=[],h=[];for(e=e+"",i=i+"";(s=ps.exec(e))&&(o=Ha.exec(i));)(r=o.index)>a&&(r=i.slice(a,r),l[c]?l[c]+=r:l[++c]=r),(s=s[0])===(o=o[0])?l[c]?l[c]+=o:l[++c]=o:(l[++c]=null,h.push({i:c,x:Ge(s,o)})),a=Ha.lastIndex;return a<i.length&&(r=i.slice(a),l[c]?l[c]+=r:l[++c]=r),l.length<2?h[0]?Qm(h[0].x):Jm(i):(i=h.length,function(u){for(var m=0,g;m<i;++m)l[(g=h[m]).i]=g.x(u);return l.join("")})}var cr=180/Math.PI,Vc={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Uc(e,i,a,s,o,r){var c,l,h;return(c=Math.sqrt(e*e+i*i))&&(e/=c,i/=c),(h=e*a+i*s)&&(a-=e*h,s-=i*h),(l=Math.sqrt(a*a+s*s))&&(a/=l,s/=l,h/=l),e*s<i*a&&(e=-e,i=-i,h=-h,c=-c),{translateX:o,translateY:r,rotate:Math.atan2(i,e)*cr,skewX:Math.atan(h)*cr,scaleX:c,scaleY:l}}var Mi;function eg(e){const i=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return i.isIdentity?Vc:Uc(i.a,i.b,i.c,i.d,i.e,i.f)}function ng(e){return e==null||(Mi||(Mi=document.createElementNS("http://www.w3.org/2000/svg","g")),Mi.setAttribute("transform",e),!(e=Mi.transform.baseVal.consolidate()))?Vc:(e=e.matrix,Uc(e.a,e.b,e.c,e.d,e.e,e.f))}function Gc(e,i,a,s){function o(u){return u.length?u.pop()+" ":""}function r(u,m,g,b,k,A){if(u!==g||m!==b){var T=k.push("translate(",null,i,null,a);A.push({i:T-4,x:Ge(u,g)},{i:T-2,x:Ge(m,b)})}else(g||b)&&k.push("translate("+g+i+b+a)}function c(u,m,g,b){u!==m?(u-m>180?m+=360:m-u>180&&(u+=360),b.push({i:g.push(o(g)+"rotate(",null,s)-2,x:Ge(u,m)})):m&&g.push(o(g)+"rotate("+m+s)}function l(u,m,g,b){u!==m?b.push({i:g.push(o(g)+"skewX(",null,s)-2,x:Ge(u,m)}):m&&g.push(o(g)+"skewX("+m+s)}function h(u,m,g,b,k,A){if(u!==g||m!==b){var T=k.push(o(k)+"scale(",null,",",null,")");A.push({i:T-4,x:Ge(u,g)},{i:T-2,x:Ge(m,b)})}else(g!==1||b!==1)&&k.push(o(k)+"scale("+g+","+b+")")}return function(u,m){var g=[],b=[];return u=e(u),m=e(m),r(u.translateX,u.translateY,m.translateX,m.translateY,g,b),c(u.rotate,m.rotate,g,b),l(u.skewX,m.skewX,g,b),h(u.scaleX,u.scaleY,m.scaleX,m.scaleY,g,b),u=m=null,function(k){for(var A=-1,T=b.length,B;++A<T;)g[(B=b[A]).i]=B.x(k);return g.join("")}}}var ig=Gc(eg,"px, ","px)","deg)"),ag=Gc(ng,", ",")",")"),sg=1e-12;function lr(e){return((e=Math.exp(e))+1/e)/2}function og(e){return((e=Math.exp(e))-1/e)/2}function rg(e){return((e=Math.exp(2*e))-1)/(e+1)}const cg=function e(i,a,s){function o(r,c){var l=r[0],h=r[1],u=r[2],m=c[0],g=c[1],b=c[2],k=m-l,A=g-h,T=k*k+A*A,B,z;if(T<sg)z=Math.log(b/u)/i,B=function(it){return[l+it*k,h+it*A,u*Math.exp(i*it*z)]};else{var j=Math.sqrt(T),F=(b*b-u*u+s*T)/(2*u*a*j),X=(b*b-u*u-s*T)/(2*b*a*j),st=Math.log(Math.sqrt(F*F+1)-F),ut=Math.log(Math.sqrt(X*X+1)-X);z=(ut-st)/i,B=function(it){var yt=it*z,vt=lr(st),_t=u/(a*j)*(vt*rg(i*yt+st)-og(st));return[l+_t*k,h+_t*A,u*vt/lr(i*yt+st)]}}return B.duration=z*1e3*i/Math.SQRT2,B}return o.rho=function(r){var c=Math.max(.001,+r),l=c*c,h=l*l;return e(c,l,h)},o}(Math.SQRT2,2,4);var In=0,Kn=0,jn=0,Fc=1e3,ta,Jn,ea=0,pn=0,wa=0,ci=typeof performance=="object"&&performance.now?performance:Date,jc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ks(){return pn||(jc(lg),pn=ci.now()+wa)}function lg(){pn=0}function na(){this._call=this._time=this._next=null}na.prototype=Wc.prototype={constructor:na,restart:function(e,i,a){if(typeof e!="function")throw new TypeError("callback is not a function");a=(a==null?Ks():+a)+(i==null?0:+i),!this._next&&Jn!==this&&(Jn?Jn._next=this:ta=this,Jn=this),this._call=e,this._time=a,fs()},stop:function(){this._call&&(this._call=null,this._time=1/0,fs())}};function Wc(e,i,a){var s=new na;return s.restart(e,i,a),s}function ug(){Ks(),++In;for(var e=ta,i;e;)(i=pn-e._time)>=0&&e._call.call(void 0,i),e=e._next;--In}function ur(){pn=(ea=ci.now())+wa,In=Kn=0;try{ug()}finally{In=0,hg(),pn=0}}function dg(){var e=ci.now(),i=e-ea;i>Fc&&(wa-=i,ea=e)}function hg(){for(var e,i=ta,a,s=1/0;i;)i._call?(s>i._time&&(s=i._time),e=i,i=i._next):(a=i._next,i._next=null,i=e?e._next=a:ta=a);Jn=e,fs(s)}function fs(e){if(!In){Kn&&(Kn=clearTimeout(Kn));var i=e-pn;i>24?(e<1/0&&(Kn=setTimeout(ur,e-ci.now()-wa)),jn&&(jn=clearInterval(jn))):(jn||(ea=ci.now(),jn=setInterval(dg,Fc)),In=1,jc(ur))}}function dr(e,i,a){var s=new na;return i=i==null?0:+i,s.restart(o=>{s.stop(),e(o+i)},i,a),s}var pg=Ws("start","end","cancel","interrupt"),fg=[],qc=0,hr=1,ms=2,Hi=3,pr=4,gs=5,Yi=6;function ka(e,i,a,s,o,r){var c=e.__transition;if(!c)e.__transition={};else if(a in c)return;mg(e,a,{name:i,index:s,group:o,on:pg,tween:fg,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:qc})}function Js(e,i){var a=pe(e,i);if(a.state>qc)throw new Error("too late; already scheduled");return a}function be(e,i){var a=pe(e,i);if(a.state>Hi)throw new Error("too late; already running");return a}function pe(e,i){var a=e.__transition;if(!a||!(a=a[i]))throw new Error("transition not found");return a}function mg(e,i,a){var s=e.__transition,o;s[i]=a,a.timer=Wc(r,0,a.time);function r(u){a.state=hr,a.timer.restart(c,a.delay,a.time),a.delay<=u&&c(u-a.delay)}function c(u){var m,g,b,k;if(a.state!==hr)return h();for(m in s)if(k=s[m],k.name===a.name){if(k.state===Hi)return dr(c);k.state===pr?(k.state=Yi,k.timer.stop(),k.on.call("interrupt",e,e.__data__,k.index,k.group),delete s[m]):+m<i&&(k.state=Yi,k.timer.stop(),k.on.call("cancel",e,e.__data__,k.index,k.group),delete s[m])}if(dr(function(){a.state===Hi&&(a.state=pr,a.timer.restart(l,a.delay,a.time),l(u))}),a.state=ms,a.on.call("start",e,e.__data__,a.index,a.group),a.state===ms){for(a.state=Hi,o=new Array(b=a.tween.length),m=0,g=-1;m<b;++m)(k=a.tween[m].value.call(e,e.__data__,a.index,a.group))&&(o[++g]=k);o.length=g+1}}function l(u){for(var m=u<a.duration?a.ease.call(null,u/a.duration):(a.timer.restart(h),a.state=gs,1),g=-1,b=o.length;++g<b;)o[g].call(e,m);a.state===gs&&(a.on.call("end",e,e.__data__,a.index,a.group),h())}function h(){a.state=Yi,a.timer.stop(),delete s[i];for(var u in s)return;delete e.__transition}}function Vi(e,i){var a=e.__transition,s,o,r=!0,c;if(a){i=i==null?null:i+"";for(c in a){if((s=a[c]).name!==i){r=!1;continue}o=s.state>ms&&s.state<gs,s.state=Yi,s.timer.stop(),s.on.call(o?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete a[c]}r&&delete e.__transition}}function gg(e){return this.each(function(){Vi(this,e)})}function yg(e,i){var a,s;return function(){var o=be(this,e),r=o.tween;if(r!==a){s=a=r;for(var c=0,l=s.length;c<l;++c)if(s[c].name===i){s=s.slice(),s.splice(c,1);break}}o.tween=s}}function vg(e,i,a){var s,o;if(typeof a!="function")throw new Error;return function(){var r=be(this,e),c=r.tween;if(c!==s){o=(s=c).slice();for(var l={name:i,value:a},h=0,u=o.length;h<u;++h)if(o[h].name===i){o[h]=l;break}h===u&&o.push(l)}r.tween=o}}function _g(e,i){var a=this._id;if(e+="",arguments.length<2){for(var s=pe(this.node(),a).tween,o=0,r=s.length,c;o<r;++o)if((c=s[o]).name===e)return c.value;return null}return this.each((i==null?yg:vg)(a,e,i))}function Qs(e,i,a){var s=e._id;return e.each(function(){var o=be(this,s);(o.value||(o.value={}))[i]=a.apply(this,arguments)}),function(o){return pe(o,s).value[i]}}function Xc(e,i){var a;return(typeof i=="number"?Ge:i instanceof ri?rr:(a=ri(i))?(i=a,rr):tg)(e,i)}function bg(e){return function(){this.removeAttribute(e)}}function Cg(e){return function(){this.removeAttributeNS(e.space,e.local)}}function wg(e,i,a){var s,o=a+"",r;return function(){var c=this.getAttribute(e);return c===o?null:c===s?r:r=i(s=c,a)}}function kg(e,i,a){var s,o=a+"",r;return function(){var c=this.getAttributeNS(e.space,e.local);return c===o?null:c===s?r:r=i(s=c,a)}}function xg(e,i,a){var s,o,r;return function(){var c,l=a(this),h;return l==null?void this.removeAttribute(e):(c=this.getAttribute(e),h=l+"",c===h?null:c===s&&h===o?r:(o=h,r=i(s=c,l)))}}function Sg(e,i,a){var s,o,r;return function(){var c,l=a(this),h;return l==null?void this.removeAttributeNS(e.space,e.local):(c=this.getAttributeNS(e.space,e.local),h=l+"",c===h?null:c===s&&h===o?r:(o=h,r=i(s=c,l)))}}function Mg(e,i){var a=Ca(e),s=a==="transform"?ag:Xc;return this.attrTween(e,typeof i=="function"?(a.local?Sg:xg)(a,s,Qs(this,"attr."+e,i)):i==null?(a.local?Cg:bg)(a):(a.local?kg:wg)(a,s,i))}function Ag(e,i){return function(a){this.setAttribute(e,i.call(this,a))}}function Ng(e,i){return function(a){this.setAttributeNS(e.space,e.local,i.call(this,a))}}function Og(e,i){var a,s;function o(){var r=i.apply(this,arguments);return r!==s&&(a=(s=r)&&Ng(e,r)),a}return o._value=i,o}function Dg(e,i){var a,s;function o(){var r=i.apply(this,arguments);return r!==s&&(a=(s=r)&&Ag(e,r)),a}return o._value=i,o}function Lg(e,i){var a="attr."+e;if(arguments.length<2)return(a=this.tween(a))&&a._value;if(i==null)return this.tween(a,null);if(typeof i!="function")throw new Error;var s=Ca(e);return this.tween(a,(s.local?Og:Dg)(s,i))}function Tg(e,i){return function(){Js(this,e).delay=+i.apply(this,arguments)}}function Eg(e,i){return i=+i,function(){Js(this,e).delay=i}}function Ig(e){var i=this._id;return arguments.length?this.each((typeof e=="function"?Tg:Eg)(i,e)):pe(this.node(),i).delay}function Pg(e,i){return function(){be(this,e).duration=+i.apply(this,arguments)}}function zg(e,i){return i=+i,function(){be(this,e).duration=i}}function Bg(e){var i=this._id;return arguments.length?this.each((typeof e=="function"?Pg:zg)(i,e)):pe(this.node(),i).duration}function $g(e,i){if(typeof i!="function")throw new Error;return function(){be(this,e).ease=i}}function Rg(e){var i=this._id;return arguments.length?this.each($g(i,e)):pe(this.node(),i).ease}function Hg(e,i){return function(){var a=i.apply(this,arguments);if(typeof a!="function")throw new Error;be(this,e).ease=a}}function Yg(e){if(typeof e!="function")throw new Error;return this.each(Hg(this._id,e))}function Vg(e){typeof e!="function"&&(e=Nc(e));for(var i=this._groups,a=i.length,s=new Array(a),o=0;o<a;++o)for(var r=i[o],c=r.length,l=s[o]=[],h,u=0;u<c;++u)(h=r[u])&&e.call(h,h.__data__,u,r)&&l.push(h);return new Ee(s,this._parents,this._name,this._id)}function Ug(e){if(e._id!==this._id)throw new Error;for(var i=this._groups,a=e._groups,s=i.length,o=a.length,r=Math.min(s,o),c=new Array(s),l=0;l<r;++l)for(var h=i[l],u=a[l],m=h.length,g=c[l]=new Array(m),b,k=0;k<m;++k)(b=h[k]||u[k])&&(g[k]=b);for(;l<s;++l)c[l]=i[l];return new Ee(c,this._parents,this._name,this._id)}function Gg(e){return(e+"").trim().split(/^|\s+/).every(function(i){var a=i.indexOf(".");return a>=0&&(i=i.slice(0,a)),!i||i==="start"})}function Fg(e,i,a){var s,o,r=Gg(i)?Js:be;return function(){var c=r(this,e),l=c.on;l!==s&&(o=(s=l).copy()).on(i,a),c.on=o}}function jg(e,i){var a=this._id;return arguments.length<2?pe(this.node(),a).on.on(e):this.each(Fg(a,e,i))}function Wg(e){return function(){var i=this.parentNode;for(var a in this.__transition)if(+a!==e)return;i&&i.removeChild(this)}}function qg(){return this.on("end.remove",Wg(this._id))}function Xg(e){var i=this._name,a=this._id;typeof e!="function"&&(e=qs(e));for(var s=this._groups,o=s.length,r=new Array(o),c=0;c<o;++c)for(var l=s[c],h=l.length,u=r[c]=new Array(h),m,g,b=0;b<h;++b)(m=l[b])&&(g=e.call(m,m.__data__,b,l))&&("__data__"in m&&(g.__data__=m.__data__),u[b]=g,ka(u[b],i,a,b,u,pe(m,a)));return new Ee(r,this._parents,i,a)}function Zg(e){var i=this._name,a=this._id;typeof e!="function"&&(e=Ac(e));for(var s=this._groups,o=s.length,r=[],c=[],l=0;l<o;++l)for(var h=s[l],u=h.length,m,g=0;g<u;++g)if(m=h[g]){for(var b=e.call(m,m.__data__,g,h),k,A=pe(m,a),T=0,B=b.length;T<B;++T)(k=b[T])&&ka(k,i,a,T,b,A);r.push(b),c.push(m)}return new Ee(r,c,i,a)}var Kg=En.prototype.constructor;function Jg(){return new Kg(this._groups,this._parents)}function Qg(e,i){var a,s,o;return function(){var r=Tn(this,e),c=(this.style.removeProperty(e),Tn(this,e));return r===c?null:r===a&&c===s?o:o=i(a=r,s=c)}}function Zc(e){return function(){this.style.removeProperty(e)}}function t0(e,i,a){var s,o=a+"",r;return function(){var c=Tn(this,e);return c===o?null:c===s?r:r=i(s=c,a)}}function e0(e,i,a){var s,o,r;return function(){var c=Tn(this,e),l=a(this),h=l+"";return l==null&&(h=l=(this.style.removeProperty(e),Tn(this,e))),c===h?null:c===s&&h===o?r:(o=h,r=i(s=c,l))}}function n0(e,i){var a,s,o,r="style."+i,c="end."+r,l;return function(){var h=be(this,e),u=h.on,m=h.value[r]==null?l||(l=Zc(i)):void 0;(u!==a||o!==m)&&(s=(a=u).copy()).on(c,o=m),h.on=s}}function i0(e,i,a){var s=(e+="")=="transform"?ig:Xc;return i==null?this.styleTween(e,Qg(e,s)).on("end.style."+e,Zc(e)):typeof i=="function"?this.styleTween(e,e0(e,s,Qs(this,"style."+e,i))).each(n0(this._id,e)):this.styleTween(e,t0(e,s,i),a).on("end.style."+e,null)}function a0(e,i,a){return function(s){this.style.setProperty(e,i.call(this,s),a)}}function s0(e,i,a){var s,o;function r(){var c=i.apply(this,arguments);return c!==o&&(s=(o=c)&&a0(e,c,a)),s}return r._value=i,r}function o0(e,i,a){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(i==null)return this.tween(s,null);if(typeof i!="function")throw new Error;return this.tween(s,s0(e,i,a??""))}function r0(e){return function(){this.textContent=e}}function c0(e){return function(){var i=e(this);this.textContent=i??""}}function l0(e){return this.tween("text",typeof e=="function"?c0(Qs(this,"text",e)):r0(e==null?"":e+""))}function u0(e){return function(i){this.textContent=e.call(this,i)}}function d0(e){var i,a;function s(){var o=e.apply(this,arguments);return o!==a&&(i=(a=o)&&u0(o)),i}return s._value=e,s}function h0(e){var i="text";if(arguments.length<1)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,d0(e))}function p0(){for(var e=this._name,i=this._id,a=Kc(),s=this._groups,o=s.length,r=0;r<o;++r)for(var c=s[r],l=c.length,h,u=0;u<l;++u)if(h=c[u]){var m=pe(h,i);ka(h,e,a,u,c,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new Ee(s,this._parents,e,a)}function f0(){var e,i,a=this,s=a._id,o=a.size();return new Promise(function(r,c){var l={value:c},h={value:function(){--o===0&&r()}};a.each(function(){var u=be(this,s),m=u.on;m!==e&&(i=(e=m).copy(),i._.cancel.push(l),i._.interrupt.push(l),i._.end.push(h)),u.on=i}),o===0&&r()})}var m0=0;function Ee(e,i,a,s){this._groups=e,this._parents=i,this._name=a,this._id=s}function Kc(){return++m0}var xe=En.prototype;Ee.prototype={constructor:Ee,select:Xg,selectAll:Zg,selectChild:xe.selectChild,selectChildren:xe.selectChildren,filter:Vg,merge:Ug,selection:Jg,transition:p0,call:xe.call,nodes:xe.nodes,node:xe.node,size:xe.size,empty:xe.empty,each:xe.each,on:jg,attr:Mg,attrTween:Lg,style:i0,styleTween:o0,text:l0,textTween:h0,remove:qg,tween:_g,delay:Ig,duration:Bg,ease:Rg,easeVarying:Yg,end:f0,[Symbol.iterator]:xe[Symbol.iterator]};function g0(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var y0={time:null,delay:0,duration:250,ease:g0};function v0(e,i){for(var a;!(a=e.__transition)||!(a=a[i]);)if(!(e=e.parentNode))throw new Error(`transition ${i} not found`);return a}function _0(e){var i,a;e instanceof Ee?(i=e._id,e=e._name):(i=Kc(),(a=y0).time=Ks(),e=e==null?null:e+"");for(var s=this._groups,o=s.length,r=0;r<o;++r)for(var c=s[r],l=c.length,h,u=0;u<l;++u)(h=c[u])&&ka(h,e,i,u,c,a||v0(h,i));return new Ee(s,this._parents,e,i)}En.prototype.interrupt=gg,En.prototype.transition=_0;const ys=Math.PI,vs=2*ys,rn=1e-6,b0=vs-rn;function _s(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Jc(){return new _s}_s.prototype=Jc.prototype={constructor:_s,moveTo:function(e,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+i)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,i){this._+="L"+(this._x1=+e)+","+(this._y1=+i)},quadraticCurveTo:function(e,i,a,s){this._+="Q"+ +e+","+ +i+","+(this._x1=+a)+","+(this._y1=+s)},bezierCurveTo:function(e,i,a,s,o,r){this._+="C"+ +e+","+ +i+","+ +a+","+ +s+","+(this._x1=+o)+","+(this._y1=+r)},arcTo:function(e,i,a,s,o){e=+e,i=+i,a=+a,s=+s,o=+o;var r=this._x1,c=this._y1,l=a-e,h=s-i,u=r-e,m=c-i,g=u*u+m*m;if(o<0)throw new Error("negative radius: "+o);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=i);else if(g>rn)if(!(Math.abs(m*l-h*u)>rn)||!o)this._+="L"+(this._x1=e)+","+(this._y1=i);else{var b=a-r,k=s-c,A=l*l+h*h,T=b*b+k*k,B=Math.sqrt(A),z=Math.sqrt(g),j=o*Math.tan((ys-Math.acos((A+g-T)/(2*B*z)))/2),F=j/z,X=j/B;Math.abs(F-1)>rn&&(this._+="L"+(e+F*u)+","+(i+F*m)),this._+="A"+o+","+o+",0,0,"+ +(m*b>u*k)+","+(this._x1=e+X*l)+","+(this._y1=i+X*h)}},arc:function(e,i,a,s,o,r){e=+e,i=+i,a=+a,r=!!r;var c=a*Math.cos(s),l=a*Math.sin(s),h=e+c,u=i+l,m=1^r,g=r?s-o:o-s;if(a<0)throw new Error("negative radius: "+a);this._x1===null?this._+="M"+h+","+u:(Math.abs(this._x1-h)>rn||Math.abs(this._y1-u)>rn)&&(this._+="L"+h+","+u),a&&(g<0&&(g=g%vs+vs),g>b0?this._+="A"+a+","+a+",0,1,"+m+","+(e-c)+","+(i-l)+"A"+a+","+a+",0,1,"+m+","+(this._x1=h)+","+(this._y1=u):g>rn&&(this._+="A"+a+","+a+",0,"+ +(g>=ys)+","+m+","+(this._x1=e+a*Math.cos(o))+","+(this._y1=i+a*Math.sin(o))))},rect:function(e,i,a,s){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+i)+"h"+ +a+"v"+ +s+"h"+-a+"Z"},toString:function(){return this._}};function C0(e){var i=0,a=e.children,s=a&&a.length;if(!s)i=1;else for(;--s>=0;)i+=a[s].value;e.value=i}function w0(){return this.eachAfter(C0)}function k0(e,i){let a=-1;for(const s of this)e.call(i,s,++a,this);return this}function x0(e,i){for(var a=this,s=[a],o,r,c=-1;a=s.pop();)if(e.call(i,a,++c,this),o=a.children)for(r=o.length-1;r>=0;--r)s.push(o[r]);return this}function S0(e,i){for(var a=this,s=[a],o=[],r,c,l,h=-1;a=s.pop();)if(o.push(a),r=a.children)for(c=0,l=r.length;c<l;++c)s.push(r[c]);for(;a=o.pop();)e.call(i,a,++h,this);return this}function M0(e,i){let a=-1;for(const s of this)if(e.call(i,s,++a,this))return s}function A0(e){return this.eachAfter(function(i){for(var a=+e(i.data)||0,s=i.children,o=s&&s.length;--o>=0;)a+=s[o].value;i.value=a})}function N0(e){return this.eachBefore(function(i){i.children&&i.children.sort(e)})}function O0(e){for(var i=this,a=D0(i,e),s=[i];i!==a;)i=i.parent,s.push(i);for(var o=s.length;e!==a;)s.splice(o,0,e),e=e.parent;return s}function D0(e,i){if(e===i)return e;var a=e.ancestors(),s=i.ancestors(),o=null;for(e=a.pop(),i=s.pop();e===i;)o=e,e=a.pop(),i=s.pop();return o}function L0(){for(var e=this,i=[e];e=e.parent;)i.push(e);return i}function T0(){return Array.from(this)}function E0(){var e=[];return this.eachBefore(function(i){i.children||e.push(i)}),e}function I0(){var e=this,i=[];return e.each(function(a){a!==e&&i.push({source:a.parent,target:a})}),i}function*P0(){var e=this,i,a=[e],s,o,r;do for(i=a.reverse(),a=[];e=i.pop();)if(yield e,s=e.children)for(o=0,r=s.length;o<r;++o)a.push(s[o]);while(a.length)}function Qc(e,i){e instanceof Map?(e=[void 0,e],i===void 0&&(i=$0)):i===void 0&&(i=B0);for(var a=new Pn(e),s,o=[a],r,c,l,h;s=o.pop();)if((c=i(s.data))&&(h=(c=Array.from(c)).length))for(s.children=c,l=h-1;l>=0;--l)o.push(r=c[l]=new Pn(c[l])),r.parent=s,r.depth=s.depth+1;return a.eachBefore(tl)}function z0(){return Qc(this).eachBefore(R0)}function B0(e){return e.children}function $0(e){return Array.isArray(e)?e[1]:null}function R0(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function tl(e){var i=0;do e.height=i;while((e=e.parent)&&e.height<++i)}function Pn(e){this.data=e,this.depth=this.height=0,this.parent=null}Pn.prototype=Qc.prototype={constructor:Pn,count:w0,each:k0,eachAfter:S0,eachBefore:x0,find:M0,sum:A0,sort:N0,path:O0,ancestors:L0,descendants:T0,leaves:E0,links:I0,copy:z0,[Symbol.iterator]:P0};function Ya(e){return e==null?null:H0(e)}function H0(e){if(typeof e!="function")throw new Error;return e}var Y0={depth:-1},fr={},Va={};function V0(e){return e.id}function U0(e){return e.parentId}function G0(){var e=V0,i=U0,a;function s(o){var r=Array.from(o),c=e,l=i,h,u,m,g,b,k,A,T,B=new Map;if(a!=null){const z=r.map((X,st)=>F0(a(X,st,o))),j=z.map(mr),F=new Set(z).add("");for(const X of j)F.has(X)||(F.add(X),z.push(X),j.push(mr(X)),r.push(Va));c=(X,st)=>z[st],l=(X,st)=>j[st]}for(m=0,h=r.length;m<h;++m)u=r[m],k=r[m]=new Pn(u),(A=c(u,m,o))!=null&&(A+="")&&(T=k.id=A,B.set(T,B.has(T)?fr:k)),(A=l(u,m,o))!=null&&(A+="")&&(k.parent=A);for(m=0;m<h;++m)if(k=r[m],A=k.parent){if(b=B.get(A),!b)throw new Error("missing: "+A);if(b===fr)throw new Error("ambiguous: "+A);b.children?b.children.push(k):b.children=[k],k.parent=b}else{if(g)throw new Error("multiple roots");g=k}if(!g)throw new Error("no root");if(a!=null){for(;g.data===Va&&g.children.length===1;)g=g.children[0],--h;for(let z=r.length-1;z>=0&&(k=r[z],k.data===Va);--z)k.data=null}if(g.parent=Y0,g.eachBefore(function(z){z.depth=z.parent.depth+1,--h}).eachBefore(tl),g.parent=null,h>0)throw new Error("cycle");return g}return s.id=function(o){return arguments.length?(e=Ya(o),s):e},s.parentId=function(o){return arguments.length?(i=Ya(o),s):i},s.path=function(o){return arguments.length?(a=Ya(o),s):a},s}function F0(e){e=`${e}`;let i=e.length;return bs(e,i-1)&&!bs(e,i-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function mr(e){let i=e.length;if(i<2)return"";for(;--i>1&&!bs(e,i););return e.slice(0,i)}function bs(e,i){if(e[i]==="/"){let a=0;for(;i>0&&e[--i]==="\\";)++a;if(!(a&1))return!0}return!1}function j0(e,i){return e.parent===i.parent?1:2}function Ua(e){var i=e.children;return i?i[0]:e.t}function Ga(e){var i=e.children;return i?i[i.length-1]:e.t}function W0(e,i,a){var s=a/(i.i-e.i);i.c-=s,i.s+=a,e.c+=s,i.z+=a,i.m+=a}function q0(e){for(var i=0,a=0,s=e.children,o=s.length,r;--o>=0;)r=s[o],r.z+=i,r.m+=i,i+=r.s+(a+=r.c)}function X0(e,i,a){return e.a.parent===i.parent?e.a:a}function Ui(e,i){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=i}Ui.prototype=Object.create(Pn.prototype);function Z0(e){for(var i=new Ui(e,0),a,s=[i],o,r,c,l;a=s.pop();)if(r=a._.children)for(a.children=new Array(l=r.length),c=l-1;c>=0;--c)s.push(o=a.children[c]=new Ui(r[c],c)),o.parent=a;return(i.parent=new Ui(null,0)).children=[i],i}function K0(){var e=j0,i=1,a=1,s=null;function o(u){var m=Z0(u);if(m.eachAfter(r),m.parent.m=-m.z,m.eachBefore(c),s)u.eachBefore(h);else{var g=u,b=u,k=u;u.eachBefore(function(j){j.x<g.x&&(g=j),j.x>b.x&&(b=j),j.depth>k.depth&&(k=j)});var A=g===b?1:e(g,b)/2,T=A-g.x,B=i/(b.x+A+T),z=a/(k.depth||1);u.eachBefore(function(j){j.x=(j.x+T)*B,j.y=j.depth*z})}return u}function r(u){var m=u.children,g=u.parent.children,b=u.i?g[u.i-1]:null;if(m){q0(u);var k=(m[0].z+m[m.length-1].z)/2;b?(u.z=b.z+e(u._,b._),u.m=u.z-k):u.z=k}else b&&(u.z=b.z+e(u._,b._));u.parent.A=l(u,b,u.parent.A||g[0])}function c(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function l(u,m,g){if(m){for(var b=u,k=u,A=m,T=b.parent.children[0],B=b.m,z=k.m,j=A.m,F=T.m,X;A=Ga(A),b=Ua(b),A&&b;)T=Ua(T),k=Ga(k),k.a=u,X=A.z+j-b.z-B+e(A._,b._),X>0&&(W0(X0(A,u,g),u,X),B+=X,z+=X),j+=A.m,B+=b.m,F+=T.m,z+=k.m;A&&!Ga(k)&&(k.t=A,k.m+=j-z),b&&!Ua(T)&&(T.t=b,T.m+=B-F,g=u)}return g}function h(u){u.x*=i,u.y=u.depth*a}return o.separation=function(u){return arguments.length?(e=u,o):e},o.size=function(u){return arguments.length?(s=!1,i=+u[0],a=+u[1],o):s?null:[i,a]},o.nodeSize=function(u){return arguments.length?(s=!0,i=+u[0],a=+u[1],o):s?[i,a]:null},o}function gr(e){return function(){return e}}var J0=Array.prototype.slice;function Q0(e){return e[0]}function ty(e){return e[1]}class ey{constructor(i,a){this._context=i,this._x=a}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(i,a){switch(i=+i,a=+a,this._point){case 0:{this._point=1,this._line?this._context.lineTo(i,a):this._context.moveTo(i,a);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+i)/2,this._y0,this._x0,a,i,a):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+a)/2,i,this._y0,i,a);break}}this._x0=i,this._y0=a}}function ny(e){return new ey(e,!0)}function iy(e){return e.source}function ay(e){return e.target}function sy(e){let i=iy,a=ay,s=Q0,o=ty,r=null,c=null;function l(){let h;const u=J0.call(arguments),m=i.apply(this,u),g=a.apply(this,u);if(r==null&&(c=e(h=Jc())),c.lineStart(),u[0]=m,c.point(+s.apply(this,u),+o.apply(this,u)),u[0]=g,c.point(+s.apply(this,u),+o.apply(this,u)),c.lineEnd(),h)return c=null,h+""||null}return l.source=function(h){return arguments.length?(i=h,l):i},l.target=function(h){return arguments.length?(a=h,l):a},l.x=function(h){return arguments.length?(s=typeof h=="function"?h:gr(+h),l):s},l.y=function(h){return arguments.length?(o=typeof h=="function"?h:gr(+h),l):o},l.context=function(h){return arguments.length?(h==null?r=c=null:c=e(r=h),l):r},l}function oy(){return sy(ny)}const Ai=e=>()=>e;function ry(e,{sourceEvent:i,target:a,transform:s,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:i,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:o}})}function Ae(e,i,a){this.k=e,this.x=i,this.y=a}Ae.prototype={constructor:Ae,scale:function(e){return e===1?this:new Ae(this.k*e,this.x,this.y)},translate:function(e,i){return e===0&i===0?this:new Ae(this.k,this.x+this.k*e,this.y+this.k*i)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var to=new Ae(1,0,0);Ae.prototype;function Fa(e){e.stopImmediatePropagation()}function Wn(e){e.preventDefault(),e.stopImmediatePropagation()}function cy(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function ly(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function yr(){return this.__zoom||to}function uy(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function dy(){return navigator.maxTouchPoints||"ontouchstart"in this}function hy(e,i,a){var s=e.invertX(i[0][0])-a[0][0],o=e.invertX(i[1][0])-a[1][0],r=e.invertY(i[0][1])-a[0][1],c=e.invertY(i[1][1])-a[1][1];return e.translate(o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o),c>r?(r+c)/2:Math.min(0,r)||Math.max(0,c))}function py(){var e=cy,i=ly,a=hy,s=uy,o=dy,r=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],l=250,h=cg,u=Ws("start","zoom","end"),m,g,b,k=500,A=150,T=0,B=10;function z(y){y.property("__zoom",yr).on("wheel.zoom",yt,{passive:!1}).on("mousedown.zoom",vt).on("dblclick.zoom",_t).filter(o).on("touchstart.zoom",S).on("touchmove.zoom",x).on("touchend.zoom touchcancel.zoom",w).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}z.transform=function(y,N,O,Y){var G=y.selection?y.selection():y;G.property("__zoom",yr),y!==G?st(y,N,O,Y):G.interrupt().each(function(){ut(this,arguments).event(Y).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},z.scaleBy=function(y,N,O,Y){z.scaleTo(y,function(){var G=this.__zoom.k,q=typeof N=="function"?N.apply(this,arguments):N;return G*q},O,Y)},z.scaleTo=function(y,N,O,Y){z.transform(y,function(){var G=i.apply(this,arguments),q=this.__zoom,Z=O==null?X(G):typeof O=="function"?O.apply(this,arguments):O,J=q.invert(Z),ot=typeof N=="function"?N.apply(this,arguments):N;return a(F(j(q,ot),Z,J),G,c)},O,Y)},z.translateBy=function(y,N,O,Y){z.transform(y,function(){return a(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof O=="function"?O.apply(this,arguments):O),i.apply(this,arguments),c)},null,Y)},z.translateTo=function(y,N,O,Y,G){z.transform(y,function(){var q=i.apply(this,arguments),Z=this.__zoom,J=Y==null?X(q):typeof Y=="function"?Y.apply(this,arguments):Y;return a(to.translate(J[0],J[1]).scale(Z.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof O=="function"?-O.apply(this,arguments):-O),q,c)},Y,G)};function j(y,N){return N=Math.max(r[0],Math.min(r[1],N)),N===y.k?y:new Ae(N,y.x,y.y)}function F(y,N,O){var Y=N[0]-O[0]*y.k,G=N[1]-O[1]*y.k;return Y===y.x&&G===y.y?y:new Ae(y.k,Y,G)}function X(y){return[(+y[0][0]+ +y[1][0])/2,(+y[0][1]+ +y[1][1])/2]}function st(y,N,O,Y){y.on("start.zoom",function(){ut(this,arguments).event(Y).start()}).on("interrupt.zoom end.zoom",function(){ut(this,arguments).event(Y).end()}).tween("zoom",function(){var G=this,q=arguments,Z=ut(G,q).event(Y),J=i.apply(G,q),ot=O==null?X(J):typeof O=="function"?O.apply(G,q):O,xt=Math.max(J[1][0]-J[0][0],J[1][1]-J[0][1]),mt=G.__zoom,Tt=typeof N=="function"?N.apply(G,q):N,Bt=h(mt.invert(ot).concat(xt/mt.k),Tt.invert(ot).concat(xt/Tt.k));return function(St){if(St===1)St=Tt;else{var Nt=Bt(St),qt=xt/Nt[2];St=new Ae(qt,ot[0]-Nt[0]*qt,ot[1]-Nt[1]*qt)}Z.zoom(null,St)}})}function ut(y,N,O){return!O&&y.__zooming||new it(y,N)}function it(y,N){this.that=y,this.args=N,this.active=0,this.sourceEvent=null,this.extent=i.apply(y,N),this.taps=0}it.prototype={event:function(y){return y&&(this.sourceEvent=y),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(y,N){return this.mouse&&y!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&y!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&y!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(y){var N=jt(this.that).datum();u.call(y,this.that,new ry(y,{sourceEvent:this.sourceEvent,target:z,type:y,transform:this.that.__zoom,dispatch:u}),N)}};function yt(y,...N){if(!e.apply(this,arguments))return;var O=ut(this,N).event(y),Y=this.__zoom,G=Math.max(r[0],Math.min(r[1],Y.k*Math.pow(2,s.apply(this,arguments)))),q=sn(y);if(O.wheel)(O.mouse[0][0]!==q[0]||O.mouse[0][1]!==q[1])&&(O.mouse[1]=Y.invert(O.mouse[0]=q)),clearTimeout(O.wheel);else{if(Y.k===G)return;O.mouse=[q,Y.invert(q)],Vi(this),O.start()}Wn(y),O.wheel=setTimeout(Z,A),O.zoom("mouse",a(F(j(Y,G),O.mouse[0],O.mouse[1]),O.extent,c));function Z(){O.wheel=null,O.end()}}function vt(y,...N){if(b||!e.apply(this,arguments))return;var O=y.currentTarget,Y=ut(this,N,!0).event(y),G=jt(y.view).on("mousemove.zoom",ot,!0).on("mouseup.zoom",xt,!0),q=sn(y,O),Z=y.clientX,J=y.clientY;Pm(y.view),Fa(y),Y.mouse=[q,this.__zoom.invert(q)],Vi(this),Y.start();function ot(mt){if(Wn(mt),!Y.moved){var Tt=mt.clientX-Z,Bt=mt.clientY-J;Y.moved=Tt*Tt+Bt*Bt>T}Y.event(mt).zoom("mouse",a(F(Y.that.__zoom,Y.mouse[0]=sn(mt,O),Y.mouse[1]),Y.extent,c))}function xt(mt){G.on("mousemove.zoom mouseup.zoom",null),zm(mt.view,Y.moved),Wn(mt),Y.event(mt).end()}}function _t(y,...N){if(e.apply(this,arguments)){var O=this.__zoom,Y=sn(y.changedTouches?y.changedTouches[0]:y,this),G=O.invert(Y),q=O.k*(y.shiftKey?.5:2),Z=a(F(j(O,q),Y,G),i.apply(this,N),c);Wn(y),l>0?jt(this).transition().duration(l).call(st,Z,Y,y):jt(this).call(z.transform,Z,Y,y)}}function S(y,...N){if(e.apply(this,arguments)){var O=y.touches,Y=O.length,G=ut(this,N,y.changedTouches.length===Y).event(y),q,Z,J,ot;for(Fa(y),Z=0;Z<Y;++Z)J=O[Z],ot=sn(J,this),ot=[ot,this.__zoom.invert(ot),J.identifier],G.touch0?!G.touch1&&G.touch0[2]!==ot[2]&&(G.touch1=ot,G.taps=0):(G.touch0=ot,q=!0,G.taps=1+!!m);m&&(m=clearTimeout(m)),q&&(G.taps<2&&(g=ot[0],m=setTimeout(function(){m=null},k)),Vi(this),G.start())}}function x(y,...N){if(this.__zooming){var O=ut(this,N).event(y),Y=y.changedTouches,G=Y.length,q,Z,J,ot;for(Wn(y),q=0;q<G;++q)Z=Y[q],J=sn(Z,this),O.touch0&&O.touch0[2]===Z.identifier?O.touch0[0]=J:O.touch1&&O.touch1[2]===Z.identifier&&(O.touch1[0]=J);if(Z=O.that.__zoom,O.touch1){var xt=O.touch0[0],mt=O.touch0[1],Tt=O.touch1[0],Bt=O.touch1[1],St=(St=Tt[0]-xt[0])*St+(St=Tt[1]-xt[1])*St,Nt=(Nt=Bt[0]-mt[0])*Nt+(Nt=Bt[1]-mt[1])*Nt;Z=j(Z,Math.sqrt(St/Nt)),J=[(xt[0]+Tt[0])/2,(xt[1]+Tt[1])/2],ot=[(mt[0]+Bt[0])/2,(mt[1]+Bt[1])/2]}else if(O.touch0)J=O.touch0[0],ot=O.touch0[1];else return;O.zoom("touch",a(F(Z,J,ot),O.extent,c))}}function w(y,...N){if(this.__zooming){var O=ut(this,N).event(y),Y=y.changedTouches,G=Y.length,q,Z;for(Fa(y),b&&clearTimeout(b),b=setTimeout(function(){b=null},k),q=0;q<G;++q)Z=Y[q],O.touch0&&O.touch0[2]===Z.identifier?delete O.touch0:O.touch1&&O.touch1[2]===Z.identifier&&delete O.touch1;if(O.touch1&&!O.touch0&&(O.touch0=O.touch1,delete O.touch1),O.touch0)O.touch0[1]=this.__zoom.invert(O.touch0[0]);else if(O.end(),O.taps===2&&(Z=sn(Z,this),Math.hypot(g[0]-Z[0],g[1]-Z[1])<B)){var J=jt(this).on("dblclick.zoom");J&&J.apply(this,arguments)}}}return z.wheelDelta=function(y){return arguments.length?(s=typeof y=="function"?y:Ai(+y),z):s},z.filter=function(y){return arguments.length?(e=typeof y=="function"?y:Ai(!!y),z):e},z.touchable=function(y){return arguments.length?(o=typeof y=="function"?y:Ai(!!y),z):o},z.extent=function(y){return arguments.length?(i=typeof y=="function"?y:Ai([[+y[0][0],+y[0][1]],[+y[1][0],+y[1][1]]]),z):i},z.scaleExtent=function(y){return arguments.length?(r[0]=+y[0],r[1]=+y[1],z):[r[0],r[1]]},z.translateExtent=function(y){return arguments.length?(c[0][0]=+y[0][0],c[1][0]=+y[1][0],c[0][1]=+y[0][1],c[1][1]=+y[1][1],z):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},z.constrain=function(y){return arguments.length?(a=y,z):a},z.duration=function(y){return arguments.length?(l=+y,z):l},z.interpolate=function(y){return arguments.length?(h=y,z):h},z.on=function(){var y=u.on.apply(u,arguments);return y===u?z:y},z.clickDistance=function(y){return arguments.length?(T=(y=+y)*y,z):Math.sqrt(T)},z.tapDistance=function(y){return arguments.length?(B=+y,z):B},z}const fy={name:"ChartTemplate",components:{Avatar:Bn},props:{data:{type:Object,default:()=>{}},onAvatarClick:{type:Function,default:()=>{}}},computed:{selectedChart(){return this.$route.params.selectedChart}}};var my=function(){var e=this,i=e._self._c;return i("div",{staticClass:"org-chart-node"},[i("div",{staticClass:"inner-box"},[i("router-link",{attrs:{to:{name:"contact",params:{selectedGroup:e.selectedChart,selectedContact:e.data.key}}}},[i("Avatar",{staticClass:"org-chart-node__avatar",attrs:{"disable-tooltip":!0,"display-name":e.data.fullName,"is-no-user":!0,size:60,url:e.data.photoUrl}})],1),i("div",{staticClass:"panel"}),i("div",{staticClass:"main-container"},[i("h3",{staticClass:"fullName"},[e._v(" "+e._s(e.data.fullName)+" ")]),i("h4",{staticClass:"title"},[e._v(" "+e._s(e.data.title)+" ")])]),i("div",{staticClass:"description"},[e.data._directSubordinates?i("p",[e._v(" "+e._s(e.t("contacts","Manages"))+": "+e._s(e.data._directSubordinates)+" ")]):e._e(),e.data._totalSubordinates?i("p",[e._v(" "+e._s(e.t("contacts","Oversees"))+": "+e._s(e.data._totalSubordinates)+" ")]):e._e()])],1)])},gy=[],yy=H(fy,my,gy,!1,null,"88066ec3");const vy=yy.exports;function _y(e){var i=0,a=e.children,s=a&&a.length;if(!s)i=1;else for(;--s>=0;)i+=a[s].value;e.value=i}function by(){return this.eachAfter(_y)}function Cy(e){var i=this,a,s=[i],o,r,c;do for(a=s.reverse(),s=[];i=a.pop();)if(e(i),o=i.children,o)for(r=0,c=o.length;r<c;++r)s.push(o[r]);while(s.length);return this}function wy(e){for(var i=this,a=[i],s,o;i=a.pop();)if(e(i),s=i.children,s)for(o=s.length-1;o>=0;--o)a.push(s[o]);return this}function ky(e){for(var i=this,a=[i],s=[],o,r,c;i=a.pop();)if(s.push(i),o=i.children,o)for(r=0,c=o.length;r<c;++r)a.push(o[r]);for(;i=s.pop();)e(i);return this}function xy(e){return this.eachAfter(function(i){for(var a=+e(i.data)||0,s=i.children,o=s&&s.length;--o>=0;)a+=s[o].value;i.value=a})}function Sy(e){return this.eachBefore(function(i){i.children&&i.children.sort(e)})}function My(e){for(var i=this,a=Ay(i,e),s=[i];i!==a;)i=i.parent,s.push(i);for(var o=s.length;e!==a;)s.splice(o,0,e),e=e.parent;return s}function Ay(e,i){if(e===i)return e;var a=e.ancestors(),s=i.ancestors(),o=null;for(e=a.pop(),i=s.pop();e===i;)o=e,e=a.pop(),i=s.pop();return o}function Ny(){for(var e=this,i=[e];e=e.parent;)i.push(e);return i}function Oy(){var e=[];return this.each(function(i){e.push(i)}),e}function Dy(){var e=[];return this.eachBefore(function(i){i.children||e.push(i)}),e}function Ly(){var e=this,i=[];return e.each(function(a){a!==e&&i.push({source:a.parent,target:a})}),i}function eo(e,i){var a=new ia(e),s=+e.value&&(a.value=e.value),o,r=[a],c,l,h,u;for(i==null&&(i=Ey);o=r.pop();)if(s&&(o.value=+o.data.value),(l=i(o.data))&&(u=l.length))for(o.children=new Array(u),h=u-1;h>=0;--h)r.push(c=o.children[h]=new ia(l[h])),c.parent=o,c.depth=o.depth+1;return a.eachBefore(Py)}function Ty(){return eo(this).eachBefore(Iy)}function Ey(e){return e.children}function Iy(e){e.data=e.data.data}function Py(e){var i=0;do e.height=i;while((e=e.parent)&&e.height<++i)}function ia(e){this.data=e,this.depth=this.height=0,this.parent=null}ia.prototype=eo.prototype={constructor:ia,count:by,each:Cy,eachAfter:ky,eachBefore:wy,sum:xy,sort:Sy,path:My,ancestors:Ny,descendants:Oy,leaves:Dy,links:Ly,copy:Ty};const zy="d3-flextree",By="2.1.2",$y="build/d3-flextree.js",Ry="index",Hy={name:"Chris Maloney",url:"http://chrismaloney.org"},Yy="Flexible tree layout algorithm that allows for variable node sizes.",Vy=["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],Uy="https://github.com/klortho/d3-flextree",Gy="WTFPL",Fy={type:"git",url:"https://github.com/klortho/d3-flextree.git"},jy={clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},Wy={"d3-hierarchy":"^1.1.5"},qy={"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"},Xy={name:zy,version:By,main:$y,module:Ry,"jsnext:main":"index",author:Hy,description:Yy,keywords:Vy,homepage:Uy,license:Gy,repository:Fy,scripts:jy,dependencies:Wy,devDependencies:qy},{version:Zy}=Xy,Ky=Object.freeze({children:e=>e.children,nodeSize:e=>e.data.size,spacing:0});function no(e){const i=Object.assign({},Ky,e);function a(l){const h=i[l];return typeof h=="function"?h:()=>h}function s(l){const h=c(r(),l,u=>u.children);return h.update(),h.data}function o(){const l=a("nodeSize"),h=a("spacing");return class el extends eo.prototype.constructor{constructor(m){super(m)}copy(){const m=c(this.constructor,this,g=>g.children);return m.each(g=>g.data=g.data.data),m}get size(){return l(this)}spacing(m){return h(this,m)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const m=this.ancestors();return m[m.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return this.children===null}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce((m,g)=>el.maxExtents(m,g.extents),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(m,g){return{top:Math.min(m.top,g.top),bottom:Math.max(m.bottom,g.bottom),left:Math.min(m.left,g.left),right:Math.max(m.right,g.right)}}}}function r(){const l=o(),h=a("nodeSize"),u=a("spacing");return class extends l{constructor(m){super(m),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return h(this.data)}spacing(m){return u(this.data,m.data)}get x(){return this.data.x}set x(m){this.data.x=m}get y(){return this.data.y}set y(m){this.data.y=m}update(){return nl(this),il(this),this}}}function c(l,h,u){const m=(g,b)=>{const k=new l(g);Object.assign(k,{parent:b,depth:b===null?0:b.depth+1,height:0,length:1});const A=u(g)||[];return k.children=A.length===0?null:A.map(T=>m(T,k)),k.children&&Object.assign(k,k.children.reduce((T,B)=>({height:Math.max(T.height,B.height+1),length:T.length+B.length}),k)),k};return m(h,null)}return Object.assign(s,{nodeSize(l){return arguments.length?(i.nodeSize=l,s):i.nodeSize},spacing(l){return arguments.length?(i.spacing=l,s):i.spacing},children(l){return arguments.length?(i.children=l,s):i.children},hierarchy(l,h){const u=typeof h>"u"?i.children:h;return c(o(),l,u)},dump(l){const h=a("nodeSize"),u=m=>g=>{const b=m+"  ",k=m+"    ",{x:A,y:T}=g,B=h(g),z=g.children||[],j=z.length===0?" ":`,${b}children: [${k}${z.map(u(k)).join(k)}${b}],${m}`;return`{ size: [${B.join(", ")}],${b}x: ${A}, y: ${T}${j}},`};return u(`
`)(l)}}),s}no.version=Zy;const nl=(e,i=0)=>(e.y=i,(e.children||[]).reduce((a,s)=>{const[o,r]=a;nl(s,e.y+e.ySize);const c=(o===0?s.lExt:s.rExt).bottom;o!==0&&Qy(e,o,r);const l=rv(c,o,r);return[o+1,l]},[0,null]),Jy(e),ov(e),e),il=(e,i,a)=>{typeof i>"u"&&(i=-e.relX-e.prelim,a=0);const s=i+e.relX;return e.relX=s+e.prelim-a,e.prelim=0,e.x=a+e.relX,(e.children||[]).forEach(o=>il(o,s,e.x)),e},Jy=e=>{(e.children||[]).reduce((i,a)=>{const[s,o]=i,r=s+a.shift,c=o+r+a.change;return a.relX+=c,[r,c]},[0,0])},Qy=(e,i,a)=>{const s=e.children[i-1],o=e.children[i];let r=s,c=s.relX,l=o,h=o.relX,u=!0;for(;r&&l;){r.bottom>a.lowY&&(a=a.next);const m=c+r.prelim-(h+l.prelim)+r.xSize/2+l.xSize/2+r.spacing(l);(m>0||m<0&&u)&&(h+=m,tv(o,m),ev(e,i,a.index,m)),u=!1;const g=r.bottom,b=l.bottom;g<=b&&(r=iv(r),r&&(c+=r.relX)),g>=b&&(l=nv(l),l&&(h+=l.relX))}!r&&l?av(e,i,l,h):r&&!l&&sv(e,i,r,c)},tv=(e,i)=>{e.relX+=i,e.lExtRelX+=i,e.rExtRelX+=i},ev=(e,i,a,s)=>{const o=e.children[i],r=i-a;if(r>1){const c=s/r;e.children[a+1].shift+=c,o.shift-=c,o.change-=s-c}},nv=e=>e.hasChildren?e.firstChild:e.lThr,iv=e=>e.hasChildren?e.lastChild:e.rThr,av=(e,i,a,s)=>{const o=e.firstChild,r=o.lExt,c=e.children[i];r.lThr=a;const l=s-a.relX-o.lExtRelX;r.relX+=l,r.prelim-=l,o.lExt=c.lExt,o.lExtRelX=c.lExtRelX},sv=(e,i,a,s)=>{const o=e.children[i],r=o.rExt,c=e.children[i-1];r.rThr=a;const l=s-a.relX-o.rExtRelX;r.relX+=l,r.prelim-=l,o.rExt=c.rExt,o.rExtRelX=c.rExtRelX},ov=e=>{if(e.hasChildren){const i=e.firstChild,a=e.lastChild,s=(i.prelim+i.relX-i.xSize/2+a.relX+a.prelim+a.xSize/2)/2;Object.assign(e,{prelim:s,lExt:i.lExt,lExtRelX:i.lExtRelX,rExt:a.rExt,rExtRelX:a.rExtRelX})}},rv=(e,i,a)=>{for(;a!==null&&e>=a.lowY;)a=a.next;return{lowY:e,index:i,next:a}},gt={selection:En,select:jt,max:Zf,min:Kf,sum:Jf,cumsum:Xf,tree:K0,stratify:G0,zoom:py,zoomIdentity:to,linkHorizontal:oy,flextree:no};let cv=class{constructor(){const e={id:`ID${Math.floor(Math.random()*1e6)}`,firstDraw:!0,ctx:document.createElement("canvas").getContext("2d"),initialExpandLevel:1,nodeDefaultBackground:"none",lastTransform:{x:0,y:0,k:1},allowedNodesCount:{},zoomBehavior:null,generateRoot:null,svgWidth:800,svgHeight:window.innerHeight-100,container:"body",data:null,connections:[],defaultFont:"Helvetica",nodeId:i=>i.nodeId||i.id,parentNodeId:i=>i.parentNodeId||i.parentId,rootMargin:40,nodeWidth:i=>250,nodeHeight:i=>150,neighbourMargin:(i,a)=>80,siblingsMargin:i=>20,childrenMargin:i=>60,compactMarginPair:i=>100,compactMarginBetween:i=>20,nodeButtonWidth:i=>40,nodeButtonHeight:i=>40,nodeButtonX:i=>-20,nodeButtonY:i=>-20,linkYOffset:30,pagingStep:i=>5,minPagingVisibleNodes:i=>2e3,scaleExtent:[.001,20],duration:400,imageName:"Chart",setActiveNodeCentered:!0,layout:"top",compact:!0,createZoom:i=>gt.zoom(),onZoomStart:i=>{},onZoom:i=>{},onZoomEnd:i=>{},onNodeClick:i=>i,onExpandOrCollapse:i=>i,nodeContent:i=>`<div style="padding:5px;font-size:10px;">Sample Node(id=${i.id}), override using <br/> 
            <code>chart.nodeContent({data}=>{ <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;return '' // Custom HTML <br/>
             })</code>
             <br/> 
             Or check different <a href="https://github.com/bumbeishvili/org-chart#jump-to-examples" target="_blank">layout examples</a>
             </div>`,buttonContent:({node:i,state:a})=>`<div style="border:1px solid #E4E2E9;border-radius:3px;padding:3px;font-size:9px;margin:auto auto;background-color:white"> ${{left:s=>s?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                          </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`,bottom:s=>s?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${i.data._directSubordinatesPaging} </span></div>
                       `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${i.data._directSubordinatesPaging} </span></div>
                    `,right:s=>s?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${i.data._directSubordinatesPaging} </span></div>`,top:s=>s?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${i.data._directSubordinatesPaging} </span></div>
                        `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${i.data._directSubordinatesPaging} </span></div>
                    `}[a.layout](i.children)}  </div>`,pagingButton:(i,a,s,o)=>{const r=o.pagingStep(i.parent),c=i.parent.data._pagingStep,l=i.parent.data._directSubordinatesPaging-c;return`
                   <div style="margin-top:90px;">
                      <div style="display:flex;width:170px;border-radius:20px;padding:5px 15px; padding-bottom:4px;;background-color:#E5E9F2">
                      <div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5.59 7.41L10.18 12L5.59 16.59L7 18L13 12L7 6L5.59 7.41ZM16 6H18V18H16V6Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg>
                      </div><div style="line-height:2"> Show next ${Math.min(l,r)}  nodes </div></div>
                   </div>
                `},nodeUpdate:function(i,a,s){gt.select(this).select(".node-rect").attr("stroke",o=>o.data._highlighted||o.data._upToTheRootHighlighted?"#E27396":"none").attr("stroke-width",i.data._highlighted||i.data._upToTheRootHighlighted?10:1)},nodeEnter:i=>i,nodeExit:i=>i,linkUpdate:function(i,a,s){gt.select(this).attr("stroke",o=>o.data._upToTheRootHighlighted?"#E27396":"#E4E2E9").attr("stroke-width",o=>o.data._upToTheRootHighlighted?5:1),i.data._upToTheRootHighlighted&&gt.select(this).raise()},hdiagonal:function(i,a,s){const o=i.x,r=i.y,c=a.x,l=a.y;let h=s&&s.x!=null?s.x:o,u=s&&s.y!=null?s.y:r,m=c-o<0?-1:1,g=l-r<0?-1:1,b=35,k=Math.abs(c-o)/2<b?Math.abs(c-o)/2:b;k=Math.abs(l-r)/2<k?Math.abs(l-r)/2:k;let A=Math.abs(c-o)/2-k;return`
                          M ${h} ${u}
                          L ${h} ${r}
                          L ${o} ${r}
                          L ${o+A*m} ${r}
                          C ${o+A*m+k*m} ${r} 
                            ${o+A*m+k*m} ${r} 
                            ${o+A*m+k*m} ${r+k*g}
                          L ${o+A*m+k*m} ${l-k*g} 
                          C ${o+A*m+k*m}  ${l} 
                            ${o+A*m+k*m}  ${l} 
                            ${c-A*m}  ${l}
                          L ${c} ${l}
               `},diagonal:function(i,a,s,o={sy:0}){const r=i.x;let c=i.y;const l=a.x,h=a.y;let u=s&&s.x!=null?s.x:r,m=s&&s.y!=null?s.y:c,g=l-r<0?-1:1,b=h-c<0?-1:1;c+=o.sy;let k=35,A=Math.abs(l-r)/2<k?Math.abs(l-r)/2:k;A=Math.abs(h-c)/2<A?Math.abs(h-c)/2:A;let T=Math.abs(h-c)/2-A,B=Math.abs(l-r)-A*2;return`
                          M ${u} ${m}
                          L ${r} ${m}
                          L ${r} ${c}
                          L ${r} ${c+T*b}
                          C  ${r} ${c+T*b+A*b} ${r} ${c+T*b+A*b} ${r+A*g} ${c+T*b+A*b}
                          L ${r+B*g+A*g} ${c+T*b+A*b}
                          C  ${l}  ${c+T*b+A*b} ${l}  ${c+T*b+A*b} ${l} ${h-T*b}
                          L ${l} ${h}
               `},defs:function(i,a){return`<defs>
                    ${a.map(s=>{const o=this.getTextWidth(s.label,{ctx:i.ctx,fontSize:2,defaultFont:i.defaultFont});return`
                       <marker id="${s.from+"_"+s.to}" refX="${s._source.x<s._target.x?-7:7}" refY="5" markerWidth="500"  markerHeight="500"  orient="${s._source.x<s._target.x?"auto":"auto-start-reverse"}" >
                       <rect rx=0.5 width=${s.label?o+3:0} height=3 y=1  fill="#E27396"></rect>
                       <text font-size="2px" x=1 fill="white" y=3>${s.label||""}</text>
                       </marker>

                       <marker id="arrow-${s.from+"_"+s.to}"  markerWidth="500"  markerHeight="500"  refY="2"  refX="1" orient="${s._source.x<s._target.x?"auto":"auto-start-reverse"}" >
                       <path transform="translate(0)" d='M0,0 V4 L2,2 Z' fill='#E27396' />
                       </marker>
                    `}).join("")}
                    </defs>
                    `},connectionsUpdate:function(i,a,s){gt.select(this).attr("stroke",o=>"#E27396").attr("stroke-linecap","round").attr("stroke-width",o=>"5").attr("pointer-events","none").attr("marker-start",o=>`url(#${o.from+"_"+o.to})`).attr("marker-end",o=>`url(#arrow-${o.from+"_"+o.to})`)},linkGroupArc:gt.linkHorizontal().x(i=>i.x).y(i=>i.y),layoutBindings:{left:{nodeLeftX:i=>0,nodeRightX:i=>i.width,nodeTopY:i=>-i.height/2,nodeBottomY:i=>i.height/2,nodeJoinX:i=>i.x+i.width,nodeJoinY:i=>i.y-i.height/2,linkJoinX:i=>i.x+i.width,linkJoinY:i=>i.y,linkX:i=>i.x,linkY:i=>i.y,linkCompactXStart:i=>i.x+i.width/2,linkCompactYStart:i=>i.y+(i.compactEven?i.height/2:-i.height/2),compactLinkMidX:(i,a)=>i.firstCompactNode.x,compactLinkMidY:(i,a)=>i.firstCompactNode.y+i.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(i)/4,linkParentX:i=>i.parent.x+i.parent.width,linkParentY:i=>i.parent.y,buttonX:i=>i.width,buttonY:i=>i.height/2,centerTransform:({root:i,rootMargin:a,centerY:s,scale:o,centerX:r})=>`translate(${a},${s}) scale(${o})`,compactDimension:{sizeColumn:i=>i.height,sizeRow:i=>i.width,reverse:i=>i.slice().reverse()},nodeFlexSize:({height:i,width:a,siblingsMargin:s,childrenMargin:o,state:r,node:c})=>r.compact&&c.flexCompactDim?[c.flexCompactDim[0],c.flexCompactDim[1]]:[i+s,a+o],zoomTransform:({centerY:i,scale:a})=>`translate(0,${i}) scale(${a})`,diagonal:this.hdiagonal.bind(this),swap:i=>{const a=i.x;i.x=i.y,i.y=a},nodeUpdateTransform:({x:i,y:a,width:s,height:o})=>`translate(${i},${a-o/2})`},top:{nodeLeftX:i=>-i.width/2,nodeRightX:i=>i.width/2,nodeTopY:i=>0,nodeBottomY:i=>i.height,nodeJoinX:i=>i.x-i.width/2,nodeJoinY:i=>i.y+i.height,linkJoinX:i=>i.x,linkJoinY:i=>i.y+i.height,linkCompactXStart:i=>i.x+(i.compactEven?i.width/2:-i.width/2),linkCompactYStart:i=>i.y+i.height/2,compactLinkMidX:(i,a)=>i.firstCompactNode.x+i.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(i)/4,compactLinkMidY:i=>i.firstCompactNode.y,compactDimension:{sizeColumn:i=>i.width,sizeRow:i=>i.height,reverse:i=>i},linkX:i=>i.x,linkY:i=>i.y,linkParentX:i=>i.parent.x,linkParentY:i=>i.parent.y+i.parent.height,buttonX:i=>i.width/2,buttonY:i=>i.height,centerTransform:({root:i,rootMargin:a,centerY:s,scale:o,centerX:r})=>`translate(${r},${a}) scale(${o})`,nodeFlexSize:({height:i,width:a,siblingsMargin:s,childrenMargin:o,state:r,node:c,compactViewIndex:l})=>r.compact&&c.flexCompactDim?[c.flexCompactDim[0],c.flexCompactDim[1]]:[a+s,i+o],zoomTransform:({centerX:i,scale:a})=>`translate(${i},0}) scale(${a})`,diagonal:this.diagonal.bind(this),swap:i=>{},nodeUpdateTransform:({x:i,y:a,width:s,height:o})=>`translate(${i-s/2},${a})`},bottom:{nodeLeftX:i=>-i.width/2,nodeRightX:i=>i.width/2,nodeTopY:i=>-i.height,nodeBottomY:i=>0,nodeJoinX:i=>i.x-i.width/2,nodeJoinY:i=>i.y-i.height-i.height,linkJoinX:i=>i.x,linkJoinY:i=>i.y-i.height,linkCompactXStart:i=>i.x+(i.compactEven?i.width/2:-i.width/2),linkCompactYStart:i=>i.y-i.height/2,compactLinkMidX:(i,a)=>i.firstCompactNode.x+i.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(i)/4,compactLinkMidY:i=>i.firstCompactNode.y,linkX:i=>i.x,linkY:i=>i.y,compactDimension:{sizeColumn:i=>i.width,sizeRow:i=>i.height,reverse:i=>i},linkParentX:i=>i.parent.x,linkParentY:i=>i.parent.y-i.parent.height,buttonX:i=>i.width/2,buttonY:i=>0,centerTransform:({root:i,rootMargin:a,centerY:s,scale:o,centerX:r,chartHeight:c})=>`translate(${r},${c-a}) scale(${o})`,nodeFlexSize:({height:i,width:a,siblingsMargin:s,childrenMargin:o,state:r,node:c})=>r.compact&&c.flexCompactDim?[c.flexCompactDim[0],c.flexCompactDim[1]]:[a+s,i+o],zoomTransform:({centerX:i,scale:a})=>`translate(${i},0}) scale(${a})`,diagonal:this.diagonal.bind(this),swap:i=>{i.y=-i.y},nodeUpdateTransform:({x:i,y:a,width:s,height:o})=>`translate(${i-s/2},${a-o})`},right:{nodeLeftX:i=>-i.width,nodeRightX:i=>0,nodeTopY:i=>-i.height/2,nodeBottomY:i=>i.height/2,nodeJoinX:i=>i.x-i.width-i.width,nodeJoinY:i=>i.y-i.height/2,linkJoinX:i=>i.x-i.width,linkJoinY:i=>i.y,linkX:i=>i.x,linkY:i=>i.y,linkParentX:i=>i.parent.x-i.parent.width,linkParentY:i=>i.parent.y,buttonX:i=>0,buttonY:i=>i.height/2,linkCompactXStart:i=>i.x-i.width/2,linkCompactYStart:i=>i.y+(i.compactEven?i.height/2:-i.height/2),compactLinkMidX:(i,a)=>i.firstCompactNode.x,compactLinkMidY:(i,a)=>i.firstCompactNode.y+i.firstCompactNode.flexCompactDim[0]/4+a.compactMarginPair(i)/4,centerTransform:({root:i,rootMargin:a,centerY:s,scale:o,centerX:r,chartWidth:c})=>`translate(${c-a},${s}) scale(${o})`,nodeFlexSize:({height:i,width:a,siblingsMargin:s,childrenMargin:o,state:r,node:c})=>r.compact&&c.flexCompactDim?[c.flexCompactDim[0],c.flexCompactDim[1]]:[i+s,a+o],compactDimension:{sizeColumn:i=>i.height,sizeRow:i=>i.width,reverse:i=>i.slice().reverse()},zoomTransform:({centerY:i,scale:a})=>`translate(0,${i}) scale(${a})`,diagonal:this.hdiagonal.bind(this),swap:i=>{const a=i.x;i.x=-i.y,i.y=a},nodeUpdateTransform:({x:i,y:a,width:s,height:o})=>`translate(${i-s},${a-o/2})`}}};this.getChartState=()=>e,Object.keys(e).forEach(i=>{this[i]=function(a){if(arguments.length)e[i]=a;else return e[i];return this}}),this.initializeEnterExitUpdatePattern()}initializeEnterExitUpdatePattern(){gt.selection.prototype.patternify=function(e){var i=this,a=e.selector,s=e.tag,o=e.data||[a],r=i.selectAll("."+a).data(o,(c,l)=>typeof c=="object"&&c.id?c.id:l);return r.exit().remove(),r=r.enter().append(s).merge(r),r.attr("class",a),r}}getNodeChildren({data:e,children:i,_children:a},s){return s.push(e),i&&i.forEach(o=>{this.getNodeChildren(o,s)}),a&&a.forEach(o=>{this.getNodeChildren(o,s)}),s}initialZoom(e){const i=this.getChartState();return i.lastTransform.k=e,this}render(){const e=this.getChartState();if(!e.data||e.data.length==0)return console.log("ORG CHART - Data is empty"),e.container&&(jt(e.container).select(".nodes-wrapper").remove(),jt(e.container).select(".links-wrapper").remove(),jt(e.container).select(".connections-wrapper").remove()),this;const i=gt.select(e.container),a=i.node().getBoundingClientRect();a.width>0&&(e.svgWidth=a.width);const s={id:`ID${Math.floor(Math.random()*1e6)}`,chartWidth:e.svgWidth,chartHeight:e.svgHeight};if(e.calc=s,s.centerX=s.chartWidth/2,s.centerY=s.chartHeight/2,e.firstDraw){const c={zoom:null};c.zoom=e.createZoom().clickDistance(10).on("start",(l,h)=>e.onZoomStart(l)).on("end",(l,h)=>e.onZoomEnd(l)).on("zoom",(l,h)=>{e.onZoom(l),this.zoomed(l,h)}).scaleExtent(e.scaleExtent),e.zoomBehavior=c.zoom}e.flexTreeLayout=no({nodeSize:c=>{const l=e.nodeWidth(c),h=e.nodeHeight(c),u=e.siblingsMargin(c),m=e.childrenMargin(c);return e.layoutBindings[e.layout].nodeFlexSize({state:e,node:c,width:l,height:h,siblingsMargin:u,childrenMargin:m})}}).spacing((c,l)=>c.parent==l.parent?0:e.neighbourMargin(c,l)),this.setLayouts({expandNodesFirst:!1});const o=i.patternify({tag:"svg",selector:"svg-chart-container"}).attr("width",e.svgWidth).attr("height",e.svgHeight).attr("font-family",e.defaultFont);e.firstDraw&&o.call(e.zoomBehavior).on("dblclick.zoom",null).attr("cursor","move"),e.svg=o;const r=o.patternify({tag:"g",selector:"chart"});return e.centerG=r.patternify({tag:"g",selector:"center-group"}),e.linksWrapper=e.centerG.patternify({tag:"g",selector:"links-wrapper"}),e.nodesWrapper=e.centerG.patternify({tag:"g",selector:"nodes-wrapper"}),e.connectionsWrapper=e.centerG.patternify({tag:"g",selector:"connections-wrapper"}),e.defsWrapper=o.patternify({tag:"g",selector:"defs-wrapper"}),e.firstDraw&&e.centerG.attr("transform",()=>e.layoutBindings[e.layout].centerTransform({centerX:s.centerX,centerY:s.centerY,scale:e.lastTransform.k,rootMargin:e.rootMargin,root:e.root,chartHeight:s.chartHeight,chartWidth:s.chartWidth})),e.chart=r,this.update(e.root),gt.select(window).on(`resize.${e.id}`,()=>{const c=gt.select(e.container).node().getBoundingClientRect();e.svg.attr("width",c.width)}),e.firstDraw&&(e.firstDraw=!1),this}addNode(e){const i=this.getChartState();if(e&&(i.parentNodeId(e)==null||i.parentNodeId(e)==i.nodeId(e))&&i.data.length==0)return i.data.push(e),this.render(),this;const a=i.generateRoot(i.data).descendants(),s=a.filter(({data:o})=>i.nodeId(o).toString()===i.nodeId(e).toString())[0];return a.filter(({data:o})=>i.nodeId(o).toString()===i.parentNodeId(e).toString())[0],s?(console.log(`ORG CHART - ADD - Node with id "${i.nodeId(e)}" already exists in tree`),this):(e._centered&&!e._expanded&&(e._expanded=!0),i.data.push(e),this.updateNodesState(),this)}removeNode(e){const i=this.getChartState(),a=i.generateRoot(i.data).descendants().filter(({data:s})=>i.nodeId(s)==e)[0];return a?(a.descendants().forEach(s=>s.data._filteredOut=!0),i.data=i.data.filter(s=>!s._filteredOut),i.data.length==0?this.render():this.updateNodesState.bind(this)(),this):(console.log(`ORG CHART - REMOVE - Node with id "${e}" not found in the tree`),this)}groupBy(e,i,a){const s={};return e.forEach(o=>{const r=i(o);s[r]||(s[r]=[]),s[r].push(o)}),Object.keys(s).forEach(o=>{s[o]=a(s[o])}),Object.entries(s)}calculateCompactFlexDimensions(e){const i=this.getChartState();e.eachBefore(a=>{a.firstCompact=null,a.compactEven=null,a.flexCompactDim=null,a.firstCompactNode=null}),e.eachBefore(a=>{if(a.children&&a.children.length>1){const s=a.children.filter(u=>!u.children);if(s.length<2)return;s.forEach((u,m)=>{m||(u.firstCompact=!0),m%2?u.compactEven=!1:u.compactEven=!0,u.row=Math.floor(m/2)});const o=gt.max(s.filter(u=>u.compactEven),i.layoutBindings[i.layout].compactDimension.sizeColumn),r=gt.max(s.filter(u=>!u.compactEven),i.layoutBindings[i.layout].compactDimension.sizeColumn),c=Math.max(o,r)*2,l=this.groupBy(s,u=>u.row,u=>gt.max(u,m=>i.layoutBindings[i.layout].compactDimension.sizeRow(m)+i.compactMarginBetween(m))),h=gt.sum(l.map(u=>u[1]));s.forEach(u=>{u.firstCompactNode=s[0],u.firstCompact?u.flexCompactDim=[c+i.compactMarginPair(u),h-i.compactMarginBetween(u)]:u.flexCompactDim=[0,0]}),a.flexCompactDim=null}})}calculateCompactFlexPositions(e){const i=this.getChartState();e.eachBefore(a=>{if(a.children){const s=a.children.filter(u=>u.flexCompactDim),o=s[0];if(!o)return;s.forEach((u,m,g)=>{m==0&&(o.x-=o.flexCompactDim[0]/2),m&m%2-1?u.x=o.x+o.flexCompactDim[0]*.25-i.compactMarginPair(u)/4:m&&(u.x=o.x+o.flexCompactDim[0]*.75+i.compactMarginPair(u)/4)});const r=o.x+o.flexCompactDim[0]*.5;o.x=o.x+o.flexCompactDim[0]*.25-i.compactMarginPair(o)/4;const c=a.x-r;Math.abs(c)<10&&s.forEach(u=>u.x+=c);const l=this.groupBy(s,u=>u.row,u=>gt.max(u,m=>i.layoutBindings[i.layout].compactDimension.sizeRow(m))),h=gt.cumsum(l.map(u=>u[1]+i.compactMarginBetween(u)));s.forEach((u,m)=>{u.row?u.y=o.y+h[u.row-1]:u.y=o.y})}})}update({x0:e,y0:i,x:a=0,y:s=0,width:o,height:r}){const c=this.getChartState();c.calc,c.compact&&this.calculateCompactFlexDimensions(c.root);const l=c.flexTreeLayout(c.root);c.compact&&this.calculateCompactFlexPositions(c.root);const h=l.descendants(),u=l.descendants().slice(1);h.forEach(c.layoutBindings[c.layout].swap);const m=c.connections,g={};c.allNodes.forEach(S=>g[c.nodeId(S.data)]=S);const b={};h.forEach(S=>b[c.nodeId(S.data)]=S),m.forEach(S=>{const x=g[S.from],w=g[S.to];S._source=x,S._target=w});const k=m.filter(S=>b[S.from]&&b[S.to]),A=c.defs.bind(this)(c,k),T=c.defsWrapper.html();A!==T&&c.defsWrapper.html(A);const B=c.linksWrapper.selectAll("path.link").data(u,S=>c.nodeId(S.data)),z=B.enter().insert("path","g").attr("class","link").attr("d",S=>{const x=c.layoutBindings[c.layout].linkJoinX({x:e,y:i,width:o,height:r}),w=c.layoutBindings[c.layout].linkJoinY({x:e,y:i,width:o,height:r}),y={x,y:w};return c.layoutBindings[c.layout].diagonal(y,y,y)}).merge(B);z.attr("fill","none"),this.isEdge()?z.style("display",S=>S.data._pagingButton?"none":"auto"):z.attr("display",S=>S.data._pagingButton?"none":"auto"),z.each(c.linkUpdate),z.transition().duration(c.duration).attr("d",S=>{const x=c.compact&&S.flexCompactDim?{x:c.layoutBindings[c.layout].compactLinkMidX(S,c),y:c.layoutBindings[c.layout].compactLinkMidY(S,c)}:{x:c.layoutBindings[c.layout].linkX(S),y:c.layoutBindings[c.layout].linkY(S)},w={x:c.layoutBindings[c.layout].linkParentX(S),y:c.layoutBindings[c.layout].linkParentY(S)},y=c.compact&&S.flexCompactDim?{x:c.layoutBindings[c.layout].linkCompactXStart(S),y:c.layoutBindings[c.layout].linkCompactYStart(S)}:x;return c.layoutBindings[c.layout].diagonal(x,w,y,{sy:c.linkYOffset})}),B.exit().transition().duration(c.duration).attr("d",S=>{const x=c.layoutBindings[c.layout].linkJoinX({x:a,y:s,width:o,height:r}),w=c.layoutBindings[c.layout].linkJoinY({x:a,y:s,width:o,height:r}),y={x,y:w};return c.layoutBindings[c.layout].diagonal(y,y,null,{sy:c.linkYOffset})}).remove();const j=c.connectionsWrapper.selectAll("path.connection").data(k),F=j.enter().insert("path","g").attr("class","connection").attr("d",S=>{const x=c.layoutBindings[c.layout].linkJoinX({x:e,y:i,width:o,height:r}),w=c.layoutBindings[c.layout].linkJoinY({x:e,y:i,width:o,height:r}),y={x,y:w};return c.layoutBindings[c.layout].diagonal(y,y,null,{sy:c.linkYOffset})}).merge(j);F.attr("fill","none"),F.transition().duration(c.duration).attr("d",S=>{const x=c.layoutBindings[c.layout].linkX({x:S._source.x,y:S._source.y,width:S._source.width,height:S._source.height}),w=c.layoutBindings[c.layout].linkY({x:S._source.x,y:S._source.y,width:S._source.width,height:S._source.height}),y=c.layoutBindings[c.layout].linkJoinX({x:S._target.x,y:S._target.y,width:S._target.width,height:S._target.height}),N=c.layoutBindings[c.layout].linkJoinY({x:S._target.x,y:S._target.y,width:S._target.width,height:S._target.height});return c.linkGroupArc({source:{x,y:w},target:{x:y,y:N}})}),F.each(c.connectionsUpdate),j.exit().transition().duration(c.duration).attr("opacity",0).remove();const X=c.nodesWrapper.selectAll("g.node").data(h,({data:S})=>c.nodeId(S)),st=X.enter().append("g").attr("class","node").attr("transform",S=>{if(S==c.root)return`translate(${e},${i})`;const x=c.layoutBindings[c.layout].nodeJoinX({x:e,y:i,width:o,height:r}),w=c.layoutBindings[c.layout].nodeJoinY({x:e,y:i,width:o,height:r});return`translate(${x},${w})`}).attr("cursor","pointer").on("click.node",(S,x)=>{const{data:w}=x;if(![...S.srcElement.classList].includes("node-button-foreign-object")){if([...S.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(x);return}if(!w._pagingButton){c.onNodeClick(x);return}console.log("event fired, no handlers")}}).on("keydown.node",(S,x)=>{if(S.key==="Enter"||S.key===" "||S.key==="Spacebar"){if([...S.srcElement.classList].includes("node-button-foreign-object"))return;if([...S.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(x);return}(S.key==="Enter"||S.key===" "||S.key==="Spacebar")&&this.onButtonClick(S,x)}});st.each(c.nodeEnter),st.patternify({tag:"rect",selector:"node-rect",data:S=>[S]});const ut=st.merge(X).style("font","12px sans-serif");ut.patternify({tag:"foreignObject",selector:"node-foreign-object",data:S=>[S]}).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-foreign-object-div",data:S=>[S]}),this.restyleForeignObjectElements();const it=st.patternify({tag:"g",selector:"node-button-g",data:S=>[S]}).on("click",(S,x)=>this.onButtonClick(S,x)).on("keydown",(S,x)=>{(S.key==="Enter"||S.key===" "||S.key==="Spacebar")&&this.onButtonClick(S,x)});it.patternify({tag:"rect",selector:"node-button-rect",data:S=>[S]}).attr("opacity",0).attr("pointer-events","all").attr("width",S=>c.nodeButtonWidth(S)).attr("height",S=>c.nodeButtonHeight(S)).attr("x",S=>c.nodeButtonX(S)).attr("y",S=>c.nodeButtonY(S)),it.patternify({tag:"foreignObject",selector:"node-button-foreign-object",data:S=>[S]}).attr("width",S=>c.nodeButtonWidth(S)).attr("height",S=>c.nodeButtonHeight(S)).attr("x",S=>c.nodeButtonX(S)).attr("y",S=>c.nodeButtonY(S)).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-button-div",data:S=>[S]}).style("pointer-events","none").style("display","flex").style("width","100%").style("height","100%"),ut.transition().attr("opacity",0).duration(c.duration).attr("transform",({x:S,y:x,width:w,height:y})=>c.layoutBindings[c.layout].nodeUpdateTransform({x:S,y:x,width:w,height:y})).attr("opacity",1),ut.select(".node-rect").attr("width",({width:S})=>S).attr("height",({height:S})=>S).attr("x",({width:S})=>0).attr("y",({height:S})=>0).attr("cursor","pointer").attr("rx",3).attr("fill",c.nodeDefaultBackground),ut.select(".node-button-g").attr("transform",({data:S,width:x,height:w})=>{const y=c.layoutBindings[c.layout].buttonX({width:x,height:w}),N=c.layoutBindings[c.layout].buttonY({width:x,height:w});return`translate(${y},${N})`}).attr("display",({data:S})=>S._directSubordinates>0?null:"none").attr("opacity",({data:S,children:x,_children:w})=>S._pagingButton?0:x||w?1:0),ut.select(".node-button-foreign-object .node-button-div").html(S=>c.buttonContent({node:S,state:c})),ut.select(".node-button-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",({children:S})=>S?40:26).text(({children:S})=>S?"-":"+").attr("y",this.isEdge()?10:0),ut.each(c.nodeUpdate);const yt=X.exit();yt.each(c.nodeExit);const vt=yt.data().reduce((S,x)=>S.depth<x.depth?S:x,{depth:1/0});yt.attr("opacity",1).transition().duration(c.duration).attr("transform",S=>{let{x,y:w,width:y,height:N}=vt.parent||{};const O=c.layoutBindings[c.layout].nodeJoinX({x,y:w,width:y,height:N}),Y=c.layoutBindings[c.layout].nodeJoinY({x,y:w,width:y,height:N});return`translate(${O},${Y})`}).on("end",function(){gt.select(this).remove()}).attr("opacity",0),h.forEach(S=>{S.x0=S.x,S.y0=S.y});const _t=c.allNodes.filter(S=>S.data._centered)[0];if(_t){let S=[_t];_t.data._centeredWithDescendants&&(c.compact?S=_t.descendants().filter((x,w)=>w<7):S=_t.descendants().filter((x,w,y)=>{const N=Math.round(y.length/2),O=2;return y.length%2?w>N-O&&w<N+O-1:w>N-O&&w<N+O})),_t.data._centeredWithDescendants=null,_t.data._centered=null,this.fit({animate:!0,scale:!1,nodes:S})}}isEdge(){return window.navigator.userAgent.includes("Edge")}hdiagonal(e,i,a,s){return this.getChartState().hdiagonal(e,i,a,s)}diagonal(e,i,a,s){return this.getChartState().diagonal(e,i,a,s)}restyleForeignObjectElements(){const e=this.getChartState();e.svg.selectAll(".node-foreign-object").attr("width",({width:i})=>i).attr("height",({height:i})=>i).attr("x",({width:i})=>0).attr("y",({height:i})=>0),e.svg.selectAll(".node-foreign-object-div").style("width",({width:i})=>`${i}px`).style("height",({height:i})=>`${i}px`).html(function(i,a,s){return i.data._pagingButton?`<div class="paging-button-wrapper"><div style="pointer-events:none">${e.pagingButton(i,a,s,e)}</div></div>`:e.nodeContent.bind(this)(i,a,s,e)})}onButtonClick(e,i){const a=this.getChartState();i.data._pagingButton||(a.setActiveNodeCentered&&(i.data._centered=!0,i.data._centeredWithDescendants=!0),i.children?(i._children=i.children,i.children=null,this.setExpansionFlagToChildren(i,!1)):(i.children=i._children,i._children=null,i.children&&i.children.forEach(({data:s})=>s._expanded=!0)),this.update(i),e.stopPropagation(),a.onExpandOrCollapse(i))}setExpansionFlagToChildren({data:e,children:i,_children:a},s){e._expanded=s,i&&i.forEach(o=>{this.setExpansionFlagToChildren(o,s)}),a&&a.forEach(o=>{this.setExpansionFlagToChildren(o,s)})}expandSomeNodes(e){if(e.data._expanded){let i=e.parent;for(;i&&i._children;)i.children=i._children,i._children=null,i=i.parent}e._children&&e._children.forEach(i=>this.expandSomeNodes(i)),e.children&&e.children.forEach(i=>this.expandSomeNodes(i))}updateNodesState(){const e=this.getChartState();this.setLayouts({expandNodesFirst:!0}),this.update(e.root)}setLayouts({expandNodesFirst:e=!0}){const i=this.getChartState();i.generateRoot=gt.stratify().id(o=>i.nodeId(o)).parentId(o=>i.parentNodeId(o)),i.root=i.generateRoot(i.data);const a=i.root.descendants();i.initialExpandLevel>1&&a.length>0&&(a.forEach(o=>{o.depth<=i.initialExpandLevel&&(o.data._expanded=!0)}),i.initialExpandLevel=1);const s={};i.root.descendants().filter(o=>o.children).filter(o=>!o.data._pagingStep).forEach(o=>{o.data._pagingStep=i.minPagingVisibleNodes(o)}),i.root.eachBefore((o,r)=>{o.data._directSubordinatesPaging=o.children?o.children.length:0,o.children&&o.children.forEach((c,l)=>{if(c.data._pagingButton=!1,l>o.data._pagingStep&&(s[c.id]=!0),l===o.data._pagingStep&&o.children.length-1>o.data._pagingStep&&(c.data._pagingButton=!0),s[c.parent.id]&&(s[c.id]=!0),c.data._expanded||c.data._centered||c.data._highlighted||c.data._upToTheRootHighlighted){let h=c;for(;h&&(s[h.id]||h.data._pagingButton);)s[h.id]=!1,h.data._pagingButton&&(h.data._pagingButton=!1,h.parent.children.forEach(u=>{u.data._expanded=!0,s[u.id]=!1})),h=h.parent}})}),i.root=gt.stratify().id(o=>i.nodeId(o)).parentId(o=>i.parentNodeId(o))(i.data.filter(o=>s[o.id]!==!0)),i.root.each((o,r,c)=>{let l=o._hierarchyHeight||o.height,h=i.nodeWidth(o),u=i.nodeHeight(o);Object.assign(o,{width:h,height:u,_hierarchyHeight:l})}),i.root.x0=0,i.root.y0=0,i.allNodes=i.root.descendants(),i.allNodes.forEach(o=>{Object.assign(o.data,{_directSubordinates:o.children?o.children.length:0,_totalSubordinates:o.descendants().length-1})}),i.root.children&&(e&&i.root.children.forEach(this.expand),i.root.children.forEach(o=>this.collapse(o)),i.initialExpandLevel==0&&(i.root._children=i.root.children,i.root.children=null),[i.root].forEach(o=>this.expandSomeNodes(o)))}collapse(e){e.children&&(e._children=e.children,e._children.forEach(i=>this.collapse(i)),e.children=null)}expand(e){e._children&&(e.children=e._children,e.children.forEach(i=>this.expand(i)),e._children=null)}zoomed(e,i){const a=this.getChartState(),s=a.chart,o=e.transform;a.lastTransform=o,s.attr("transform",o),this.isEdge()&&this.restyleForeignObjectElements()}zoomTreeBounds({x0:e,x1:i,y0:a,y1:s,params:o={animate:!0,scale:!0,onCompleted:()=>{}}}){const{centerG:r,svgWidth:c,svgHeight:l,svg:h,zoomBehavior:u,duration:m,lastTransform:g}=this.getChartState();let b=Math.min(8,.9/Math.max((i-e)/c,(s-a)/l)),k=gt.zoomIdentity.translate(c/2,l/2);k=k.scale(o.scale?b:g.k),k=k.translate(-(e+i)/2,-(a+s)/2),h.transition().duration(o.animate?m:0).call(u.transform,k),r.transition().duration(o.animate?m:0).attr("transform","translate(0,0)").on("end",function(){o.onCompleted&&o.onCompleted()})}fit({animate:e=!0,nodes:i,scale:a=!0,onCompleted:s=()=>{}}={}){const o=this.getChartState(),{root:r}=o;let c=i||r.descendants();const l=gt.min(c,g=>g.x+o.layoutBindings[o.layout].nodeLeftX(g)),h=gt.max(c,g=>g.x+o.layoutBindings[o.layout].nodeRightX(g)),u=gt.min(c,g=>g.y+o.layoutBindings[o.layout].nodeTopY(g)),m=gt.max(c,g=>g.y+o.layoutBindings[o.layout].nodeBottomY(g));return this.zoomTreeBounds({params:{animate:e,scale:a,onCompleted:s},x0:l-50,x1:h+50,y0:u-50,y1:m+50}),this}loadPagingNodes(e){const i=this.getChartState();e.data._pagingButton=!1;const a=e.parent.data._pagingStep,s=i.pagingStep(e.parent),o=a+s;e.parent.data._pagingStep=o,this.updateNodesState()}setExpanded(e,i=!0){const a=this.getChartState(),s=a.allNodes.filter(({data:o})=>a.nodeId(o)==e)[0];if(!s)return console.log(`ORG CHART - ${i?"EXPAND":"COLLAPSE"} - Node with id (${e})  not found in the tree`),this;if(s.data._expanded=i,i==!1){const o=s.parent||{descendants:()=>[]};o.descendants().filter(r=>r!=o).forEach(r=>r.data._expanded=!1)}return this}setCentered(e){const i=this.getChartState(),a=i.generateRoot(i.data).descendants().filter(({data:s})=>i.nodeId(s).toString()==e.toString())[0];return a?(a.ancestors().forEach(s=>s.data._expanded=!0),a.data._centered=!0,a.data._expanded=!0,this):(console.log(`ORG CHART - CENTER - Node with id (${e}) not found in the tree`),this)}setHighlighted(e){const i=this.getChartState(),a=i.generateRoot(i.data).descendants().filter(s=>i.nodeId(s.data).toString()===e.toString())[0];return a?(a.ancestors().forEach(s=>s.data._expanded=!0),a.data._highlighted=!0,a.data._expanded=!0,a.data._centered=!0,this):(console.log(`ORG CHART - HIGHLIGHT - Node with id (${e})  not found in the tree`),this)}setUpToTheRootHighlighted(e){const i=this.getChartState(),a=i.generateRoot(i.data).descendants().filter(s=>i.nodeId(s.data).toString()===e.toString())[0];return a?(a.ancestors().forEach(s=>s.data._expanded=!0),a.data._upToTheRootHighlighted=!0,a.data._expanded=!0,a.ancestors().forEach(s=>s.data._upToTheRootHighlighted=!0),this):(console.log(`ORG CHART - HIGHLIGHTROOT - Node with id (${e}) not found in the tree`),this)}clearHighlighting(){const e=this.getChartState();return e.allNodes.forEach(i=>{i.data._highlighted=!1,i.data._upToTheRootHighlighted=!1}),this.update(e.root),this}fullscreen(e){const i=this.getChartState(),a=gt.select(e||i.container).node();gt.select(document).on("fullscreenchange."+i.id,function(s){(document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement)==a?setTimeout(o=>{i.svg.attr("height",window.innerHeight-40)},500):i.svg.attr("height",i.svgHeight)}),a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()}zoomIn(){const{svg:e,zoomBehavior:i}=this.getChartState();e.transition().call(i.scaleBy,1.3)}zoomOut(){const{svg:e,zoomBehavior:i}=this.getChartState();e.transition().call(i.scaleBy,.78)}toDataURL(e,i){var a=new XMLHttpRequest;a.onload=function(){var s=new FileReader;s.onloadend=function(){i(s.result)},s.readAsDataURL(a.response)},a.open("GET",e),a.responseType="blob",a.send()}exportImg({full:e=!1,scale:i=3,onLoad:a=r=>r,save:s=!0,backgroundColor:o="#FAFAFA"}={}){const r=this,c=this.getChartState(),{svg:l,root:h}=c;let u=0;const m=l.selectAll("img");let g=m.size();const b=()=>{JSON.parse(JSON.stringify(r.lastTransform()));const k=r.duration();e&&r.fit();const{svg:A}=r.getChartState();setTimeout(T=>{r.downloadImage({node:A.node(),scale:i,isSvg:!1,backgroundColor:o,onAlreadySerialized:B=>{r.update(h)},imageName:c.imageName,onLoad:a,save:s})},e?k+10:0)};g>0?m.each(function(){r.toDataURL(this.src,k=>{this.src=k,++u==g&&b()})}):b()}exportSvg(){const{svg:e,imageName:i}=this.getChartState();return this.downloadImage({imageName:i,node:e.node(),scale:3,isSvg:!0}),this}expandAll(){const{allNodes:e,root:i,data:a}=this.getChartState();return a.forEach(s=>s._expanded=!0),this.render(),this}collapseAll(){const{allNodes:e,root:i}=this.getChartState();return e.forEach(a=>a.data._expanded=!1),this.initialExpandLevel(0),this.render(),this}downloadImage({node:e,scale:i=2,imageName:a="graph",isSvg:s=!1,save:o=!0,backgroundColor:r="#FAFAFA",onAlreadySerialized:c=h=>{},onLoad:l=h=>{}}){const h=e;function u(A,T){var B=document.createElement("a");typeof B.download=="string"?(document.body.appendChild(B),B.download=T,B.href=A,B.click(),document.body.removeChild(B)):location.replace(A)}function m(A){const T="http://www.w3.org/2000/xmlns/",B="http://www.w3.org/1999/xlink",z="http://www.w3.org/2000/svg";A=A.cloneNode(!0);const j=window.location.href+"#",F=document.createTreeWalker(A,NodeFilter.SHOW_ELEMENT,null,!1);for(;F.nextNode();)for(const X of F.currentNode.attributes)X.value.includes(j)&&(X.value=X.value.replace(j,"#"));return A.setAttributeNS(T,"xmlns",z),A.setAttributeNS(T,"xmlns:xlink",B),new XMLSerializer().serializeToString(A)}if(s){let A=m(h);A=`<?xml version="1.0" standalone="no"?>\r
`+A;var k="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(A);u(k,a+".svg"),c();return}const g=i,b=document.createElement("img");b.onload=function(){const A=document.createElement("canvas"),T=h.getBoundingClientRect();A.width=T.width*g,A.height=T.height*g;const B=A.getContext("2d");B.fillStyle=r,B.fillRect(0,0,T.width*g,T.height*g),B.drawImage(b,0,0,T.width*g,T.height*g);let z=A.toDataURL("image/png");l&&l(z),o&&u(z,a+".png")};var k="data:image/svg+xml; charset=utf8, "+encodeURIComponent(m(h));c(),b.src=k}getTextWidth(e,{fontSize:i=14,fontWeight:a=400,defaultFont:s="Helvetice",ctx:o}={}){return o.font=`${a||""} ${i}px ${s} `,o.measureText(e).width}clear(){const e=this.getChartState();gt.select(window).on(`resize.${e.id}`,null),e.svg&&e.svg.selectAll("*").remove()}};const lv={name:"OrgChart",components:{NcSelect:fn},props:{data:{type:Array,default:()=>[]}},data(){return{chartReference:null,chart:0}},computed:{charts(){return this.data.map((e,i)=>{const a=e.find(s=>s.parentNodeId===null);return{id:i,label:a.org?`${a.org} (${a.fullName})`:a.fullName}}).sort((e,i)=>e.label.localeCompare(i.label,Ld().replace("_","-"),{sensitivity:"base"}))},placeholder(){return t("contacts","Select chart …")}},watch:{data(){this.data[this.chart]?.length&&this.renderChart(this.data[this.chart])}},mounted(){this.data[this.chart]?.length&&this.renderChart(this.data[this.chart])},methods:{chartChanged(e){this.renderChart(this.data[e.id])},goToContact(e){this.$router.push({name:"contact",params:{selectedGroup:this.$route.params.selectedChart,selectedContact:e}})},renderChart(e){const i=this;this.chartReference||(this.chartReference=new cv),this.chartReference.container(this.$refs.svgElementContainer).data(e).nodeWidth(()=>250).initialZoom(1).nodeHeight(()=>200).childrenMargin(()=>70).compactMarginBetween(()=>15).compactMarginPair(()=>80).nodeContent(()=>"").nodeUpdate(function(a){const s=this.querySelector(".node-foreign-object-div");if(s)if(a.data.rendered)s.appendChild(a.data.rendered);else{const o=Yt.extend(vy),r=new o({propsData:{data:a.data,onAvatarClick:c=>i.goToContact(c)},router:Zi}).$mount();a.data.rendered=r.$el,s.appendChild(r.$el)}jt(this).select(".inner-box").attr("class",o=>o.data._highlighted||o.data._upToTheRootHighlighted?"inner-box inner-box-highlight":"inner-box")}).linkUpdate(function(a){jt(this).attr("stroke",()=>"var(--color-primary-element)").attr("stroke-width",s=>s.data._upToTheRootHighlighted?2:1),a.data._upToTheRootHighlighted&&jt(this).raise()}).onNodeClick(a=>{this.chartReference.data().filter(s=>s.nodeId===a)[0]._upToTheRootHighlighted?this.chartReference.clearHighlighting():(this.chartReference.clearHighlighting(),this.chartReference.setUpToTheRootHighlighted(a).render())}).render()}}};var uv=function(){var e=this,i=e._self._c;return i("div",{staticClass:"org-chart"},[e.data.length>1?i("div",{staticClass:"org-chart__menu"},[i("h3",[e._v(" "+e._s(e.t("contacts","Chart"))+": ")]),i("NcSelect",{staticClass:"chart-selection",attrs:{disabled:e.data.length===1,options:e.charts,"allow-empty":!1,searchable:!1,placeholder:e.placeholder,"input-id":"select-chart-input",label:"label"},on:{input:e.chartChanged},model:{value:e.chart,callback:function(a){e.chart=a},expression:"chart"}})],1):e._e(),i("div",{ref:"svgElementContainer",staticClass:"org-chart__container"})])},dv=[],hv=H(lv,uv,dv,!1,null,null);const pv=hv.exports,fv={name:"ChartContent",components:{AppContent:$s,OrgChart:pv},props:{contactsList:{type:Object,required:!0}},data(){return{data:[],searchQuery:""}},computed:{transformData(){const e={},i=Object.keys(this.contactsList).map(r=>{const[c,l]=ne.from(r,"base64").toString("utf-8").split("~");return e[l]||(e[l]={}),e[l][c]=this.contactsList[r]}),a=[],s=i.filter(r=>r.managersName).reduce((r,c)=>{r.push(za(c));const l=e[c.addressbook.id][c.managersName];return l&&!l.managersName&&!a.some(h=>h.nodeId===l.uid)&&(r.push(za(l)),a.push(za(l))),r},[]),o=a.map(r=>Td(s,r));return console.debug("Org charts",o.map((r,c)=>r.map(l=>`list ${c} ${l.nodeId} (${l.fullName}) -> ${l.parentNodeId}`))),o}}};var mv=function(){var e=this,i=e._self._c;return i("AppContent",[i("OrgChart",{attrs:{data:e.transformData}})],1)},gv=[],yv=H(fv,mv,gv,!1,null,null);const vv=yv.exports;function _v(e){e=structuredClone(e);const i=e.length,a=0;for(let s=-3;s<=3;s++)for(let o=-3;o<=3;o++)e[3+s][3+o]=a,e[3+s][i-4+o]=a,e[i-4+s][3+o]=a;for(let s=0;s<8;s++)e[7][s]=e[s][7]=e[7][i-s-1]=e[s][i-8]=e[i-8][s]=e[i-1-s][7]=a;return e}function bv(e,i,a){e=structuredClone(e);const s=e.length,o=Math.ceil((s*i/100+s%2)/2)*2-s%2,r=e[0]?.length??0,c=Math.ceil((r*a/100+r%2)/2)*2-r%2,l=Math.round((s-o)/2),h=Math.round((r-c)/2);for(let u=l;u<l+o;u+=1)for(let m=h;m<h+c;m+=1)e[u][m]=0;return e}const Cv=new TextEncoder,wv=new TextDecoder;function Cs(e,i){let a,s;if(typeof e=="string"||typeof e=="number")a=`${e}`,s=Cv.encode(a);else if(Array.isArray(e))s=new Uint8Array(e),a=wv.decode(e);else throw new Error("Bad data: "+typeof e);if(/^[0-9]+$/.test(a)){if(s.byteLength>7089)throw new Error("Too much data");return Sv(a)}if(/^[0-9A-Z \$%\*\+\.\/\:\-]+$/.test(a)){if(s.byteLength>4296)throw new Error("Too much data");return xv(a)}if(i&&/^https?:/i.test(a))return Mv(a);if(s.byteLength>2953)throw new Error("Too much data");return kv(new Uint8Array(s))}function oe(e,i,a){for(let s=1<<i-1;s;s>>>=1)e.push(s&a?1:0)}function kv(e){const i=e.byteLength,a=[];for(let r=0;r<i;r++)oe(a,8,e[r]);const s={};let o=[0,1,0,0];if(oe(o,16,i),s.data10=s.data27=o.concat(a),i<256){let r=[0,1,0,0];oe(r,8,i),s.data1=r.concat(a)}return s}const vr=function(e){const i={};for(let a=0;a<e.length;a++)i[e[a]]=a;return i}("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:");function xv(e){const i=e.length,a=[];for(let r=0;r<i;r+=2){let c=6,l=vr[e[r]];e[r+1]&&(c=11,l=l*45+vr[e[r+1]]),oe(a,c,l)}const s={};let o=[0,0,1,0];if(oe(o,13,i),s.data27=o.concat(a),i<2048){let r=[0,0,1,0];oe(r,11,i),s.data10=r.concat(a)}if(i<512){let r=[0,0,1,0];oe(r,9,i),s.data1=r.concat(a)}return s}function Sv(e){const i=e.length,a=[];for(let r=0;r<i;r+=3){const c=e.substr(r,3),l=Math.ceil(c.length*10/3);oe(a,l,parseInt(c,10))}const s={};let o=[0,0,0,1];if(oe(o,14,i),s.data27=o.concat(a),i<4096){let r=[0,0,0,1];oe(r,12,i),s.data10=r.concat(a)}if(i<1024){let r=[0,0,0,1];oe(r,10,i),s.data1=r.concat(a)}return s}function Mv(e){const i=e.indexOf("/",8)+1||e.length,a=Cs(e.slice(0,i).toUpperCase(),!1);if(i>=e.length)return a;const s=Cs(e.slice(i),!1);return a.data27=a.data27.concat(s.data27),a.data10&&s.data10&&(a.data10=a.data10.concat(s.data10)),a.data1&&s.data1&&(a.data1=a.data1.concat(s.data1)),a}function Av(e,i){e=[].slice.call(e);const a=ol(i);for(let s=0;s<i;s++)e.push(0);for(;e.length>i;){if(!e[0]){e.shift();continue}const s=sl(e[0]);for(let o=0;o<=i;o++)e[o]=e[o]^ws(a[o]+s);e.shift()}return new Uint8Array(e)}const Nv=285,aa=[1],al=[];for(let e=1;e<256;e++){let i=aa[e-1]<<1;i>255&&(i^=Nv),aa[e]=i}for(let e=0;e<255;e++)al[aa[e]]=e;function ws(e){for(;e<0;)e+=255;for(;e>255;)e-=255;return aa[e]}function sl(e){if(e<1||e>255)throw Error(`Bad log(${e})`);return al[e]}const ja=[[0],[0,0],[0,25,1]];function ol(e){if(ja[e])return ja[e];const i=ol(e-1),a=[];a[0]=i[0];for(let s=1;s<=e;s++)a[s]=sl(ws(i[s])^ws(i[s-1]+e-1));return ja[e]=a,a}function Ov(e){const i=(e<<2)+17;return Array(i).fill(null).map(()=>Array(i).fill(0))}function Dv(e){const i=e.length;for(let a=-3;a<=3;a++)for(let s=-3;s<=3;s++){const o=Math.max(a,s),r=Math.min(a,s),c=o==2&&r>=-2||r==-2&&o<=2?128:129;e[3+a][3+s]=c,e[3+a][i-4+s]=c,e[i-4+a][3+s]=c}for(let a=0;a<8;a++)e[7][a]=e[a][7]=e[7][i-a-1]=e[a][i-8]=e[i-8][a]=e[i-1-a][7]=128}function Lv(e){const i=e.length;if(i>21){const s=i-13;let o=Math.round(s/Math.ceil(s/28));o%2&&o++;const r=[];for(let c=s+6;c>10;c-=o)r.unshift(c);r.unshift(6);for(var a=0;a<r.length;a++)for(let c=0;c<r.length;c++){const l=r[a],h=r[c];if(!e[l][h])for(let u=-2;u<=2;u++)for(let m=-2;m<=2;m++){const g=Math.max(u,m),b=Math.min(u,m),k=g==1&&b>=-1||b==-1&&g<=1?128:129;e[l+u][h+m]=k}}}for(var a=8;a<i-8;a++)e[6][a]=e[a][6]=a%2?128:129}function Tv(e){const i=e.length;for(var a=0;a<8;a++)a!=6&&(e[8][a]=e[a][8]=128),e[8][i-1-a]=128,e[i-1-a][8]=128;if(e[8][8]=128,e[i-8][8]=129,!(i<45))for(var a=i-11;a<i-8;a++)for(let o=0;o<6;o++)e[a][o]=e[o][a]=128}const _r=function(){const e=Array(32),i=Array(40),a=1335,s=7973,o=21522;for(let c=0;c<32;c++){let l=c<<10;for(let h=5;h>0;h--)l>>>9+h&&(l^=a<<h-1);e[c]=(l|c<<10)^o}for(let c=7;c<=40;c++){let l=c<<12;for(let h=6;h>0;h--)l>>>11+h&&(l^=s<<h-1);i[c]=l|c<<12}const r={L:1,M:0,Q:3,H:2};return function(c,l,h){const u=c.length,m=e[r[l]<<3|h];function g(T){return m>>T&1?129:128}for(var b=0;b<8;b++)c[8][u-1-b]=g(b),b<6&&(c[b][8]=g(b));for(var b=8;b<15;b++)c[u-15+b][8]=g(b),b>8&&(c[8][14-b]=g(b));c[7][8]=g(6),c[8][8]=g(7),c[8][7]=g(8);const k=i[(u-17)/4];if(!k)return;function A(T){return k>>T&1?129:128}for(var b=0;b<6;b++)for(let B=0;B<3;B++)c[u-11+B][b]=c[b][u-11+B]=A(b*3+B)}}(),br=function(){const e=[(i,a)=>(i+a)%2==0,(i,a)=>i%2==0,(i,a)=>a%3==0,(i,a)=>(i+a)%3==0,(i,a)=>(Math.floor(i/2)+Math.floor(a/3))%2==0,(i,a)=>i*a%2+i*a%3==0,(i,a)=>(i*a%2+i*a%3)%2==0,(i,a)=>(i*a%3+(i+a)%2)%2==0];return function(i,a,s){const o=i.length;let r,c,l=-1;r=c=o-1;const h=e[s];let u=a.blocks[a.blocks.length-1].length;for(var m=0;m<u;m++)for(var g=0;g<a.blocks.length;g++)a.blocks[g].length<=m||b(a.blocks[g][m]);u=a.ec_len;for(var m=0;m<u;m++)for(var g=0;g<a.ec.length;g++)b(a.ec[g][m]);if(c>-1)do i[r][c]=h(r,c)?1:0;while(k());function b(A){for(let T=128;T;T>>=1){let B=!!(T&A);h(r,c)&&(B=!B),i[r][c]=B?1:0,k()}}function k(){do if(c%2^+(c<6)?l<0&&r==0||l>0&&r==o-1?(c--,l=-l):(c++,r+=l):c--,c==6&&c--,c<0)return!1;while(i[r][c]&240);return!0}}}();function Ev(e){const i=e.length;let a=0;for(var s=0;s<i;s++){for(var o=e[s][0]&1,r=1,c=1;c<i;c++){var l=e[s][c]&1;if(l==o){r++;continue}r>=5&&(a+=r-2),o=l,r=1}r>=5&&(a+=r-2)}for(var c=0;c<i;c++){for(var o=e[0][c]&1,r=1,s=1;s<i;s++){var l=e[s][c]&1;if(l==o){r++;continue}r>=5&&(a+=r-2),o=l,r=1}r>=5&&(a+=r-2)}for(var s=0;s<i-1;s++)for(var c=0;c<i-1;c++){const k=e[s][c]+e[s][c+1]+e[s+1][c]+e[s+1][c+1]&7;(k==0||k==4)&&(a+=3)}function h(g){return e[s][c+g]&1}function u(g){return e[s+g][c]&1}for(var s=0;s<i;s++)for(var c=0;c<i;c++)c<i-6&&h(0)&&!h(1)&&h(2)&&h(3)&&h(4)&&!h(5)&&h(6)&&(c>=4&&!(h(-4)||h(-3)||h(-2)||h(-1))&&(a+=40),c<i-10&&!(h(7)||h(8)||h(9)||h(10))&&(a+=40)),s<i-6&&u(0)&&!u(1)&&u(2)&&u(3)&&u(4)&&!u(5)&&u(6)&&(s>=4&&!(u(-4)||u(-3)||u(-2)||u(-1))&&(a+=40),s<i-10&&!(u(7)||u(8)||u(9)||u(10))&&(a+=40));let m=0;for(var s=0;s<i;s++)for(var c=0;c<i;c++)e[s][c]&1&&m++;return a+=10*Math.floor(Math.abs(10-20*m/(i*i))),a}function Iv(e){const i=Ov(e.version);Dv(i),Lv(i),Tv(i);let a=1/0,s=0;for(let o=0;o<8;o++){br(i,e,o),_r(i,e.ec_level,o);const r=Ev(i);r<a&&(a=r,s=o)}return br(i,e,s),_r(i,e.ec_level,s),i.map(o=>o.map(r=>r&1))}const rl=["L","M","Q","H"];function Pv(e,i){let a=1,s;for(e.data1?s=Math.ceil(e.data1.length/8):a=10;a<10;a++){let o=qa[a][i];if(o.data_len>=s)return Wa(o)}for(e.data10?s=Math.ceil(e.data10.length/8):a=27;a<27;a++){let o=qa[a][i];if(o.data_len>=s)return Wa(o)}for(s=Math.ceil(e.data27.length/8);a<41;a++){let o=qa[a][i];if(o.data_len>=s)return Wa(o)}throw new Error("Too much data")}function zv(e,i){const a=new Uint8ClampedArray(i.data_len);let s;i.version<10?s=e.data1:i.version<27?s=e.data10:s=e.data27;const o=s.length;for(let l=0;l<o;l+=8){let h=0;for(let u=0;u<8;u++)h=h<<1|(s[l+u]?1:0);a[l/8]=h}let r=236;for(let l=Math.ceil((o+4)/8);l<a.length;l++)a[l]=r,r=r==236?17:236;let c=0;return i.blocks=i.blocks.map(l=>{const h=a.slice(c,c+l);return c+=l,i.ec.push(Av(h,i.ec_len)),h}),i}function Bv(e,i,a){i=rl.includes(i)?i:"M";const s=Cs(e,a),o=zv(s,Pv(s,i));return Iv(o)}const Wa=typeof structuredClone<"u"?structuredClone:e=>JSON.parse(JSON.stringify(e)),$v=[[],[26,7,1,10,1,13,1,17,1],[44,10,1,16,1,22,1,28,1],[70,15,1,26,1,36,2,44,2],[100,20,1,36,2,52,2,64,4],[134,26,1,48,2,72,4,88,4],[172,36,2,64,4,96,4,112,4],[196,40,2,72,4,108,6,130,5],[242,48,2,88,4,132,6,156,6],[292,60,2,110,5,160,8,192,8],[346,72,4,130,5,192,8,224,8],[404,80,4,150,5,224,8,264,11],[466,96,4,176,8,260,10,308,11],[532,104,4,198,9,288,12,352,16],[581,120,4,216,9,320,16,384,16],[655,132,6,240,10,360,12,432,18],[733,144,6,280,10,408,17,480,16],[815,168,6,308,11,448,16,532,19],[901,180,6,338,13,504,18,588,21],[991,196,7,364,14,546,21,650,25],[1085,224,8,416,16,600,20,700,25],[1156,224,8,442,17,644,23,750,25],[1258,252,9,476,17,690,23,816,34],[1364,270,9,504,18,750,25,900,30],[1474,300,10,560,20,810,27,960,32],[1588,312,12,588,21,870,29,1050,35],[1706,336,12,644,23,952,34,1110,37],[1828,360,12,700,25,1020,34,1200,40],[1921,390,13,728,26,1050,35,1260,42],[2051,420,14,784,28,1140,38,1350,45],[2185,450,15,812,29,1200,40,1440,48],[2323,480,16,868,31,1290,43,1530,51],[2465,510,17,924,33,1350,45,1620,54],[2611,540,18,980,35,1440,48,1710,57],[2761,570,19,1036,37,1530,51,1800,60],[2876,570,19,1064,38,1590,53,1890,63],[3034,600,20,1120,40,1680,56,1980,66],[3196,630,21,1204,43,1770,59,2100,70],[3362,660,22,1260,45,1860,62,2220,74],[3532,720,24,1316,47,1950,65,2310,77],[3706,750,25,1372,49,2040,68,2430,81]],qa=$v.map((e,i)=>{if(!i)return Object.create(null);const a=Object.create(null);for(let s=1;s<8;s+=2){const o=e[0]-e[s],r=e[s+1],c=rl[s/2|0],l={version:i,ec_level:c,data_len:o,ec_len:e[s]/r,blocks:[],ec:[]};for(let h=r,u=o;h>0;h--){const m=u/h|0;l.blocks.push(m),u-=m}a[c]=l}return a});var cl={exports:{}},Rv={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},ll={exports:{}},Hv=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},Yv=Hv,Vv=Array.prototype.concat,Uv=Array.prototype.slice,Cr=ll.exports=function(e){for(var i=[],a=0,s=e.length;a<s;a++){var o=e[a];Yv(o)?i=Vv.call(i,Uv.call(o)):i.push(o)}return i};Cr.wrap=function(e){return function(){return e(Cr(arguments))}};var Gv=ll.exports,ei=Rv,qn=Gv,ul=Object.hasOwnProperty,dl=Object.create(null);for(var Xa in ei)ul.call(ei,Xa)&&(dl[ei[Xa]]=Xa);var Xt=cl.exports={to:{},get:{}};Xt.get=function(e){var i=e.substring(0,3).toLowerCase(),a,s;switch(i){case"hsl":a=Xt.get.hsl(e),s="hsl";break;case"hwb":a=Xt.get.hwb(e),s="hwb";break;default:a=Xt.get.rgb(e),s="rgb";break}return a?{model:s,value:a}:null},Xt.get.rgb=function(e){if(!e)return null;var i=/^#([a-f0-9]{3,4})$/i,a=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,s=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,o=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,r=/^(\w+)$/,c=[0,0,0,1],l,h,u;if(l=e.match(a)){for(u=l[2],l=l[1],h=0;h<3;h++){var m=h*2;c[h]=parseInt(l.slice(m,m+2),16)}u&&(c[3]=parseInt(u,16)/255)}else if(l=e.match(i)){for(l=l[1],u=l[3],h=0;h<3;h++)c[h]=parseInt(l[h]+l[h],16);u&&(c[3]=parseInt(u+u,16)/255)}else if(l=e.match(s)){for(h=0;h<3;h++)c[h]=parseInt(l[h+1],0);l[4]&&(l[5]?c[3]=parseFloat(l[4])*.01:c[3]=parseFloat(l[4]))}else if(l=e.match(o)){for(h=0;h<3;h++)c[h]=Math.round(parseFloat(l[h+1])*2.55);l[4]&&(l[5]?c[3]=parseFloat(l[4])*.01:c[3]=parseFloat(l[4]))}else return(l=e.match(r))?l[1]==="transparent"?[0,0,0,0]:ul.call(ei,l[1])?(c=ei[l[1]],c[3]=1,c):null:null;for(h=0;h<3;h++)c[h]=Ue(c[h],0,255);return c[3]=Ue(c[3],0,1),c},Xt.get.hsl=function(e){if(!e)return null;var i=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,a=e.match(i);if(a){var s=parseFloat(a[4]),o=(parseFloat(a[1])%360+360)%360,r=Ue(parseFloat(a[2]),0,100),c=Ue(parseFloat(a[3]),0,100),l=Ue(isNaN(s)?1:s,0,1);return[o,r,c,l]}return null},Xt.get.hwb=function(e){if(!e)return null;var i=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,a=e.match(i);if(a){var s=parseFloat(a[4]),o=(parseFloat(a[1])%360+360)%360,r=Ue(parseFloat(a[2]),0,100),c=Ue(parseFloat(a[3]),0,100),l=Ue(isNaN(s)?1:s,0,1);return[o,r,c,l]}return null},Xt.to.hex=function(){var e=qn(arguments);return"#"+Ni(e[0])+Ni(e[1])+Ni(e[2])+(e[3]<1?Ni(Math.round(e[3]*255)):"")},Xt.to.rgb=function(){var e=qn(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},Xt.to.rgb.percent=function(){var e=qn(arguments),i=Math.round(e[0]/255*100),a=Math.round(e[1]/255*100),s=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+i+"%, "+a+"%, "+s+"%)":"rgba("+i+"%, "+a+"%, "+s+"%, "+e[3]+")"},Xt.to.hsl=function(){var e=qn(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},Xt.to.hwb=function(){var e=qn(arguments),i="";return e.length>=4&&e[3]!==1&&(i=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+i+")"},Xt.to.keyword=function(e){return dl[e.slice(0,3)]};function Ue(e,i,a){return Math.min(Math.max(i,e),a)}function Ni(e){var i=Math.round(e).toString(16).toUpperCase();return i.length<2?"0"+i:i}var Fv=cl.exports;const wr=ma(Fv);function jv(e){return{...(e?.type??"png")==="png"?Xv:Zv,...e}}function Za(e){return typeof e=="string"?wr.to.hex(wr.get.rgb(e)):`#${(e>>>8).toString(16).padStart(6,"0")}`}const hl=(e,i)=>["M",e,i],pl=()=>["z"],Fe=(e,i,a,s=0)=>e>0?["a",e,e,0,0,s,i,a]:[],sa=e=>["v",e],oa=e=>["h",e];function Wv(e,i=0,a=0,s=0){const o=e.length*i+a*2;let r=7;const c=[[0,0],[1,0],[0,1]],l=[];for(const h of c){const[u,m]=h.map(g=>g==0?1:-1);for(const g of[0,1,2]){let b=o*h[0]+u*(a+i*g),k=o*h[1]+m*(a+i*g);const A=u*(i*(r-2*g)-2*s),T=m*(i*(r-2*g)-2*s);let B=[hl(b,k+s*m),sa(T),Fe(s,s*u,s*m,h[1]|h[0]),oa(A),Fe(s,s*u,-s*m,h[1]|h[0]),sa(-T),Fe(s,-s*u,-s*m,h[1]|h[0]),oa(-A),Fe(s,-s*u,s*m,h[1]|h[0]),pl()];l.push(...B.flat())}}return l.join(" ")}function qv(e,i,a=0,s=0){let o=[];for(let r=0;r<e.length;r++){const c=e[r];for(let l=0;l<c.length;l++)if(c[l]){const h=r*i+a,u=l*i+a,m=i-2*s,g=[hl(h,u+s),sa(m),Fe(s,s,s),oa(m),Fe(s,s,-s),sa(-m),Fe(s,-s,-s),oa(-m),Fe(s,-s,s),pl()];o.push(...g.flat())}}return o.join(" ")}const fl={type:"png",parse_url:!1,ec_level:"M",logo:void 0,logoWidth:20,logoHeight:20,bgColor:4294967295,color:255},Xv={...fl,margin:1,size:5},Zv={...fl,margin:1,size:0},ml="3.7.7",Kv=ml,$n=typeof ne=="function",kr=typeof TextDecoder=="function"?new TextDecoder:void 0,xr=typeof TextEncoder=="function"?new TextEncoder:void 0,Jv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Qn=Array.prototype.slice.call(Jv),Oi=(e=>{let i={};return e.forEach((a,s)=>i[a]=s),i})(Qn),Qv=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,zt=String.fromCharCode.bind(String),Sr=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),gl=e=>e.replace(/=/g,"").replace(/[+\/]/g,i=>i=="+"?"-":"_"),yl=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),vl=e=>{let i,a,s,o,r="";const c=e.length%3;for(let l=0;l<e.length;){if((a=e.charCodeAt(l++))>255||(s=e.charCodeAt(l++))>255||(o=e.charCodeAt(l++))>255)throw new TypeError("invalid character found");i=a<<16|s<<8|o,r+=Qn[i>>18&63]+Qn[i>>12&63]+Qn[i>>6&63]+Qn[i&63]}return c?r.slice(0,c-3)+"===".substring(c):r},io=typeof btoa=="function"?e=>btoa(e):$n?e=>ne.from(e,"binary").toString("base64"):vl,ks=$n?e=>ne.from(e).toString("base64"):e=>{let i=[];for(let a=0,s=e.length;a<s;a+=4096)i.push(zt.apply(null,e.subarray(a,a+4096)));return io(i.join(""))},Gi=(e,i=!1)=>i?gl(ks(e)):ks(e),t2=e=>{if(e.length<2){var i=e.charCodeAt(0);return i<128?e:i<2048?zt(192|i>>>6)+zt(128|i&63):zt(224|i>>>12&15)+zt(128|i>>>6&63)+zt(128|i&63)}else{var i=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return zt(240|i>>>18&7)+zt(128|i>>>12&63)+zt(128|i>>>6&63)+zt(128|i&63)}},e2=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,_l=e=>e.replace(e2,t2),Mr=$n?e=>ne.from(e,"utf8").toString("base64"):xr?e=>ks(xr.encode(e)):e=>io(_l(e)),Nn=(e,i=!1)=>i?gl(Mr(e)):Mr(e),Ar=e=>Nn(e,!0),n2=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,i2=e=>{switch(e.length){case 4:var i=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),a=i-65536;return zt((a>>>10)+55296)+zt((a&1023)+56320);case 3:return zt((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return zt((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},bl=e=>e.replace(n2,i2),Cl=e=>{if(e=e.replace(/\s+/g,""),!Qv.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let i,a="",s,o;for(let r=0;r<e.length;)i=Oi[e.charAt(r++)]<<18|Oi[e.charAt(r++)]<<12|(s=Oi[e.charAt(r++)])<<6|(o=Oi[e.charAt(r++)]),a+=s===64?zt(i>>16&255):o===64?zt(i>>16&255,i>>8&255):zt(i>>16&255,i>>8&255,i&255);return a},ao=typeof atob=="function"?e=>atob(yl(e)):$n?e=>ne.from(e,"base64").toString("binary"):Cl,wl=$n?e=>Sr(ne.from(e,"base64")):e=>Sr(ao(e).split("").map(i=>i.charCodeAt(0))),kl=e=>wl(xl(e)),a2=$n?e=>ne.from(e,"base64").toString("utf8"):kr?e=>kr.decode(wl(e)):e=>bl(ao(e)),xl=e=>yl(e.replace(/[-_]/g,i=>i=="-"?"+":"/")),xs=e=>a2(xl(e)),s2=e=>{if(typeof e!="string")return!1;const i=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(i)||!/[^\s0-9a-zA-Z\-_]/.test(i)},Sl=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),Ml=function(){const e=(i,a)=>Object.defineProperty(String.prototype,i,Sl(a));e("fromBase64",function(){return xs(this)}),e("toBase64",function(i){return Nn(this,i)}),e("toBase64URI",function(){return Nn(this,!0)}),e("toBase64URL",function(){return Nn(this,!0)}),e("toUint8Array",function(){return kl(this)})},Al=function(){const e=(i,a)=>Object.defineProperty(Uint8Array.prototype,i,Sl(a));e("toBase64",function(i){return Gi(this,i)}),e("toBase64URI",function(){return Gi(this,!0)}),e("toBase64URL",function(){return Gi(this,!0)})},o2=()=>{Ml(),Al()},r2={version:ml,VERSION:Kv,atob:ao,atobPolyfill:Cl,btoa:io,btoaPolyfill:vl,fromBase64:xs,toBase64:Nn,encode:Nn,encodeURI:Ar,encodeURL:Ar,utob:_l,btou:bl,decode:xs,isValid:s2,fromUint8Array:Gi,toUint8Array:kl,extendString:Ml,extendUint8Array:Al,extendBuiltins:o2};function c2(e,i={}){const a=jv({...i,type:"svg"});let s=Bv(e,a.ec_level,a.parse_url);return s=_v(s),a.logo&&a.logoWidth&&a.logoHeight&&!a.noExcavate&&(s=bv(s,a.logoWidth,a.logoHeight)),u2({matrix:s,...a})}const l2=new TextEncoder;function u2({matrix:e,margin:i,size:a,logo:s,logoWidth:o,logoHeight:r,color:c,bgColor:l,imageWidth:h,imageHeight:u,borderRadius:m}){const g=a||9,b=e.length*g,k=i*g,A=b+2*k,T=h?` width="${h}"`:"",B=u?` height="${h}"`:"",z='<?xml version="1.0" encoding="utf-8"?>',j=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink"${T}${B} viewBox="0 0 ${A} ${A}">`,F=d2(e,{color:c,bgColor:l,size:A,margin:i,blockSize:g,borderRadius:m}),X="</svg>",st=s?h2(s,k,b,o,r):"";return l2.encode(z+j+F+st+X)}function d2(e,i){const a=qv(e,i.blockSize,i.margin*i.blockSize,i.borderRadius),s=Wv(e,i.blockSize,i.margin*i.blockSize,i.borderRadius);let o=`<rect width="${i.size}" height="${i.size}" fill="${Za(i.bgColor)}"></rect>`;return o+=`<path shape-rendering="geometricPrecision" d="${s}" fill-rule="evenodd" fill="${Za(i.color)}"/>`,o+=`<path shape-rendering="geometricPrecision" d="${a}" fill="${Za(i.color)}"/>`,o}function h2(e,i,a,s,o){const r=`data:image/png;base64,${r2.fromUint8Array(new Uint8Array(e))}`,c=s/100*a,l=o/100*a;return`<image width="${c}" height="${l}" xlink:href="${r}" x="${i+(a-c)/2}" y="${i+(a-l)/2}"></image>`}const p2={name:"DownloadOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var f2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon download-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M13,5V11H14.17L12,13.17L9.83,11H11V5H13M15,3H9V9H5L12,16L19,9H15V3M19,18H5V20H19V18Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},m2=[],g2=H(p2,f2,m2,!1,null,null);const xa=g2.exports,y2={name:"QrcodeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var v2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon qrcode-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M3,11H5V13H3V11M11,5H13V9H11V5M9,11H13V15H11V13H9V11M15,11H17V13H19V11H21V13H19V15H21V19H19V21H17V19H13V21H11V17H15V15H17V13H15V11M19,19V15H17V19H19M15,3H21V9H15V3M17,5V7H19V5H17M3,3H9V9H3V3M5,5V7H7V5H5M3,15H9V21H3V15M5,17V19H7V17H5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},_2=[],b2=H(y2,v2,_2,!1,null,null);const C2=b2.exports,w2={name:"CakeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var k2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon cake-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M11.5,0.5C12,0.75 13,2.4 13,3.5C13,4.6 12.33,5 11.5,5C10.67,5 10,4.85 10,3.75C10,2.65 11,2 11.5,0.5M18.5,9C21,9 23,11 23,13.5C23,15.06 22.21,16.43 21,17.24V23H12L3,23V17.24C1.79,16.43 1,15.06 1,13.5C1,11 3,9 5.5,9H10V6H13V9H18.5M12,16A2.5,2.5 0 0,0 14.5,13.5H16A2.5,2.5 0 0,0 18.5,16A2.5,2.5 0 0,0 21,13.5A2.5,2.5 0 0,0 18.5,11H5.5A2.5,2.5 0 0,0 3,13.5A2.5,2.5 0 0,0 5.5,16A2.5,2.5 0 0,0 8,13.5H9.5A2.5,2.5 0 0,0 12,16Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},x2=[],S2=H(w2,k2,x2,!1,null,null);const M2=S2.exports,A2={name:"CheckIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var N2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon check-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},O2=[],D2=H(A2,N2,O2,!1,null,null);const Nl=D2.exports,L2={name:"EyeCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var T2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon eye-circle-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,11A1,1 0 0,1 13,12A1,1 0 0,1 12,13A1,1 0 0,1 11,12A1,1 0 0,1 12,11M12,8C14.63,8 17,9.57 18,12C16.62,15.31 12.81,16.88 9.5,15.5C7.92,14.84 6.66,13.58 6,12C7,9.57 9.37,8 12,8M12,9.5A2.5,2.5 0 0,0 9.5,12A2.5,2.5 0 0,0 12,14.5A2.5,2.5 0 0,0 14.5,12A2.5,2.5 0 0,0 12,9.5"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},E2=[],I2=H(L2,T2,E2,!1,null,null);const P2=I2.exports,z2={name:"FolderMultipleImageIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var B2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-multiple-image-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M7,15L11.5,9L15,13.5L17.5,10.5L21,15M22,4H14L12,2H6A2,2 0 0,0 4,4V16A2,2 0 0,0 6,18H22A2,2 0 0,0 24,16V6A2,2 0 0,0 22,4M2,6H0V11H0V20A2,2 0 0,0 2,22H20V20H2V6Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},$2=[],R2=H(z2,B2,$2,!1,null,null);const H2=R2.exports,Y2={name:"ChevronLeftIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var V2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon chevron-left-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},U2=[],G2=H(Y2,V2,U2,!1,null,null);const F2=G2.exports,j2={name:"DotsHorizontalIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var W2=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon dots-horizontal-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M16,12A2,2 0 0,1 18,10A2,2 0 0,1 20,12A2,2 0 0,1 18,14A2,2 0 0,1 16,12M10,12A2,2 0 0,1 12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12M4,12A2,2 0 0,1 6,10A2,2 0 0,1 8,12A2,2 0 0,1 6,14A2,2 0 0,1 4,12Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},q2=[],X2=H(j2,W2,q2,!1,null,null);const Z2=X2.exports,K2={name:"ContactDetailsAddNewProp",components:{IconAdd:mi,PropertyTitleIcon:Ed,Actions:Ze,ActionButton:Ke,ChevronLeft:F2,DotsHorizontalIcon:Z2},mixins:[Id],props:{contact:{type:Us,default:null},bus:{type:Object,required:!0}},data(){return{moreActionsOpen:!1}},computed:{properties(){return ve.properties},propertiesOrder(){return ve.fieldOrder},usedProperties(){return this.contact.jCal[1].map(e=>e[0])},availablePrimaryProperties(){return Object.keys(this.properties).filter(e=>this.properties[e].primary).map(e=>({id:e,name:this.properties[e].readableName,icon:this.properties[e].icon})).sort((e,i)=>this.propertiesOrder.indexOf(e.id)-this.propertiesOrder.indexOf(i.id))},availableSecondaryProperties(){return Object.keys(this.properties).filter(e=>!this.properties[e].primary).map(e=>({id:e,name:this.properties[e].readableName,icon:this.properties[e].icon})).sort((e,i)=>e.name.localeCompare(i.name))}},created(){this.bus.on("add-prop",this.addProp)},destroyed(){this.bus.off("add-prop",this.addProp)},methods:{async addProp(e){if(this.usedProperties.includes(e)&&!this.properties[e].multiple){this.bus.emit("focus-prop",e);return}if(e==="x-managersname"){const i=this.otherContacts(this.contact);i.length===1?(await this.contact.vCard.addPropertyWithValue(e,i[0].key),await this.$store.dispatch("updateContact",this.contact)):await this.contact.vCard.addPropertyWithValue(e,"")}else if(this.properties[e]&&this.properties[e].defaultjCal&&this.properties[e].defaultjCal[this.contact.version]){const i=this.properties[e].defaultjCal[this.contact.version],a=new Rs.Property([e,...i]);await this.contact.vCard.addProperty(a)}else{const i=this.properties[e].defaultValue;let a=i?i.value:"";Array.isArray(a)&&(a=[...a]);const s=await this.contact.vCard.addPropertyWithValue(e,a);i&&i.type&&s.setParameter("type",i.type)}this.moreActionsOpen=!1,this.bus.emit("focus-prop",e)}}};var J2=function(){var e=this,i=e._self._c;return i("div",{staticClass:"property__row"},[i("div",{staticClass:"property__label"}),i("div",{staticClass:"property__value"},[i("Actions",{attrs:{"menu-align":"right",event:"",type:"secondary","menu-name":e.t("contacts","Add more info")},nativeOn:{click:function(a){a.preventDefault()}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAdd",{attrs:{size:20}})]},proxy:!0}])},[e.moreActionsOpen?e._e():[e._l(e.availablePrimaryProperties,function(a){return i("ActionButton",{key:a.id,staticClass:"action--primary",attrs:{"close-after-click":!0},on:{click:function(s){return s.preventDefault(),e.addProp(a.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("PropertyTitleIcon",{attrs:{icon:a.icon}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(a.name)+" ")])}),i("ActionButton",{attrs:{"close-after-click":!1},on:{click:function(a){e.moreActionsOpen=!0}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("DotsHorizontalIcon",{attrs:{title:e.t("contacts","More fields"),size:20}})]},proxy:!0}],null,!1,1229943913)},[e._v(" "+e._s(e.t("contacts","More fields"))+" ")])],e.moreActionsOpen?[i("ActionButton",{attrs:{"close-after-click":!1},on:{click:function(a){e.moreActionsOpen=!1}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("ChevronLeft",{attrs:{title:e.t("contacts","More fields"),size:20}}),e._v(" "+e._s(e.t("contacts","More fields"))+" ")]},proxy:!0}],null,!1,1205835463)}),e._l(e.availableSecondaryProperties,function(a){return i("ActionButton",{key:a.id,staticClass:"action--primary",attrs:{"close-after-click":!0},on:{click:function(s){return s.preventDefault(),e.addProp(a.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("PropertyTitleIcon",{attrs:{icon:a.icon}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(a.name)+" ")])})]:e._e()],2)],1),i("div",{staticClass:"property__actions"})])},Q2=[],t_=H(K2,J2,Q2,!1,null,null);const e_=t_.exports,n_={name:"CloudDownloadOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var i_=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon cloud-download-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M6.5 20Q4.22 20 2.61 18.43 1 16.85 1 14.58 1 12.63 2.17 11.1 3.35 9.57 5.25 9.15 5.68 7.35 7.38 5.73 9.07 4.1 11 4.1 11.83 4.1 12.41 4.69 13 5.28 13 6.1V12.15L14.6 10.6L16 12L12 16L8 12L9.4 10.6L11 12.15V6.1Q9.1 6.45 8.05 7.94 7 9.43 7 11H6.5Q5.05 11 4.03 12.03 3 13.05 3 14.5 3 15.95 4.03 17 5.05 18 6.5 18H18.5Q19.55 18 20.27 17.27 21 16.55 21 15.5 21 14.45 20.27 13.73 19.55 13 18.5 13H17V11Q17 9.8 16.45 8.76 15.9 7.73 15 7V4.68Q16.85 5.55 17.93 7.26 19 9 19 11 20.73 11.2 21.86 12.5 23 13.78 23 15.5 23 17.38 21.69 18.69 20.38 20 18.5 20M12 11.05Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},a_=[],s_=H(n_,i_,a_,!1,null,null);const o_=s_.exports,r_={name:"UploadOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var c_=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon upload-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9,10V16H15V10H19L12,3L5,10H9M12,5.8L14.2,8H13V14H11V8H9.8L12,5.8M19,18H5V20H19V18Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},l_=[],u_=H(r_,c_,l_,!1,null,null);const Ol=u_.exports,d_={name:"FolderOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var h_=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M20,18H4V8H20M20,6H12L10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},p_=[],f_=H(d_,h_,p_,!1,null,null);const Dl=f_.exports,m_={name:"ImageOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var g_=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon image-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M13.96,12.29L11.21,15.83L9.25,13.47L6.5,17H17.5L13.96,12.29Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},y_=[],v_=H(m_,g_,y_,!1,null,null);const __=v_.exports;var Ll={},Tl={exports:{}};(function(e,i){(function(a,s){e.exports=s()})(Ps,function(){function a(d,f){var p=Object.keys(d);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(d);f&&(v=v.filter(function(_){return Object.getOwnPropertyDescriptor(d,_).enumerable})),p.push.apply(p,v)}return p}function s(d){for(var f=1;f<arguments.length;f++){var p=arguments[f]!=null?arguments[f]:{};f%2?a(Object(p),!0).forEach(function(v){h(d,v,p[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(p)):a(Object(p)).forEach(function(v){Object.defineProperty(d,v,Object.getOwnPropertyDescriptor(p,v))})}return d}function o(d){"@babel/helpers - typeof";return o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},o(d)}function r(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function c(d,f){for(var p=0;p<f.length;p++){var v=f[p];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(d,v.key,v)}}function l(d,f,p){return f&&c(d.prototype,f),p&&c(d,p),Object.defineProperty(d,"prototype",{writable:!1}),d}function h(d,f,p){return f in d?Object.defineProperty(d,f,{value:p,enumerable:!0,configurable:!0,writable:!0}):d[f]=p,d}function u(d){return m(d)||g(d)||b(d)||A()}function m(d){if(Array.isArray(d))return k(d)}function g(d){if(typeof Symbol<"u"&&d[Symbol.iterator]!=null||d["@@iterator"]!=null)return Array.from(d)}function b(d,f){if(d){if(typeof d=="string")return k(d,f);var p=Object.prototype.toString.call(d).slice(8,-1);if(p==="Object"&&d.constructor&&(p=d.constructor.name),p==="Map"||p==="Set")return Array.from(d);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return k(d,f)}}function k(d,f){(f==null||f>d.length)&&(f=d.length);for(var p=0,v=new Array(f);p<f;p++)v[p]=d[p];return v}function A(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var T=typeof window<"u"&&typeof window.document<"u",B=T?window:{},z=T&&B.document.documentElement?"ontouchstart"in B.document.documentElement:!1,j=T?"PointerEvent"in B:!1,F="cropper",X="all",st="crop",ut="move",it="zoom",yt="e",vt="w",_t="s",S="n",x="ne",w="nw",y="se",N="sw",O="".concat(F,"-crop"),Y="".concat(F,"-disabled"),G="".concat(F,"-hidden"),q="".concat(F,"-hide"),Z="".concat(F,"-invisible"),J="".concat(F,"-modal"),ot="".concat(F,"-move"),xt="".concat(F,"Action"),mt="".concat(F,"Preview"),Tt="crop",Bt="move",St="none",Nt="crop",qt="cropend",Hn="cropmove",yn="cropstart",bi="dblclick",_u=z?"touchstart":"mousedown",bu=z?"touchmove":"mousemove",Cu=z?"touchend touchcancel":"mouseup",xo=j?"pointerdown":_u,So=j?"pointermove":bu,Mo=j?"pointerup pointercancel":Cu,Ao="ready",No="resize",Oo="wheel",Oa="zoom",Do="image/jpeg",wu=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,ku=/^data:/,xu=/^data:image\/jpeg;base64,/,Su=/^img|canvas$/i,Lo=200,To=100,Eo={viewMode:0,dragMode:Tt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Lo,minContainerHeight:To,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Mu='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',Au=Number.isNaN||B.isNaN;function et(d){return typeof d=="number"&&!Au(d)}var Io=function(d){return d>0&&d<1/0};function Da(d){return typeof d>"u"}function tn(d){return o(d)==="object"&&d!==null}var Nu=Object.prototype.hasOwnProperty;function vn(d){if(!tn(d))return!1;try{var f=d.constructor,p=f.prototype;return f&&p&&Nu.call(p,"isPrototypeOf")}catch{return!1}}function Vt(d){return typeof d=="function"}var Ou=Array.prototype.slice;function Po(d){return Array.from?Array.from(d):Ou.call(d)}function Ot(d,f){return d&&Vt(f)&&(Array.isArray(d)||et(d.length)?Po(d).forEach(function(p,v){f.call(d,p,v,d)}):tn(d)&&Object.keys(d).forEach(function(p){f.call(d,d[p],p,d)})),d}var wt=Object.assign||function(d){for(var f=arguments.length,p=new Array(f>1?f-1:0),v=1;v<f;v++)p[v-1]=arguments[v];return tn(d)&&p.length>0&&p.forEach(function(_){tn(_)&&Object.keys(_).forEach(function(C){d[C]=_[C]})}),d},Du=/\.\d*(?:0|9){12}\d*$/;function _n(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Du.test(d)?Math.round(d*f)/f:d}var Lu=/^width|height|left|top|marginLeft|marginTop$/;function $e(d,f){var p=d.style;Ot(f,function(v,_){Lu.test(_)&&et(v)&&(v="".concat(v,"px")),p[_]=v})}function Tu(d,f){return d.classList?d.classList.contains(f):d.className.indexOf(f)>-1}function It(d,f){if(f){if(et(d.length)){Ot(d,function(v){It(v,f)});return}if(d.classList){d.classList.add(f);return}var p=d.className.trim();p?p.indexOf(f)<0&&(d.className="".concat(p," ").concat(f)):d.className=f}}function fe(d,f){if(f){if(et(d.length)){Ot(d,function(p){fe(p,f)});return}if(d.classList){d.classList.remove(f);return}d.className.indexOf(f)>=0&&(d.className=d.className.replace(f,""))}}function bn(d,f,p){if(f){if(et(d.length)){Ot(d,function(v){bn(v,f,p)});return}p?It(d,f):fe(d,f)}}var Eu=/([a-z\d])([A-Z])/g;function La(d){return d.replace(Eu,"$1-$2").toLowerCase()}function Ta(d,f){return tn(d[f])?d[f]:d.dataset?d.dataset[f]:d.getAttribute("data-".concat(La(f)))}function Yn(d,f,p){tn(p)?d[f]=p:d.dataset?d.dataset[f]=p:d.setAttribute("data-".concat(La(f)),p)}function Iu(d,f){if(tn(d[f]))try{delete d[f]}catch{d[f]=void 0}else if(d.dataset)try{delete d.dataset[f]}catch{d.dataset[f]=void 0}else d.removeAttribute("data-".concat(La(f)))}var zo=/\s\s*/,Bo=function(){var d=!1;if(T){var f=!1,p=function(){},v=Object.defineProperty({},"once",{get:function(){return d=!0,f},set:function(_){f=_}});B.addEventListener("test",p,v),B.removeEventListener("test",p,v)}return d}();function ae(d,f,p){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},_=p;f.trim().split(zo).forEach(function(C){if(!Bo){var M=d.listeners;M&&M[C]&&M[C][p]&&(_=M[C][p],delete M[C][p],Object.keys(M[C]).length===0&&delete M[C],Object.keys(M).length===0&&delete d.listeners)}d.removeEventListener(C,_,v)})}function Qt(d,f,p){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},_=p;f.trim().split(zo).forEach(function(C){if(v.once&&!Bo){var M=d.listeners,E=M===void 0?{}:M;_=function(){delete E[C][p],d.removeEventListener(C,_,v);for(var I=arguments.length,D=new Array(I),L=0;L<I;L++)D[L]=arguments[L];p.apply(d,D)},E[C]||(E[C]={}),E[C][p]&&d.removeEventListener(C,E[C][p],v),E[C][p]=_,d.listeners=E}d.addEventListener(C,_,v)})}function Cn(d,f,p){var v;return Vt(Event)&&Vt(CustomEvent)?v=new CustomEvent(f,{detail:p,bubbles:!0,cancelable:!0}):(v=document.createEvent("CustomEvent"),v.initCustomEvent(f,!0,!0,p)),d.dispatchEvent(v)}function $o(d){var f=d.getBoundingClientRect();return{left:f.left+(window.pageXOffset-document.documentElement.clientLeft),top:f.top+(window.pageYOffset-document.documentElement.clientTop)}}var Ea=B.location,Pu=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Ro(d){var f=d.match(Pu);return f!==null&&(f[1]!==Ea.protocol||f[2]!==Ea.hostname||f[3]!==Ea.port)}function Ho(d){var f="timestamp=".concat(new Date().getTime());return d+(d.indexOf("?")===-1?"?":"&")+f}function Vn(d){var f=d.rotate,p=d.scaleX,v=d.scaleY,_=d.translateX,C=d.translateY,M=[];et(_)&&_!==0&&M.push("translateX(".concat(_,"px)")),et(C)&&C!==0&&M.push("translateY(".concat(C,"px)")),et(f)&&f!==0&&M.push("rotate(".concat(f,"deg)")),et(p)&&p!==1&&M.push("scaleX(".concat(p,")")),et(v)&&v!==1&&M.push("scaleY(".concat(v,")"));var E=M.length?M.join(" "):"none";return{WebkitTransform:E,msTransform:E,transform:E}}function zu(d){var f=s({},d),p=0;return Ot(d,function(v,_){delete f[_],Ot(f,function(C){var M=Math.abs(v.startX-C.startX),E=Math.abs(v.startY-C.startY),I=Math.abs(v.endX-C.endX),D=Math.abs(v.endY-C.endY),L=Math.sqrt(M*M+E*E),P=Math.sqrt(I*I+D*D),rt=(P-L)/L;Math.abs(rt)>Math.abs(p)&&(p=rt)})}),p}function Ci(d,f){var p=d.pageX,v=d.pageY,_={endX:p,endY:v};return f?_:s({startX:p,startY:v},_)}function Bu(d){var f=0,p=0,v=0;return Ot(d,function(_){var C=_.startX,M=_.startY;f+=C,p+=M,v+=1}),f/=v,p/=v,{pageX:f,pageY:p}}function Re(d){var f=d.aspectRatio,p=d.height,v=d.width,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",C=Io(v),M=Io(p);if(C&&M){var E=p*f;_==="contain"&&E>v||_==="cover"&&E<v?p=v/f:v=p*f}else C?p=v/f:M&&(v=p*f);return{width:v,height:p}}function $u(d){var f=d.width,p=d.height,v=d.degree;if(v=Math.abs(v)%180,v===90)return{width:p,height:f};var _=v%90*Math.PI/180,C=Math.sin(_),M=Math.cos(_),E=f*M+p*C,I=f*C+p*M;return v>90?{width:I,height:E}:{width:E,height:I}}function Ru(d,f,p,v){var _=f.aspectRatio,C=f.naturalWidth,M=f.naturalHeight,E=f.rotate,I=E===void 0?0:E,D=f.scaleX,L=D===void 0?1:D,P=f.scaleY,rt=P===void 0?1:P,Q=p.aspectRatio,pt=p.naturalWidth,ht=p.naturalHeight,Dt=v.fillColor,Pt=Dt===void 0?"transparent":Dt,Mt=v.imageSmoothingEnabled,He=Mt===void 0?!0:Mt,Ut=v.imageSmoothingQuality,R=Ut===void 0?"low":Ut,dt=v.maxWidth,Lt=dt===void 0?1/0:dt,me=v.maxHeight,ke=me===void 0?1/0:me,en=v.minWidth,nn=en===void 0?0:en,Ye=v.minHeight,Ve=Ye===void 0?0:Ye,an=document.createElement("canvas"),$t=an.getContext("2d"),wi=Re({aspectRatio:Q,width:Lt,height:ke}),Uo=Re({aspectRatio:Q,width:nn,height:Ve},"cover"),Ia=Math.min(wi.width,Math.max(Uo.width,pt)),Pa=Math.min(wi.height,Math.max(Uo.height,ht)),Go=Re({aspectRatio:_,width:Lt,height:ke}),Fo=Re({aspectRatio:_,width:nn,height:Ve},"cover"),jo=Math.min(Go.width,Math.max(Fo.width,C)),Wo=Math.min(Go.height,Math.max(Fo.height,M)),Qu=[-jo/2,-Wo/2,jo,Wo];return an.width=_n(Ia),an.height=_n(Pa),$t.fillStyle=Pt,$t.fillRect(0,0,Ia,Pa),$t.save(),$t.translate(Ia/2,Pa/2),$t.rotate(I*Math.PI/180),$t.scale(L,rt),$t.imageSmoothingEnabled=He,$t.imageSmoothingQuality=R,$t.drawImage.apply($t,[d].concat(u(Qu.map(function(td){return Math.floor(_n(td))})))),$t.restore(),an}var Yo=String.fromCharCode;function Hu(d,f,p){var v="";p+=f;for(var _=f;_<p;_+=1)v+=Yo(d.getUint8(_));return v}var Yu=/^data:.*,/;function Vu(d){var f=d.replace(Yu,""),p=atob(f),v=new ArrayBuffer(p.length),_=new Uint8Array(v);return Ot(_,function(C,M){_[M]=p.charCodeAt(M)}),v}function Uu(d,f){for(var p=[],v=8192,_=new Uint8Array(d);_.length>0;)p.push(Yo.apply(null,Po(_.subarray(0,v)))),_=_.subarray(v);return"data:".concat(f,";base64,").concat(btoa(p.join("")))}function Gu(d){var f=new DataView(d),p;try{var v,_,C;if(f.getUint8(0)===255&&f.getUint8(1)===216)for(var M=f.byteLength,E=2;E+1<M;){if(f.getUint8(E)===255&&f.getUint8(E+1)===225){_=E;break}E+=1}if(_){var I=_+4,D=_+10;if(Hu(f,I,4)==="Exif"){var L=f.getUint16(D);if(v=L===18761,(v||L===19789)&&f.getUint16(D+2,v)===42){var P=f.getUint32(D+4,v);P>=8&&(C=D+P)}}}if(C){var rt=f.getUint16(C,v),Q,pt;for(pt=0;pt<rt;pt+=1)if(Q=C+pt*12+2,f.getUint16(Q,v)===274){Q+=8,p=f.getUint16(Q,v),f.setUint16(Q,1,v);break}}}catch{p=1}return p}function Fu(d){var f=0,p=1,v=1;switch(d){case 2:p=-1;break;case 3:f=-180;break;case 4:v=-1;break;case 5:f=90,v=-1;break;case 6:f=90;break;case 7:f=90,p=-1;break;case 8:f=-90;break}return{rotate:f,scaleX:p,scaleY:v}}var ju={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var d=this.element,f=this.options,p=this.container,v=this.cropper,_=Number(f.minContainerWidth),C=Number(f.minContainerHeight);It(v,G),fe(d,G);var M={width:Math.max(p.offsetWidth,_>=0?_:Lo),height:Math.max(p.offsetHeight,C>=0?C:To)};this.containerData=M,$e(v,{width:M.width,height:M.height}),It(d,G),fe(v,G)},initCanvas:function(){var d=this.containerData,f=this.imageData,p=this.options.viewMode,v=Math.abs(f.rotate)%180===90,_=v?f.naturalHeight:f.naturalWidth,C=v?f.naturalWidth:f.naturalHeight,M=_/C,E=d.width,I=d.height;d.height*M>d.width?p===3?E=d.height*M:I=d.width/M:p===3?I=d.width/M:E=d.height*M;var D={aspectRatio:M,naturalWidth:_,naturalHeight:C,width:E,height:I};this.canvasData=D,this.limited=p===1||p===2,this.limitCanvas(!0,!0),D.width=Math.min(Math.max(D.width,D.minWidth),D.maxWidth),D.height=Math.min(Math.max(D.height,D.minHeight),D.maxHeight),D.left=(d.width-D.width)/2,D.top=(d.height-D.height)/2,D.oldLeft=D.left,D.oldTop=D.top,this.initialCanvasData=wt({},D)},limitCanvas:function(d,f){var p=this.options,v=this.containerData,_=this.canvasData,C=this.cropBoxData,M=p.viewMode,E=_.aspectRatio,I=this.cropped&&C;if(d){var D=Number(p.minCanvasWidth)||0,L=Number(p.minCanvasHeight)||0;M>1?(D=Math.max(D,v.width),L=Math.max(L,v.height),M===3&&(L*E>D?D=L*E:L=D/E)):M>0&&(D?D=Math.max(D,I?C.width:0):L?L=Math.max(L,I?C.height:0):I&&(D=C.width,L=C.height,L*E>D?D=L*E:L=D/E));var P=Re({aspectRatio:E,width:D,height:L});D=P.width,L=P.height,_.minWidth=D,_.minHeight=L,_.maxWidth=1/0,_.maxHeight=1/0}if(f)if(M>(I?0:1)){var rt=v.width-_.width,Q=v.height-_.height;_.minLeft=Math.min(0,rt),_.minTop=Math.min(0,Q),_.maxLeft=Math.max(0,rt),_.maxTop=Math.max(0,Q),I&&this.limited&&(_.minLeft=Math.min(C.left,C.left+(C.width-_.width)),_.minTop=Math.min(C.top,C.top+(C.height-_.height)),_.maxLeft=C.left,_.maxTop=C.top,M===2&&(_.width>=v.width&&(_.minLeft=Math.min(0,rt),_.maxLeft=Math.max(0,rt)),_.height>=v.height&&(_.minTop=Math.min(0,Q),_.maxTop=Math.max(0,Q))))}else _.minLeft=-_.width,_.minTop=-_.height,_.maxLeft=v.width,_.maxTop=v.height},renderCanvas:function(d,f){var p=this.canvasData,v=this.imageData;if(f){var _=$u({width:v.naturalWidth*Math.abs(v.scaleX||1),height:v.naturalHeight*Math.abs(v.scaleY||1),degree:v.rotate||0}),C=_.width,M=_.height,E=p.width*(C/p.naturalWidth),I=p.height*(M/p.naturalHeight);p.left-=(E-p.width)/2,p.top-=(I-p.height)/2,p.width=E,p.height=I,p.aspectRatio=C/M,p.naturalWidth=C,p.naturalHeight=M,this.limitCanvas(!0,!1)}(p.width>p.maxWidth||p.width<p.minWidth)&&(p.left=p.oldLeft),(p.height>p.maxHeight||p.height<p.minHeight)&&(p.top=p.oldTop),p.width=Math.min(Math.max(p.width,p.minWidth),p.maxWidth),p.height=Math.min(Math.max(p.height,p.minHeight),p.maxHeight),this.limitCanvas(!1,!0),p.left=Math.min(Math.max(p.left,p.minLeft),p.maxLeft),p.top=Math.min(Math.max(p.top,p.minTop),p.maxTop),p.oldLeft=p.left,p.oldTop=p.top,$e(this.canvas,wt({width:p.width,height:p.height},Vn({translateX:p.left,translateY:p.top}))),this.renderImage(d),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(d){var f=this.canvasData,p=this.imageData,v=p.naturalWidth*(f.width/f.naturalWidth),_=p.naturalHeight*(f.height/f.naturalHeight);wt(p,{width:v,height:_,left:(f.width-v)/2,top:(f.height-_)/2}),$e(this.image,wt({width:p.width,height:p.height},Vn(wt({translateX:p.left,translateY:p.top},p)))),d&&this.output()},initCropBox:function(){var d=this.options,f=this.canvasData,p=d.aspectRatio||d.initialAspectRatio,v=Number(d.autoCropArea)||.8,_={width:f.width,height:f.height};p&&(f.height*p>f.width?_.height=_.width/p:_.width=_.height*p),this.cropBoxData=_,this.limitCropBox(!0,!0),_.width=Math.min(Math.max(_.width,_.minWidth),_.maxWidth),_.height=Math.min(Math.max(_.height,_.minHeight),_.maxHeight),_.width=Math.max(_.minWidth,_.width*v),_.height=Math.max(_.minHeight,_.height*v),_.left=f.left+(f.width-_.width)/2,_.top=f.top+(f.height-_.height)/2,_.oldLeft=_.left,_.oldTop=_.top,this.initialCropBoxData=wt({},_)},limitCropBox:function(d,f){var p=this.options,v=this.containerData,_=this.canvasData,C=this.cropBoxData,M=this.limited,E=p.aspectRatio;if(d){var I=Number(p.minCropBoxWidth)||0,D=Number(p.minCropBoxHeight)||0,L=M?Math.min(v.width,_.width,_.width+_.left,v.width-_.left):v.width,P=M?Math.min(v.height,_.height,_.height+_.top,v.height-_.top):v.height;I=Math.min(I,v.width),D=Math.min(D,v.height),E&&(I&&D?D*E>I?D=I/E:I=D*E:I?D=I/E:D&&(I=D*E),P*E>L?P=L/E:L=P*E),C.minWidth=Math.min(I,L),C.minHeight=Math.min(D,P),C.maxWidth=L,C.maxHeight=P}f&&(M?(C.minLeft=Math.max(0,_.left),C.minTop=Math.max(0,_.top),C.maxLeft=Math.min(v.width,_.left+_.width)-C.width,C.maxTop=Math.min(v.height,_.top+_.height)-C.height):(C.minLeft=0,C.minTop=0,C.maxLeft=v.width-C.width,C.maxTop=v.height-C.height))},renderCropBox:function(){var d=this.options,f=this.containerData,p=this.cropBoxData;(p.width>p.maxWidth||p.width<p.minWidth)&&(p.left=p.oldLeft),(p.height>p.maxHeight||p.height<p.minHeight)&&(p.top=p.oldTop),p.width=Math.min(Math.max(p.width,p.minWidth),p.maxWidth),p.height=Math.min(Math.max(p.height,p.minHeight),p.maxHeight),this.limitCropBox(!1,!0),p.left=Math.min(Math.max(p.left,p.minLeft),p.maxLeft),p.top=Math.min(Math.max(p.top,p.minTop),p.maxTop),p.oldLeft=p.left,p.oldTop=p.top,d.movable&&d.cropBoxMovable&&Yn(this.face,xt,p.width>=f.width&&p.height>=f.height?ut:X),$e(this.cropBox,wt({width:p.width,height:p.height},Vn({translateX:p.left,translateY:p.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Cn(this.element,Nt,this.getData())}},Wu={initPreview:function(){var d=this.element,f=this.crossOrigin,p=this.options.preview,v=f?this.crossOriginUrl:this.url,_=d.alt||"The image to preview",C=document.createElement("img");if(f&&(C.crossOrigin=f),C.src=v,C.alt=_,this.viewBox.appendChild(C),this.viewBoxImage=C,!!p){var M=p;typeof p=="string"?M=d.ownerDocument.querySelectorAll(p):p.querySelector&&(M=[p]),this.previews=M,Ot(M,function(E){var I=document.createElement("img");Yn(E,mt,{width:E.offsetWidth,height:E.offsetHeight,html:E.innerHTML}),f&&(I.crossOrigin=f),I.src=v,I.alt=_,I.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',E.innerHTML="",E.appendChild(I)})}},resetPreview:function(){Ot(this.previews,function(d){var f=Ta(d,mt);$e(d,{width:f.width,height:f.height}),d.innerHTML=f.html,Iu(d,mt)})},preview:function(){var d=this.imageData,f=this.canvasData,p=this.cropBoxData,v=p.width,_=p.height,C=d.width,M=d.height,E=p.left-f.left-d.left,I=p.top-f.top-d.top;!this.cropped||this.disabled||($e(this.viewBoxImage,wt({width:C,height:M},Vn(wt({translateX:-E,translateY:-I},d)))),Ot(this.previews,function(D){var L=Ta(D,mt),P=L.width,rt=L.height,Q=P,pt=rt,ht=1;v&&(ht=P/v,pt=_*ht),_&&pt>rt&&(ht=rt/_,Q=v*ht,pt=rt),$e(D,{width:Q,height:pt}),$e(D.getElementsByTagName("img")[0],wt({width:C*ht,height:M*ht},Vn(wt({translateX:-E*ht,translateY:-I*ht},d))))}))}},qu={bind:function(){var d=this.element,f=this.options,p=this.cropper;Vt(f.cropstart)&&Qt(d,yn,f.cropstart),Vt(f.cropmove)&&Qt(d,Hn,f.cropmove),Vt(f.cropend)&&Qt(d,qt,f.cropend),Vt(f.crop)&&Qt(d,Nt,f.crop),Vt(f.zoom)&&Qt(d,Oa,f.zoom),Qt(p,xo,this.onCropStart=this.cropStart.bind(this)),f.zoomable&&f.zoomOnWheel&&Qt(p,Oo,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),f.toggleDragModeOnDblclick&&Qt(p,bi,this.onDblclick=this.dblclick.bind(this)),Qt(d.ownerDocument,So,this.onCropMove=this.cropMove.bind(this)),Qt(d.ownerDocument,Mo,this.onCropEnd=this.cropEnd.bind(this)),f.responsive&&Qt(window,No,this.onResize=this.resize.bind(this))},unbind:function(){var d=this.element,f=this.options,p=this.cropper;Vt(f.cropstart)&&ae(d,yn,f.cropstart),Vt(f.cropmove)&&ae(d,Hn,f.cropmove),Vt(f.cropend)&&ae(d,qt,f.cropend),Vt(f.crop)&&ae(d,Nt,f.crop),Vt(f.zoom)&&ae(d,Oa,f.zoom),ae(p,xo,this.onCropStart),f.zoomable&&f.zoomOnWheel&&ae(p,Oo,this.onWheel,{passive:!1,capture:!0}),f.toggleDragModeOnDblclick&&ae(p,bi,this.onDblclick),ae(d.ownerDocument,So,this.onCropMove),ae(d.ownerDocument,Mo,this.onCropEnd),f.responsive&&ae(window,No,this.onResize)}},Xu={resize:function(){if(!this.disabled){var d=this.options,f=this.container,p=this.containerData,v=f.offsetWidth/p.width,_=f.offsetHeight/p.height,C=Math.abs(v-1)>Math.abs(_-1)?v:_;if(C!==1){var M,E;d.restore&&(M=this.getCanvasData(),E=this.getCropBoxData()),this.render(),d.restore&&(this.setCanvasData(Ot(M,function(I,D){M[D]=I*C})),this.setCropBoxData(Ot(E,function(I,D){E[D]=I*C})))}}},dblclick:function(){this.disabled||this.options.dragMode===St||this.setDragMode(Tu(this.dragBox,O)?Bt:Tt)},wheel:function(d){var f=this,p=Number(this.options.wheelZoomRatio)||.1,v=1;this.disabled||(d.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){f.wheeling=!1},50),d.deltaY?v=d.deltaY>0?1:-1:d.wheelDelta?v=-d.wheelDelta/120:d.detail&&(v=d.detail>0?1:-1),this.zoom(-v*p,d)))},cropStart:function(d){var f=d.buttons,p=d.button;if(!(this.disabled||(d.type==="mousedown"||d.type==="pointerdown"&&d.pointerType==="mouse")&&(et(f)&&f!==1||et(p)&&p!==0||d.ctrlKey))){var v=this.options,_=this.pointers,C;d.changedTouches?Ot(d.changedTouches,function(M){_[M.identifier]=Ci(M)}):_[d.pointerId||0]=Ci(d),Object.keys(_).length>1&&v.zoomable&&v.zoomOnTouch?C=it:C=Ta(d.target,xt),wu.test(C)&&Cn(this.element,yn,{originalEvent:d,action:C})!==!1&&(d.preventDefault(),this.action=C,this.cropping=!1,C===st&&(this.cropping=!0,It(this.dragBox,J)))}},cropMove:function(d){var f=this.action;if(!(this.disabled||!f)){var p=this.pointers;d.preventDefault(),Cn(this.element,Hn,{originalEvent:d,action:f})!==!1&&(d.changedTouches?Ot(d.changedTouches,function(v){wt(p[v.identifier]||{},Ci(v,!0))}):wt(p[d.pointerId||0]||{},Ci(d,!0)),this.change(d))}},cropEnd:function(d){if(!this.disabled){var f=this.action,p=this.pointers;d.changedTouches?Ot(d.changedTouches,function(v){delete p[v.identifier]}):delete p[d.pointerId||0],f&&(d.preventDefault(),Object.keys(p).length||(this.action=""),this.cropping&&(this.cropping=!1,bn(this.dragBox,J,this.cropped&&this.options.modal)),Cn(this.element,qt,{originalEvent:d,action:f}))}}},Zu={change:function(d){var f=this.options,p=this.canvasData,v=this.containerData,_=this.cropBoxData,C=this.pointers,M=this.action,E=f.aspectRatio,I=_.left,D=_.top,L=_.width,P=_.height,rt=I+L,Q=D+P,pt=0,ht=0,Dt=v.width,Pt=v.height,Mt=!0,He;!E&&d.shiftKey&&(E=L&&P?L/P:1),this.limited&&(pt=_.minLeft,ht=_.minTop,Dt=pt+Math.min(v.width,p.width,p.left+p.width),Pt=ht+Math.min(v.height,p.height,p.top+p.height));var Ut=C[Object.keys(C)[0]],R={x:Ut.endX-Ut.startX,y:Ut.endY-Ut.startY},dt=function(Lt){switch(Lt){case yt:rt+R.x>Dt&&(R.x=Dt-rt);break;case vt:I+R.x<pt&&(R.x=pt-I);break;case S:D+R.y<ht&&(R.y=ht-D);break;case _t:Q+R.y>Pt&&(R.y=Pt-Q);break}};switch(M){case X:I+=R.x,D+=R.y;break;case yt:if(R.x>=0&&(rt>=Dt||E&&(D<=ht||Q>=Pt))){Mt=!1;break}dt(yt),L+=R.x,L<0&&(M=vt,L=-L,I-=L),E&&(P=L/E,D+=(_.height-P)/2);break;case S:if(R.y<=0&&(D<=ht||E&&(I<=pt||rt>=Dt))){Mt=!1;break}dt(S),P-=R.y,D+=R.y,P<0&&(M=_t,P=-P,D-=P),E&&(L=P*E,I+=(_.width-L)/2);break;case vt:if(R.x<=0&&(I<=pt||E&&(D<=ht||Q>=Pt))){Mt=!1;break}dt(vt),L-=R.x,I+=R.x,L<0&&(M=yt,L=-L,I-=L),E&&(P=L/E,D+=(_.height-P)/2);break;case _t:if(R.y>=0&&(Q>=Pt||E&&(I<=pt||rt>=Dt))){Mt=!1;break}dt(_t),P+=R.y,P<0&&(M=S,P=-P,D-=P),E&&(L=P*E,I+=(_.width-L)/2);break;case x:if(E){if(R.y<=0&&(D<=ht||rt>=Dt)){Mt=!1;break}dt(S),P-=R.y,D+=R.y,L=P*E}else dt(S),dt(yt),R.x>=0?rt<Dt?L+=R.x:R.y<=0&&D<=ht&&(Mt=!1):L+=R.x,R.y<=0?D>ht&&(P-=R.y,D+=R.y):(P-=R.y,D+=R.y);L<0&&P<0?(M=N,P=-P,L=-L,D-=P,I-=L):L<0?(M=w,L=-L,I-=L):P<0&&(M=y,P=-P,D-=P);break;case w:if(E){if(R.y<=0&&(D<=ht||I<=pt)){Mt=!1;break}dt(S),P-=R.y,D+=R.y,L=P*E,I+=_.width-L}else dt(S),dt(vt),R.x<=0?I>pt?(L-=R.x,I+=R.x):R.y<=0&&D<=ht&&(Mt=!1):(L-=R.x,I+=R.x),R.y<=0?D>ht&&(P-=R.y,D+=R.y):(P-=R.y,D+=R.y);L<0&&P<0?(M=y,P=-P,L=-L,D-=P,I-=L):L<0?(M=x,L=-L,I-=L):P<0&&(M=N,P=-P,D-=P);break;case N:if(E){if(R.x<=0&&(I<=pt||Q>=Pt)){Mt=!1;break}dt(vt),L-=R.x,I+=R.x,P=L/E}else dt(_t),dt(vt),R.x<=0?I>pt?(L-=R.x,I+=R.x):R.y>=0&&Q>=Pt&&(Mt=!1):(L-=R.x,I+=R.x),R.y>=0?Q<Pt&&(P+=R.y):P+=R.y;L<0&&P<0?(M=x,P=-P,L=-L,D-=P,I-=L):L<0?(M=y,L=-L,I-=L):P<0&&(M=w,P=-P,D-=P);break;case y:if(E){if(R.x>=0&&(rt>=Dt||Q>=Pt)){Mt=!1;break}dt(yt),L+=R.x,P=L/E}else dt(_t),dt(yt),R.x>=0?rt<Dt?L+=R.x:R.y>=0&&Q>=Pt&&(Mt=!1):L+=R.x,R.y>=0?Q<Pt&&(P+=R.y):P+=R.y;L<0&&P<0?(M=w,P=-P,L=-L,D-=P,I-=L):L<0?(M=N,L=-L,I-=L):P<0&&(M=x,P=-P,D-=P);break;case ut:this.move(R.x,R.y),Mt=!1;break;case it:this.zoom(zu(C),d),Mt=!1;break;case st:if(!R.x||!R.y){Mt=!1;break}He=$o(this.cropper),I=Ut.startX-He.left,D=Ut.startY-He.top,L=_.minWidth,P=_.minHeight,R.x>0?M=R.y>0?y:x:R.x<0&&(I-=L,M=R.y>0?N:w),R.y<0&&(D-=P),this.cropped||(fe(this.cropBox,G),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}Mt&&(_.width=L,_.height=P,_.left=I,_.top=D,this.action=M,this.renderCropBox()),Ot(C,function(Lt){Lt.startX=Lt.endX,Lt.startY=Lt.endY})}},Ku={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&It(this.dragBox,J),fe(this.cropBox,G),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=wt({},this.initialImageData),this.canvasData=wt({},this.initialCanvasData),this.cropBoxData=wt({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(wt(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),fe(this.dragBox,J),It(this.cropBox,G)),this},replace:function(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&d&&(this.isImg&&(this.element.src=d),f?(this.url=d,this.image.src=d,this.ready&&(this.viewBoxImage.src=d,Ot(this.previews,function(p){p.getElementsByTagName("img")[0].src=d}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(d))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,fe(this.cropper,Y)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,It(this.cropper,Y)),this},destroy:function(){var d=this.element;return d[F]?(d[F]=void 0,this.isImg&&this.replaced&&(d.src=this.originalUrl),this.uncreate(),this):this},move:function(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=this.canvasData,v=p.left,_=p.top;return this.moveTo(Da(d)?d:v+Number(d),Da(f)?f:_+Number(f))},moveTo:function(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=this.canvasData,v=!1;return d=Number(d),f=Number(f),this.ready&&!this.disabled&&this.options.movable&&(et(d)&&(p.left=d,v=!0),et(f)&&(p.top=f,v=!0),v&&this.renderCanvas(!0)),this},zoom:function(d,f){var p=this.canvasData;return d=Number(d),d<0?d=1/(1-d):d=1+d,this.zoomTo(p.width*d/p.naturalWidth,null,f)},zoomTo:function(d,f,p){var v=this.options,_=this.canvasData,C=_.width,M=_.height,E=_.naturalWidth,I=_.naturalHeight;if(d=Number(d),d>=0&&this.ready&&!this.disabled&&v.zoomable){var D=E*d,L=I*d;if(Cn(this.element,Oa,{ratio:d,oldRatio:C/E,originalEvent:p})===!1)return this;if(p){var P=this.pointers,rt=$o(this.cropper),Q=P&&Object.keys(P).length?Bu(P):{pageX:p.pageX,pageY:p.pageY};_.left-=(D-C)*((Q.pageX-rt.left-_.left)/C),_.top-=(L-M)*((Q.pageY-rt.top-_.top)/M)}else vn(f)&&et(f.x)&&et(f.y)?(_.left-=(D-C)*((f.x-_.left)/C),_.top-=(L-M)*((f.y-_.top)/M)):(_.left-=(D-C)/2,_.top-=(L-M)/2);_.width=D,_.height=L,this.renderCanvas(!0)}return this},rotate:function(d){return this.rotateTo((this.imageData.rotate||0)+Number(d))},rotateTo:function(d){return d=Number(d),et(d)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=d%360,this.renderCanvas(!0,!0)),this},scaleX:function(d){var f=this.imageData.scaleY;return this.scale(d,et(f)?f:1)},scaleY:function(d){var f=this.imageData.scaleX;return this.scale(et(f)?f:1,d)},scale:function(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=this.imageData,v=!1;return d=Number(d),f=Number(f),this.ready&&!this.disabled&&this.options.scalable&&(et(d)&&(p.scaleX=d,v=!0),et(f)&&(p.scaleY=f,v=!0),v&&this.renderCanvas(!0,!0)),this},getData:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=this.options,p=this.imageData,v=this.canvasData,_=this.cropBoxData,C;if(this.ready&&this.cropped){C={x:_.left-v.left,y:_.top-v.top,width:_.width,height:_.height};var M=p.width/p.naturalWidth;if(Ot(C,function(D,L){C[L]=D/M}),d){var E=Math.round(C.y+C.height),I=Math.round(C.x+C.width);C.x=Math.round(C.x),C.y=Math.round(C.y),C.width=I-C.x,C.height=E-C.y}}else C={x:0,y:0,width:0,height:0};return f.rotatable&&(C.rotate=p.rotate||0),f.scalable&&(C.scaleX=p.scaleX||1,C.scaleY=p.scaleY||1),C},setData:function(d){var f=this.options,p=this.imageData,v=this.canvasData,_={};if(this.ready&&!this.disabled&&vn(d)){var C=!1;f.rotatable&&et(d.rotate)&&d.rotate!==p.rotate&&(p.rotate=d.rotate,C=!0),f.scalable&&(et(d.scaleX)&&d.scaleX!==p.scaleX&&(p.scaleX=d.scaleX,C=!0),et(d.scaleY)&&d.scaleY!==p.scaleY&&(p.scaleY=d.scaleY,C=!0)),C&&this.renderCanvas(!0,!0);var M=p.width/p.naturalWidth;et(d.x)&&(_.left=d.x*M+v.left),et(d.y)&&(_.top=d.y*M+v.top),et(d.width)&&(_.width=d.width*M),et(d.height)&&(_.height=d.height*M),this.setCropBoxData(_)}return this},getContainerData:function(){return this.ready?wt({},this.containerData):{}},getImageData:function(){return this.sized?wt({},this.imageData):{}},getCanvasData:function(){var d=this.canvasData,f={};return this.ready&&Ot(["left","top","width","height","naturalWidth","naturalHeight"],function(p){f[p]=d[p]}),f},setCanvasData:function(d){var f=this.canvasData,p=f.aspectRatio;return this.ready&&!this.disabled&&vn(d)&&(et(d.left)&&(f.left=d.left),et(d.top)&&(f.top=d.top),et(d.width)?(f.width=d.width,f.height=d.width/p):et(d.height)&&(f.height=d.height,f.width=d.height*p),this.renderCanvas(!0)),this},getCropBoxData:function(){var d=this.cropBoxData,f;return this.ready&&this.cropped&&(f={left:d.left,top:d.top,width:d.width,height:d.height}),f||{}},setCropBoxData:function(d){var f=this.cropBoxData,p=this.options.aspectRatio,v,_;return this.ready&&this.cropped&&!this.disabled&&vn(d)&&(et(d.left)&&(f.left=d.left),et(d.top)&&(f.top=d.top),et(d.width)&&d.width!==f.width&&(v=!0,f.width=d.width),et(d.height)&&d.height!==f.height&&(_=!0,f.height=d.height),p&&(v?f.height=f.width/p:_&&(f.width=f.height*p)),this.renderCropBox()),this},getCroppedCanvas:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var f=this.canvasData,p=Ru(this.image,this.imageData,f,d);if(!this.cropped)return p;var v=this.getData(),_=v.x,C=v.y,M=v.width,E=v.height,I=p.width/Math.floor(f.naturalWidth);I!==1&&(_*=I,C*=I,M*=I,E*=I);var D=M/E,L=Re({aspectRatio:D,width:d.maxWidth||1/0,height:d.maxHeight||1/0}),P=Re({aspectRatio:D,width:d.minWidth||0,height:d.minHeight||0},"cover"),rt=Re({aspectRatio:D,width:d.width||(I!==1?p.width:M),height:d.height||(I!==1?p.height:E)}),Q=rt.width,pt=rt.height;Q=Math.min(L.width,Math.max(P.width,Q)),pt=Math.min(L.height,Math.max(P.height,pt));var ht=document.createElement("canvas"),Dt=ht.getContext("2d");ht.width=_n(Q),ht.height=_n(pt),Dt.fillStyle=d.fillColor||"transparent",Dt.fillRect(0,0,Q,pt);var Pt=d.imageSmoothingEnabled,Mt=Pt===void 0?!0:Pt,He=d.imageSmoothingQuality;Dt.imageSmoothingEnabled=Mt,He&&(Dt.imageSmoothingQuality=He);var Ut=p.width,R=p.height,dt=_,Lt=C,me,ke,en,nn,Ye,Ve;dt<=-M||dt>Ut?(dt=0,me=0,en=0,Ye=0):dt<=0?(en=-dt,dt=0,me=Math.min(Ut,M+dt),Ye=me):dt<=Ut&&(en=0,me=Math.min(M,Ut-dt),Ye=me),me<=0||Lt<=-E||Lt>R?(Lt=0,ke=0,nn=0,Ve=0):Lt<=0?(nn=-Lt,Lt=0,ke=Math.min(R,E+Lt),Ve=ke):Lt<=R&&(nn=0,ke=Math.min(E,R-Lt),Ve=ke);var an=[dt,Lt,me,ke];if(Ye>0&&Ve>0){var $t=Q/M;an.push(en*$t,nn*$t,Ye*$t,Ve*$t)}return Dt.drawImage.apply(Dt,[p].concat(u(an.map(function(wi){return Math.floor(_n(wi))})))),ht},setAspectRatio:function(d){var f=this.options;return!this.disabled&&!Da(d)&&(f.aspectRatio=Math.max(0,d)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(d){var f=this.options,p=this.dragBox,v=this.face;if(this.ready&&!this.disabled){var _=d===Tt,C=f.movable&&d===Bt;d=_||C?d:St,f.dragMode=d,Yn(p,xt,d),bn(p,O,_),bn(p,ot,C),f.cropBoxMovable||(Yn(v,xt,d),bn(v,O,_),bn(v,ot,C))}return this}},Ju=B.Cropper,Vo=function(){function d(f){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r(this,d),!f||!Su.test(f.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=f,this.options=wt({},Eo,vn(p)&&p),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return l(d,[{key:"init",value:function(){var f=this.element,p=f.tagName.toLowerCase(),v;if(!f[F]){if(f[F]=this,p==="img"){if(this.isImg=!0,v=f.getAttribute("src")||"",this.originalUrl=v,!v)return;v=f.src}else p==="canvas"&&window.HTMLCanvasElement&&(v=f.toDataURL());this.load(v)}}},{key:"load",value:function(f){var p=this;if(f){this.url=f,this.imageData={};var v=this.element,_=this.options;if(!_.rotatable&&!_.scalable&&(_.checkOrientation=!1),!_.checkOrientation||!window.ArrayBuffer){this.clone();return}if(ku.test(f)){xu.test(f)?this.read(Vu(f)):this.clone();return}var C=new XMLHttpRequest,M=this.clone.bind(this);this.reloading=!0,this.xhr=C,C.onabort=M,C.onerror=M,C.ontimeout=M,C.onprogress=function(){C.getResponseHeader("content-type")!==Do&&C.abort()},C.onload=function(){p.read(C.response)},C.onloadend=function(){p.reloading=!1,p.xhr=null},_.checkCrossOrigin&&Ro(f)&&v.crossOrigin&&(f=Ho(f)),C.open("GET",f,!0),C.responseType="arraybuffer",C.withCredentials=v.crossOrigin==="use-credentials",C.send()}}},{key:"read",value:function(f){var p=this.options,v=this.imageData,_=Gu(f),C=0,M=1,E=1;if(_>1){this.url=Uu(f,Do);var I=Fu(_);C=I.rotate,M=I.scaleX,E=I.scaleY}p.rotatable&&(v.rotate=C),p.scalable&&(v.scaleX=M,v.scaleY=E),this.clone()}},{key:"clone",value:function(){var f=this.element,p=this.url,v=f.crossOrigin,_=p;this.options.checkCrossOrigin&&Ro(p)&&(v||(v="anonymous"),_=Ho(p)),this.crossOrigin=v,this.crossOriginUrl=_;var C=document.createElement("img");v&&(C.crossOrigin=v),C.src=_||p,C.alt=f.alt||"The image to crop",this.image=C,C.onload=this.start.bind(this),C.onerror=this.stop.bind(this),It(C,q),f.parentNode.insertBefore(C,f.nextSibling)}},{key:"start",value:function(){var f=this,p=this.image;p.onload=null,p.onerror=null,this.sizing=!0;var v=B.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(B.navigator.userAgent),_=function(E,I){wt(f.imageData,{naturalWidth:E,naturalHeight:I,aspectRatio:E/I}),f.initialImageData=wt({},f.imageData),f.sizing=!1,f.sized=!0,f.build()};if(p.naturalWidth&&!v){_(p.naturalWidth,p.naturalHeight);return}var C=document.createElement("img"),M=document.body||document.documentElement;this.sizingImage=C,C.onload=function(){_(C.width,C.height),v||M.removeChild(C)},C.src=p.src,v||(C.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",M.appendChild(C))}},{key:"stop",value:function(){var f=this.image;f.onload=null,f.onerror=null,f.parentNode.removeChild(f),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var f=this.element,p=this.options,v=this.image,_=f.parentNode,C=document.createElement("div");C.innerHTML=Mu;var M=C.querySelector(".".concat(F,"-container")),E=M.querySelector(".".concat(F,"-canvas")),I=M.querySelector(".".concat(F,"-drag-box")),D=M.querySelector(".".concat(F,"-crop-box")),L=D.querySelector(".".concat(F,"-face"));this.container=_,this.cropper=M,this.canvas=E,this.dragBox=I,this.cropBox=D,this.viewBox=M.querySelector(".".concat(F,"-view-box")),this.face=L,E.appendChild(v),It(f,G),_.insertBefore(M,f.nextSibling),fe(v,q),this.initPreview(),this.bind(),p.initialAspectRatio=Math.max(0,p.initialAspectRatio)||NaN,p.aspectRatio=Math.max(0,p.aspectRatio)||NaN,p.viewMode=Math.max(0,Math.min(3,Math.round(p.viewMode)))||0,It(D,G),p.guides||It(D.getElementsByClassName("".concat(F,"-dashed")),G),p.center||It(D.getElementsByClassName("".concat(F,"-center")),G),p.background&&It(M,"".concat(F,"-bg")),p.highlight||It(L,Z),p.cropBoxMovable&&(It(L,ot),Yn(L,xt,X)),p.cropBoxResizable||(It(D.getElementsByClassName("".concat(F,"-line")),G),It(D.getElementsByClassName("".concat(F,"-point")),G)),this.render(),this.ready=!0,this.setDragMode(p.dragMode),p.autoCrop&&this.crop(),this.setData(p.data),Vt(p.ready)&&Qt(f,Ao,p.ready,{once:!0}),Cn(f,Ao)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var f=this.cropper.parentNode;f&&f.removeChild(this.cropper),fe(this.element,G)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Ju,d}},{key:"setDefaults",value:function(f){wt(Eo,vn(f)&&f)}}]),d}();return wt(Vo.prototype,ju,Wu,qu,Xu,Zu,Ku),Vo})})(Tl);var b_=Tl.exports;Object.defineProperty(Ll,"__esModule",{value:!0});var C_=b_,w_=k_(C_);function k_(e){return e&&e.__esModule?e:{default:e}}function x_(e,i){var a={};for(var s in e)i.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(e,s)&&(a[s]=e[s]);return a}var S_=typeof window>"u"?[String,Array]:[String,Array,Element,NodeList],M_=Ll.default={render:function(e){var i=this.crossorigin||void 0;return e("div",{style:this.containerStyle},[e("img",{ref:"img",attrs:{src:this.src,alt:this.alt||"image",style:"max-width: 100%",crossorigin:i},on:this.$listeners,style:this.imgStyle})])},props:{containerStyle:Object,src:{type:String,default:""},alt:String,imgStyle:Object,viewMode:Number,dragMode:String,initialAspectRatio:Number,aspectRatio:Number,data:Object,preview:S_,responsive:{type:Boolean,default:!0},restore:{type:Boolean,default:!0},checkCrossOrigin:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},crossorigin:{type:String},modal:{type:Boolean,default:!0},guides:{type:Boolean,default:!0},center:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0},background:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!0},autoCropArea:Number,movable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},scalable:{type:Boolean,default:!0},zoomable:{type:Boolean,default:!0},zoomOnTouch:{type:Boolean,default:!0},zoomOnWheel:{type:Boolean,default:!0},wheelZoomRatio:Number,cropBoxMovable:{type:Boolean,default:!0},cropBoxResizable:{type:Boolean,default:!0},toggleDragModeOnDblclick:{type:Boolean,default:!0},minCanvasWidth:Number,minCanvasHeight:Number,minCropBoxWidth:Number,minCropBoxHeight:Number,minContainerWidth:Number,minContainerHeight:Number,ready:Function,cropstart:Function,cropmove:Function,cropend:Function,crop:Function,zoom:Function},mounted:function(){var e=this.$options.props;e.containerStyle,e.src,e.alt,e.imgStyle;var i=x_(e,["containerStyle","src","alt","imgStyle"]),a={};for(var s in i)this[s]!==void 0&&(a[s]=this[s]);this.cropper=new w_.default(this.$refs.img,a)},methods:{reset:function(){return this.cropper.reset()},clear:function(){return this.cropper.clear()},initCrop:function(){return this.cropper.crop()},replace:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.cropper.replace(e,i)},enable:function(){return this.cropper.enable()},disable:function(){return this.cropper.disable()},destroy:function(){return this.cropper.destroy()},move:function(e,i){return this.cropper.move(e,i)},moveTo:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return this.cropper.moveTo(e,i)},relativeZoom:function(e,i){return this.cropper.zoom(e,i)},zoomTo:function(e,i){return this.cropper.zoomTo(e,i)},rotate:function(e){return this.cropper.rotate(e)},rotateTo:function(e){return this.cropper.rotateTo(e)},scaleX:function(e){return this.cropper.scaleX(e)},scaleY:function(e){return this.cropper.scaleY(e)},scale:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return this.cropper.scale(e,i)},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.cropper.getData(e)},setData:function(e){return this.cropper.setData(e)},getContainerData:function(){return this.cropper.getContainerData()},getImageData:function(){return this.cropper.getImageData()},getCanvasData:function(){return this.cropper.getCanvasData()},setCanvasData:function(e){return this.cropper.setCanvasData(e)},getCropBoxData:function(){return this.cropper.getCropBoxData()},setCropBoxData:function(e){return this.cropper.setCropBoxData(e)},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.cropper.getCroppedCanvas(e)},setAspectRatio:function(e){return this.cropper.setAspectRatio(e)},setDragMode:function(e){return this.cropper.setDragMode(e)}}};const A_=hn("contacts","supportedNetworks"),N_={name:"ContactDetailsAvatar",components:{ActionButton:Ke,ActionLink:ya,Actions:Ze,Avatar:Bn,IconCloudDownload:o_,IconDownload:xa,IconDelete:Pe,IconUpload:Ol,IconFolder:Dl,IconImage:__,NcButton:Ht,VueCropper:M_,NcModal:Je},props:{contact:{type:Object,required:!0},isReadOnly:{type:Boolean,required:!0},reloadBus:{type:Object,required:!0}},data(){return{opened:!1,loading:!1,photoUrl:void 0,root:Jr(`dav/files/${Qr().uid}`),showCropper:!1,cropperOptions:{aspectRatio:1/1,viewMode:3,guides:!1,center:!1,highlight:!1,autoCropArea:1,dragMode:"move",minContainerWidth:100,minContainerHeight:100}}},computed:{supportedSocial(){const e=this.contact.vCard.getAllProperties("email"),i=this.contact.vCard.getAllProperties("x-socialprofile").map(r=>r.jCal[1].type.toString().toLowerCase()),a=this.contact.vCard.getAllProperties("impp").map(r=>r.jCal[1].type.toString().toLowerCase()),s=[].concat(i,a),o=A_.map(r=>r.toLowerCase());return e.length&&s.push("gravatar"),o.filter(r=>s.includes(r)).map(r=>this.capitalize(r))}},watch:{async contact(){await this.loadPhotoUrl()}},async mounted(){await this.loadPhotoUrl()},methods:{onLoad(...e){console.debug(...e)},async processPicture(e){const i=this.getMimetype(e);if(!i.startsWith("image/"))return tt(t("contacts","Please select a valid format")),!1;if(i==="image/svg"){const a=atob(e.toString("base64"));if(!await Pd(a))throw new Error("Unsafe svg image",a)}return this.openCropper(e,i),!0},openCropper(e,i){const a=`data:${i};base64,${e.toString("base64")}`;this.$refs.cropper.replace(a),this.showCropper=!0},handleUploadedFile(e){if(e.target.files&&!this.loading){this.closeMenu();const i=e.target.files[0],a=new FileReader;a.onload=s=>{try{if(typeof s.target.result=="object"){const o=ne.from(s.target.result,"binary");if(this.processPicture(o))return;throw new Error("Wrong image mimetype")}}catch(o){console.error(o),tt(t("contacts","Invalid image"))}finally{this.resetPicker()}},a.readAsArrayBuffer(i)}},resetPicker(){this.$refs.uploadInput.value="",this.loading=!1},capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},getMimetype(e){const i=[];e.slice(0,12).forEach(o=>{i.push(o.toString(16).padStart(2,"0"))});const a=i.join("").toUpperCase(),s=parseInt(window.OC.config.version.split(".")[0]);if(s>=31&&a.slice(0,8)==="52494646"&&a.slice(16,24)==="57454250")return"image/webp";if(s>=32&&a.slice(8,24)==="6674797061766966")return"image/avif";switch(a.slice(0,8)){case"89504E47":return"image/png";case"47494638":return"image/gif";case"3C3F786D":case"3C737667":return"image/svg+xml";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";default:return"application/octet-stream"}},async setPhoto(e,i){if(this.contact.photo&&this.contact.vCard.addPropertyWithValue("photo",""),this.contact.version==="3.0"){this.contact.photo=e;const a=this.contact.vCard.getFirstProperty("photo");a.setParameter("encoding","b"),i&&a.setParameter("type",i.split("/").pop())}else this.contact.photo=`data:${i};base64,${e}`;await this.loadPhotoUrl(),await this.reloadBus.emit("reload-avatar",this.contact.key),this.loading=!1},async loadPhotoUrl(){if(this.photoUrl=void 0,this.contact.photo){const e=await this.contact.getPhotoUrl();if(!e){console.warn("contact has an invalid photo");return}this.photoUrl=e}else this.contact.url&&(this.photoUrl=`${this.contact.url}?photo`)},saveAvatar(){this.showCropper=!1,this.loading=!0,this.$refs.cropper.getCroppedCanvas({minWidth:16,minHeight:16,maxWidth:512,maxHeight:512}).toBlob(async e=>{if(e===null){tt(t("contacts","Error cropping picture")),this.cancel();return}const i=new FileReader;i.readAsDataURL(e),i.onloadend=()=>{const a=i.result;this.setPhoto(a.split(",").pop(),e.type)}})},removePhoto(){this.contact.vCard.removeAllProperties("photo"),this.photoUrl=void 0,this.reloadBus.emit("delete-avatar",this.contact.key)},cancel(){this.showCropper=!1,this.loading=!1},selectFileInput(){this.loading||this.$refs.uploadInput.click()},async selectFilePicker(){if(!this.loading){this.closeMenu();const e=await rc(t("contacts","Pick an avatar")).setMimeTypeFilter(["image/png","image/jpeg","image/gif","image/x-xbitmap","image/bmp","image/svg+xml"]).addButton({label:t("calendar","Pick"),type:"primary",callback:i=>cc.debug("Picked avatar",{nodes:i})}).build().pick();if(e){this.loading=!0;try{const i=await ce.get(`${this.root}${e}`,{responseType:"arraybuffer"}),a=ne.from(i.data,"binary");this.processPicture(a)}catch(i){tt(t("contacts","Error while processing the picture.")),console.error(i),this.loading=!1}finally{this.resetPicker()}}}},async getSocialAvatar(e){if(!this.loading){this.loading=!0;try{if((await ce.put(ga("/apps/contacts/api/v1/social/avatar/{network}/{id}/{uid}",{network:e.toLowerCase(),id:this.contact.addressbook.id,uid:this.contact.uid})))?.status!==200)throw new URIError("Download of social profile avatar failed");await this.$store.dispatch("fetchFullContact",{contact:this.contact,forceReFetch:!0});const i=this.$store.getters.getContact(this.contact.key);await this.$emit("update-local-contact",i),await this.loadPhotoUrl(),await this.reloadBus.emit("reload-avatar",this.contact.key),ac(t("contacts","Avatar downloaded from social network"))}catch(i){i?.response?.status===304?zd(t("contacts","Avatar already up to date")):(tt(t("contacts","Avatar download failed")),console.debug(i))}}this.loading=!1},closeMenu(){this.opened=!1}}};var O_=function(){var e=this,i=e._self._c;return i("div",{staticClass:"contact-header-avatar__wrapper"},[i("input",{ref:"uploadInput",staticClass:"hidden",attrs:{id:"contact-avatar-upload",type:"file",accept:"image/*"},on:{change:e.handleUploadedFile}}),e.contact.addressbook.id==="z-server-generated--system"?i("Avatar",{staticClass:"contact-header-avatar__photo",attrs:{"disable-menu":"","show-user-status":!1,user:e.contact.uid,size:75}}):i("Avatar",{staticClass:"contact-header-avatar__photo",attrs:{"disable-tooltip":!0,"display-name":e.contact.displayName,"is-no-user":!0,size:75,url:e.photoUrl}}),i("NcModal",{attrs:{show:e.showCropper,size:"small"},on:{"update:show":function(a){e.showCropper=a},close:e.cancel}},[i("div",{staticClass:"avatar__container"},[i("h2",[e._v(e._s(e.t("contacts","Crop contact photo")))]),i("VueCropper",e._b({ref:"cropper",staticClass:"avatar__cropper"},"VueCropper",e.cropperOptions,!1)),i("div",{staticClass:"avatar__cropper-buttons"},[i("NcButton",{attrs:{type:"tertiary"},on:{click:e.cancel}},[e._v(" "+e._s(e.t("contacts","Cancel"))+" ")]),i("NcButton",{attrs:{type:"primary"},on:{click:e.saveAvatar}},[e._v(" "+e._s(e.t("contacts","Save"))+" ")])],1)],1)]),e.isReadOnly?e._e():i("Actions",{staticClass:"contact-header-avatar__menu",attrs:{"force-menu":!0,open:e.opened},on:{"update:open":function(a){e.opened=a}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconImage",{attrs:{size:20,"fill-color":"#fff"}})]},proxy:!0}],null,!1,1819936392)},[i("ActionButton",{attrs:{"close-after-click":!0},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.selectFileInput.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconUpload",{attrs:{size:20}})]},proxy:!0}],null,!1,337456192)},[e._v(" "+e._s(e.t("contacts","Upload a new picture"))+" ")]),i("ActionButton",{attrs:{"close-after-click":!0},on:{click:e.selectFilePicker},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconFolder",{attrs:{size:20}})]},proxy:!0}],null,!1,2686820117)},[e._v(" "+e._s(e.t("contacts","Choose from Files"))+" ")]),e._l(e.supportedSocial,function(a){return i("ActionButton",{key:a,attrs:{"close-after-click":!0},on:{click:function(s){return e.getSocialAvatar(a)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCloudDownload",{attrs:{size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(e.t("contacts","Get from "+a))+" ")])}),e.contact.photo?[i("ActionLink",{attrs:{href:`${e.contact.url}?photo`,target:"_blank","close-after-click":!0},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDownload",{attrs:{size:20}})]},proxy:!0}],null,!1,2487097783)},[e._v(" "+e._s(e.t("contacts","Download picture"))+" ")]),i("ActionButton",{attrs:{"close-after-click":!0},on:{click:e.removePhoto},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)},[e._v(" "+e._s(e.t("contacts","Delete picture"))+" ")])]:e._e()],2)],1)},D_=[],L_=H(N_,O_,D_,!1,null,"ab827d75");const T_=L_.exports,E_={name:"DetailsHeader",components:{Actions:Ze},data(){return{avatarSize:75}},computed:{cssStyle(){return{"--avatar-size":this.avatarSize+"px"}}}};var I_=function(){var e=this,i=e._self._c;return i("header",{staticClass:"contact-header",style:e.cssStyle},[i("div",{staticClass:"contact-header__no-wrap"},[i("div",{staticClass:"contact-header__avatar"},[e._t("avatar",null,{avatarSize:e.avatarSize})],2),i("div",{staticClass:"contact-header__infos"},[i("h2",{staticClass:"contact-header__infos-title"},[e._t("title")],2),e.$slots.subtitle?i("div",{staticClass:"contact-header__infos-subtitle"},[e._t("subtitle")],2):e._e(),i("div",{staticClass:"contact-header__quick-actions"},[e._t("quick-actions")],2)])]),i("div",{staticClass:"contact-header__actions"},[e._t("actions"),i("Actions",e._b({ref:"actions",staticClass:"header-menu",attrs:{"menu-align":"right"}},"Actions",e.$attrs,!1),[e._t("actions-menu")],2)],2)])},P_=[],z_=H(E_,I_,P_,!1,null,"8f867b07");const B_=z_.exports,$_=[];function Di(e){return e>=48&&e<=57}function R_(e,i,a){if(typeof e!="string")throw new TypeError(`The first argument must be a string. Received type '${typeof e}'`);if(typeof i!="string")throw new TypeError(`The second argument must be a string. Received type '${typeof i}'`);const s=e.length,o=i.length;let r=0,c=0,l=$_,h=0;for(a&&(a.caseInsensitive&&(e=e.toLowerCase(),i=i.toLowerCase()),a.alphabet&&(l=H_(a.alphabet)));r<s&&c<o;){let u=e.charCodeAt(r),m=i.charCodeAt(c);if(Di(u)){if(!Di(m))return u-m;let g=r,b=c;for(;u===48&&++g<s;)u=e.charCodeAt(g);for(;m===48&&++b<o;)m=i.charCodeAt(b);g!==b&&h===0&&(h=g-b);let k=g,A=b;for(;k<s&&Di(e.charCodeAt(k));)++k;for(;A<o&&Di(i.charCodeAt(A));)++A;let T=k-g-A+b;if(T!==0)return T;for(;g<k;)if(T=e.charCodeAt(g++)-i.charCodeAt(b++),T!==0)return T;r=k,c=A;continue}if(u!==m)return u<l.length&&m<l.length&&l[u]!==-1&&l[m]!==-1?l[u]-l[m]:u-m;++r,++c}return r<s?1:c<o?-1:h}const Nr={};function H_(e){const i=Nr[e];if(i!==void 0)return i;const a=[],s=e.split("").reduce((o,r)=>Math.max(o,r.charCodeAt(0)),0);for(let o=0;o<=s;o++)a.push(-1);for(let o=0;o<e.length;o++)a[e.charCodeAt(o)]=o;return Nr[e]=a,a}var Y_=R_;const Ss=ma(Y_),V_={name:"PropertyGroups",components:{PropertyTitle:Bd,NcSelect:fn},props:{propModel:{type:Object,default:()=>{},required:!0},value:{type:Array,default:()=>[],required:!0},contact:{type:Us,default:null,required:!0},isReadOnly:{type:Boolean,required:!0}},data(){return{localValue:[...this.value].sort()}},computed:{showAsText(){return this.isReadOnly&&this.localValue.length<=1},showProperty(){return this.isReadOnly&&this.localValue.length>0||!this.isReadOnly},groups(){return this.$store.getters.getGroups.slice(0).map(e=>e.name).sort((e,i)=>Ss(e,i,{caseInsensitive:!0}))},formatGroupsTitle(){return this.localValue.slice(3).join(", ")}},watch:{value(){this.localValue=this.value},selectType(){this.localType=this.selectType}},methods:{updateValue(){this.$emit("update:value",this.localValue)}}};var U_=function(){var e=this,i=e._self._c;return e.propModel&&e.showProperty?i("div",{staticClass:"property"},[i("PropertyTitle",{attrs:{icon:"icon-contacts-dark","readable-name":e.t("contacts","Contact groups"),"is-read-only":e.isReadOnly}}),i("div",{staticClass:"property__row"},[i("div",{staticClass:"property__label"},[i("span",[e._v(e._s(e.propModel.readableName))])]),i("div",{staticClass:"property__value"},[e.isReadOnly?i("div",[e.localValue.length===0?i("span",[e._v(e._s(e.t("contacts","None")))]):i("div",{staticClass:"group__list"},e._l(e.localValue,function(a,s){return i("span",{key:s},[e._v(" "+e._s(a)+e._s(s===e.localValue.length-1?"":", ")+" ")])}),0)]):i("NcSelect",{attrs:{options:e.groups,"no-wrap":!0,placeholder:e.t("contacts","Add contact in group"),multiple:!0,"close-on-select":!1,clearable:!0,"deselect-from-dropdown":!0,taggable:!0,"tag-placeholder":"create"},on:{"option:deselected":e.updateValue,close:e.updateValue},scopedSlots:e._u([{key:"limit",fn:function(){return[i("span",{directives:[{name:"tooltip",rawName:"v-tooltip.auto",value:e.formatGroupsTitle,expression:"formatGroupsTitle",modifiers:{auto:!0}}],staticClass:"multiselect__limit"},[e._v(" +"+e._s(e.localValue.length-3)+" ")])]},proxy:!0},{key:"no-options",fn:function(){return[i("span",[e._v(e._s(e.t("contacts","No results")))])]},proxy:!0}],null,!1,2766193613),model:{value:e.localValue,callback:function(a){e.localValue=a},expression:"localValue"}})],1),i("div",{staticClass:"property__actions"})])],1):e._e()},G_=[],F_=H(V_,U_,G_,!1,null,"3ecbedb4");const j_=F_.exports,W_={name:"PropertyRev",props:{value:{type:Object,required:!0}},computed:{relativeDate(){return $d.unix(this.value.toUnixTime()).fromNow()}}};var q_=function(){var e=this,i=e._self._c;return i("div",{staticClass:"property property--rev"},[i("div",{staticClass:"property__row"},[i("div",{staticClass:"property__label"}),i("div",{staticClass:"property__value"},[e._v(" "+e._s(e.t("contacts","Last modified"))+" "+e._s(e.relativeDate)+" ")]),i("div",{staticClass:"property__actions"})])])},X_=[],Z_=H(W_,q_,X_,!1,null,"cdb3abf5");const K_=Z_.exports,J_=hn("contacts","isTalkEnabled",!1),{profileEnabled:Q_}=hn("user_status","profileEnabled",!1),tb={name:"ContactDetails",components:{Actions:Ze,ActionButton:Ke,ActionLink:ya,AddNewProp:e_,AppContentDetails:dh,ContactAvatar:T_,ContactDetailsProperty:lc,DetailsHeader:B_,EmptyContent:Xe,IconContact:mn,IconMail:uc,IconMessage:Rd,IconCall:Hd,IconAccount:ai,IconDownload:xa,IconDelete:Pe,IconQr:C2,CakeIcon:M2,IconCopy:oc,IconLoading:Jt,PencilIcon:Vs,CheckIcon:Nl,Modal:Je,NcSelect:fn,PropertyGroups:j_,PropertyRev:K_,PropertySelect:Yd,NcButton:Ht,NcRelatedResourcesPanel:gd,NcEmptyContent:Xe,FolderMultipleImage:H2},mixins:[va],provide(){return{sharedState:this.sharedState}},props:{contactKey:{type:String,default:void 0},contacts:{type:Array,default:()=>[]},reloadBus:{type:Object,required:!0},desc:{type:String,required:!1,default:""}},data(){return{fixed:!1,localContact:void 0,loadingData:!0,loadingUpdate:!1,qrcode:"",showPickAddressbookModal:!1,pickedAddressbook:null,editMode:!1,newGroupsValue:[],newAddressBook:null,contactDetailsSelector:".contact-details",excludeFromBirthdayKey:"x-nc-exclude-from-birthday-calendar",bus:Gs(),showMenuPopover:!1,profileEnabled:Q_,isTalkEnabled:J_,hasFilesResources:!1,hasTalkResources:!1,hasCalendarResources:!1,hasDeckResources:!1,deckPanelHasError:!1,filesPanelHasError:!1,talkPanelHasError:!1,calendarPanelHasError:!1,sharedState:Yt.observable({validEmail:!0})}},computed:{hasRelatedResources(){return this.hasFilesResources||this.hasTalkResources||this.hasCalendarResources||this.hasDeckResources},addressbookIsReadOnly(){return this.contact.addressbook?.readOnly},isReadOnly(){return this.addressbookIsReadOnly||!this.editMode},isDataValid(){return this.sharedState.validEmail},warning(){return this.addressbookIsReadOnly?{icon:P2,classes:[],msg:t("contacts","This contact is in read-only mode. You do not have permission to edit this contact.")}:!1},conflict(){return this.contact.conflict?t("contacts","The contact you were trying to edit has changed. Please manually refresh the contact. Any further edits will be discarded."):!1},sortedProperties(){return this.localContact.properties.slice(0).sort((e,i)=>{const a=e.name.split(".").pop(),s=i.name.split(".").pop();return ve.fieldOrder.indexOf(a)-ve.fieldOrder.indexOf(s)})},groupedProperties(){return this.sortedProperties.reduce((e,i)=>this.canDisplay(i)?i.name==="bday"||i.name==="deathdate"||i.name==="anniversary"?(e.lifeEvents||(e.lifeEvents=[]),e.lifeEvents.push(i),e):(e[i.name]||(e[i.name]=[]),e[i.name].push(i),e):e,{})},addressbookModel(){return{readableName:t("contacts","Address book"),icon:"icon-address-book",options:this.addressbooksOptions}},addressbook(){return this.contact.addressbook.id},groupsModel(){return{readableName:t("contacts","Contact groups"),icon:"icon-contacts-dark"}},addressbooksOptions(){return this.addressbooks.filter(e=>e.enabled).map(e=>({id:e.id,name:e.displayName,readOnly:e.readOnly}))},copyableAddressbooksOptions(){return this.addressbooksOptions.filter(e=>!e.readOnly).filter(e=>e.id!==this.contact.addressbook.id).map(e=>({id:e.id,name:e.name}))},addressbooks(){return this.$store.getters.getAddressbooks},contact(){return this.$store.getters.getContact(this.contactKey)},excludeFromBirthdayLabel(){return this.localContact.vCard.hasProperty(this.excludeFromBirthdayKey)?t("contacts","Add contact to Birthday Calendar"):t("contacts","Exclude contact from Birthday Calendar")},enableToggleBirthdayExclusion(){return parseInt(window.OC.config.version.split(".")[0])>=26&&this.localContact?.vCard},formattedSubtitle(){const e=this.contact.title,i=this.contact.org;return e&&i?t("contacts","{title} at {organization}",{title:e,organization:i}):e?qo(e):i?qo(i):""},profilePageLink(){return this.contact.socialLink("NEXTCLOUD")},emailAddressProperties(){return this.localContact.properties.find(e=>e.name==="email")},emailAddress(){return this.emailAddressProperties?.getFirstValue()},phoneNumberProperties(){return this.localContact.properties.find(e=>e.name==="tel")},phoneNumberList(){return this.groupedProperties?.tel?.map(e=>e.getFirstValue()).filter(e=>!!e)},emailAddressList(){return this.groupedProperties?.email?.map(e=>e.getFirstValue()).filter(e=>!!e)},callUrl(){return ga("/apps/spreed/?callUser={uid}",{uid:this.contact.uid})},isInSystemAddressBook(){return this.contact.addressbook.id==="z-server-generated--system"},nextcloudVersionAtLeast28(){return parseInt(window.OC.config.version.split(".")[0])>=28}},watch:{contact(e,i){this.contactKey&&e!==i&&this.selectContact(this.contactKey)}},beforeMount(){this.contactKey&&this.selectContact(this.contactKey),document.addEventListener("keydown",this.onCtrlSave)},beforeDestroy(){document.removeEventListener("keydown",this.onCtrlSave)},methods:{updateGroups(e){this.newGroupsValue=e},updateAddressbook(e){this.newAddressBook=e},async updateContact(){this.fixed=!1,this.loadingUpdate=!0;try{await this.$store.dispatch("updateContact",this.localContact)}finally{this.loadingUpdate=!1}if(!this.localContact.dav){this.logger.debug("New contact synced!",{localContact:this.localContact});const e=this.$store.getters.getContact(this.localContact.key);await this.updateLocalContact(e)}},async showQRcode(){const e=this.contact.jCal.slice(0);e[1]=e[1].filter(a=>a[0]!=="photo");const i=Rs.stringify(e);if(i.length>0){const a=await c2(i),s=new TextDecoder().decode(a);this.qrcode=btoa(s)}},async toggleBirthdayExclusionForContact(){this.localContact.vCard.hasProperty(this.excludeFromBirthdayKey)?this.localContact.vCard.removeProperty(this.excludeFromBirthdayKey):this.localContact.vCard.addPropertyWithValue(this.excludeFromBirthdayKey,!0),await this.updateContact()},selectInput(){this.$refs.fullname&&this.$refs.fullname.value===t("contacts","Name")&&this.$refs.fullname.select()},async selectContact(e){this.loadingData=!0,this.editMode=!1;const i=this.$store.getters.getContact(e);if(i)if(i.dav)try{await this.$store.dispatch("fetchFullContact",{contact:i}),await this.updateLocalContact(i)}catch(a){a.name==="ParserError"?tt(t("contacts","Syntax error. Cannot open the contact.")):a?.status===404?tt(t("contacts","The contact does not exist on the server anymore.")):tt(t("contacts","Unable to retrieve the contact from the server, please check your network connection.")),console.error(a),this.$store.dispatch("deleteContact",{contact:this.contact,dav:!1})}else await this.updateLocalContact(i),this.editMode=!0;this.loadingData=!1},deleteContact(){this.$store.dispatch("deleteContact",{contact:this.contact})},async moveContactToAddressbook(e){const i=this.addressbooks.find(a=>a.id===e);if(this.loadingUpdate=!0,i)try{const a=await this.$store.dispatch("moveContactToAddressbook",{contact:this.contact,addressbook:i});this.$router.push({name:"contact",params:{selectedGroup:this.$route.params.selectedGroup,selectedContact:a.key}})}catch(a){console.error(a),tt(t("contacts","An error occurred while trying to move the contact"))}finally{this.loadingUpdate=!1}},async copyContactToAddressbook(e){const i=this.addressbooks.find(a=>a.id===e);if(this.loadingUpdate=!0,i)try{const a=await this.$store.dispatch("copyContactToAddressbook",{contact:this.contact,addressbook:i});this.$router.push({name:"contact",params:{selectedGroup:this.$route.params.selectedGroup,selectedContact:a.key}})}catch(a){console.error(a),tt(t("contacts","An error occurred while trying to copy the contact"))}finally{this.loadingUpdate=!1}},refreshContact(){this.$store.dispatch("fetchFullContact",{contact:this.contact,etag:this.conflict}).then(()=>{this.contact.conflict=!1})},closeQrModal(){this.qrcode=""},async updateLocalContact(e){const i=Object.assign(Object.create(Object.getPrototypeOf(e)),e);this.fixed=Vd(i),this.localContact=i,this.newGroupsValue=[...this.localContact.groups]},onCtrlSave(e){this.editMode&&e.keyCode===83&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),this.onSave())},async cloneContact(){this.pickedAddressbook&&this.addressbooks.find(e=>e.id===this.pickedAddressbook.id)?(this.logger.debug("Cloning contact to",{name:this.pickedAddressbook.name}),await this.copyContactToAddressbook(this.pickedAddressbook.id),this.closePickAddressbookModal()):this.addressbooksOptions.length===1?(this.logger.debug("Cloning contact to",{name:this.addressbooksOptions[0].name}),await this.copyContactToAddressbook(this.addressbooksOptions[0].id)):this.showPickAddressbookModal=!0},closePickAddressbookModal(){this.showPickAddressbookModal=!1,this.pickedAddressbook=null},canDisplay(e){const i=ve.properties[e.name.split(".").pop()],a=i&&i.force?i.force:e.getDefaultType();return i&&a!=="unknown"},async onSave(){try{this.localContact.groups=[...this.newGroupsValue],await this.$store.dispatch("updateContactGroups",{groupNames:this.newGroupsValue,contact:this.contact}),await this.updateContact(),this.newAddressBook&&this.newAddressBook!==this.contact.addressbook.id&&(this.moveContactToAddressbook(this.newAddressBook),this.newAddressBook=null),this.editMode=!1}catch(e){this.logger.error("error while saving contact",{error:e}),tt(t("contacts","Unable to update contact"))}}}};var eb=function(){var e=this,i=e._self._c;return i("AppContentDetails",[e.contact?[i("DetailsHeader",{scopedSlots:e._u([{key:"avatar",fn:function(){return[i("ContactAvatar",{attrs:{contact:e.contact,"is-read-only":e.isReadOnly,"reload-bus":e.reloadBus},on:{"update-local-contact":e.updateLocalContact}})]},proxy:!0},{key:"title",fn:function(){return[e.isReadOnly?i("div",{staticClass:"contact-title"},[e._v(" "+e._s(e.contact.fullName)+" ")]):i("input",{directives:[{name:"model",rawName:"v-model",value:e.contact.fullName,expression:"contact.fullName"}],ref:"fullname",attrs:{id:"contact-fullname",placeholder:e.t("contacts","Name"),type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",name:"fullname"},domProps:{value:e.contact.fullName},on:{click:e.selectInput,input:function(a){a.target.composing||e.$set(e.contact,"fullName",a.target.value)}}})]},proxy:!0},{key:"subtitle",fn:function(){return[e.isReadOnly?[i("span",{domProps:{innerHTML:e._s(e.formattedSubtitle)}})]:[i("input",{directives:[{name:"model",rawName:"v-model",value:e.contact.title,expression:"contact.title"}],attrs:{id:"contact-title",placeholder:e.t("contacts","Title"),type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",name:"title"},domProps:{value:e.contact.title},on:{input:function(a){a.target.composing||e.$set(e.contact,"title",a.target.value)}}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.contact.org,expression:"contact.org"}],attrs:{id:"contact-org",placeholder:e.t("contacts","Company"),type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false",name:"org"},domProps:{value:e.contact.org},on:{input:function(a){a.target.composing||e.$set(e.contact,"org",a.target.value)}}})]]},proxy:!0},{key:"quick-actions",fn:function(){return[!e.editMode&&!e.loadingData?i("div",[i("Actions",{attrs:{inline:6,type:"secondary"}},[e.isTalkEnabled&&e.isInSystemAddressBook?i("ActionButton",{staticClass:"icon-talk quick-action",attrs:{"aria-label":e.t("contacts","Go to talk conversation"),name:e.t("contacts","Go to talk conversation"),href:e.callUrl}}):e._e(),e.profilePageLink?i("ActionButton",{staticClass:"quick-action",attrs:{"aria-label":e.t("contacts","View profile"),name:e.t("contacts","View profile"),href:e.profilePageLink},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAccount",{attrs:{size:20}})]},proxy:!0}],null,!1,1136206178)}):e._e(),e._l(e.emailAddressList,function(a){return i("ActionLink",{key:a,staticClass:"quick-action",attrs:{href:"mailto:"+a},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconMail",{attrs:{size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(a)+" ")])}),e._l(e.phoneNumberList,function(a){return i("ActionLink",{key:a,staticClass:"quick-action",attrs:{href:"tel:"+a},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCall",{attrs:{size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(a)+" ")])})],2)],1):e._e()]},proxy:!0},{key:"actions",fn:function(){return[e.warning?i(e.warning.icon,{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:{content:e.warning?e.warning.msg:"",trigger:"hover focus"},expression:`{
						content: warning ? warning.msg : '',
						trigger: 'hover focus'
					}`,modifiers:{bottom:!0}}],tag:"component",staticClass:"header-icon",attrs:{classes:e.warning.classes}}):e._e(),e.conflict?i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.conflict,show:!0,trigger:"manual"},expression:`{
						content: conflict,
						show: true,
						trigger: 'manual',
					}`}],staticClass:"header-icon header-icon--pulse icon-history",on:{click:e.refreshContact}}):e._e(),e.fixed?i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.t("contacts","This contact was broken and received a fix. Please review the content and click here to save it."),show:!0,trigger:"manual"},expression:`{
						content: t('contacts', 'This contact was broken and received a fix. Please review the content and click here to save it.'),
						show: true,
						trigger: 'manual',
					}`}],staticClass:"header-icon header-icon--pulse icon-up",on:{click:e.updateContact}}):e._e(),e.addressbookIsReadOnly?e._e():[e.editMode?i("NcButton",{attrs:{type:"secondary",disabled:e.loadingUpdate||!e.isDataValid},on:{click:e.onSave},scopedSlots:e._u([{key:"icon",fn:function(){return[e.loadingUpdate?i("IconLoading",{attrs:{size:20}}):i("CheckIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,3908750157)},[e._v(" "+e._s(e.t("contacts","Save"))+" ")]):i("NcButton",{attrs:{type:e.isMobile?"secondary":"tertiary"},on:{click:function(a){e.editMode=!0}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("PencilIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,4260349822)},[e._v(" "+e._s(e.t("contacts","Edit"))+" ")])]]},proxy:!0},{key:"actions-menu",fn:function(){return[i("ActionLink",{attrs:{href:e.contact.url,download:`${e.contact.displayName}.vcf`},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDownload",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Download"))+" ")]),e.isReadOnly&&e.addressbooksOptions.length>0?i("ActionButton",{ref:"cloneAction",attrs:{"close-after-click":!0},on:{click:e.cloneContact},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCopy",{attrs:{size:20}})]},proxy:!0}],null,!1,1700567014)},[e._v(" "+e._s(e.t("contacts","Clone contact"))+" ")]):e._e(),i("ActionButton",{attrs:{"close-after-click":!0},on:{click:e.showQRcode},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconQr",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Generate QR Code"))+" ")]),e.enableToggleBirthdayExclusion?i("ActionButton",{attrs:{"close-after-click":!0},on:{click:e.toggleBirthdayExclusionForContact},scopedSlots:e._u([{key:"icon",fn:function(){return[i("CakeIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,1060251055)},[e._v(" "+e._s(e.excludeFromBirthdayLabel)+" ")]):e._e(),e.addressbookIsReadOnly?e._e():i("ActionButton",{on:{click:e.deleteContact},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)},[e._v(" "+e._s(e.t("contacts","Delete"))+" ")])]},proxy:!0}])}),e.qrcode?i("Modal",{attrs:{id:"qrcode-modal",size:"small","clear-view-delay":-1,name:e.contact.displayName,"close-button-contained":!1},on:{close:e.closeQrModal}},[i("img",{staticClass:"qrcode",attrs:{src:`data:image/svg+xml;base64,${e.qrcode}`,alt:e.t("contacts","Contact vCard as QR code"),width:"400"}})]):e._e(),e.showPickAddressbookModal?i("Modal",{attrs:{id:"pick-addressbook-modal","clear-view-delay":-1,name:e.t("contacts","Pick an address book")},on:{close:e.closePickAddressbookModal}},[i("NcSelect",{ref:"pickAddressbook",staticClass:"address-book",attrs:{"allow-empty":!1,options:e.copyableAddressbooksOptions,placeholder:e.t("contacts","Select address book"),"track-by":"id",label:"name"},model:{value:e.pickedAddressbook,callback:function(a){e.pickedAddressbook=a},expression:"pickedAddressbook"}}),i("button",{on:{click:e.closePickAddressbookModal}},[e._v(" "+e._s(e.t("contacts","Cancel"))+" ")]),i("button",{staticClass:"primary",on:{click:e.cloneContact}},[e._v(" "+e._s(e.t("contacts","Clone contact"))+" ")])],1):e._e(),e.loadingData?i("IconLoading",{staticClass:"contact-details",attrs:{size:20}}):e.loadingData?e._e():i("div",{staticClass:"contact-details-wrapper"},[i("section",{staticClass:"contact-details"},[e.name==="lifeEvents"?i("div",{staticClass:"life-events-group"},e._l(e.properties,function(a,s){return i("ContactDetailsProperty",{key:`${s}-${e.contact.key}-${a.name}`,attrs:{"is-first-property":s===0,"is-last-property":s===e.properties.length-1,property:a,contact:e.contact,"local-contact":e.localContact,contacts:e.contacts,bus:e.bus,"is-read-only":e.isReadOnly}})}),1):e._e(),e._l(e.groupedProperties,function(a,s){return i("div",{key:s},e._l(a,function(o,r){return i("ContactDetailsProperty",{key:`${r}-${e.contact.key}-${o.name}`,attrs:{"is-first-property":r===0,"is-last-property":r===a.length-1,property:o,contact:e.contact,"local-contact":e.localContact,contacts:e.contacts,bus:e.bus,"is-read-only":e.isReadOnly}})}),1)})],2),i("PropertySelect",{staticClass:"property--addressbooks property--last",attrs:{"prop-model":e.addressbookModel,options:e.addressbooksOptions,value:e.addressbook,"is-first-property":!0,"is-last-property":!0,property:{},"hide-actions":!0,"is-read-only":e.isReadOnly},on:{"update:value":e.updateAddressbook}}),i("PropertyGroups",{staticClass:"property--groups property--last",attrs:{"prop-model":e.groupsModel,value:e.localContact.groups,contact:e.contact,"is-read-only":e.isReadOnly},on:{"update:value":[function(a){return e.$set(e.localContact,"groups",a)},e.updateGroups]}})],1),e.nextcloudVersionAtLeast28&&!e.editMode?i("div",{staticClass:"related-resources"},[e.filesPanelHasError?e._e():i("NcRelatedResourcesPanel",{attrs:{"provider-id":"account","resource-type":"files",description:e.desc,limit:5,header:e.t("contacts","Media shares with you"),"item-id":e.contact.uid,primary:!0},on:{"has-resources":a=>e.hasFilesResources=a,"has-error":a=>e.filesPanelHasError=a}}),e.talkPanelHasError?e._e():i("NcRelatedResourcesPanel",{attrs:{"provider-id":"account","resource-type":"talk",description:e.desc,limit:5,header:e.t("contacts","Talk conversations with you"),"item-id":e.contact.uid,primary:!0},on:{"has-resources":a=>e.hasTalkResources=a,"has-error":a=>e.talkPanelHasError=a}}),e.calendarPanelHasError?e._e():i("NcRelatedResourcesPanel",{attrs:{"provider-id":"account","resource-type":"calendar",description:e.desc,limit:5,header:e.t("contacts","Calendar events with you"),"item-id":e.contact.uid,primary:!0},on:{"has-resources":a=>e.hasCalendarResources=a,"has-error":a=>e.calendarPanelHasError=a}}),e.deckPanelHasError?e._e():i("NcRelatedResourcesPanel",{attrs:{"provider-id":"account","resource-type":"deck",description:e.desc,limit:5,header:e.t("contacts","Deck cards with you"),"item-id":e.contact.uid,primary:!0},on:{"has-resources":a=>e.hasDeckResources=a,"has-error":a=>e.deckPanelHasError=a}}),!e.hasRelatedResources&&!e.loadingData?i("NcEmptyContent",{attrs:{name:e.t("contacts","No shared items with this contact")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("FolderMultipleImage",{attrs:{size:20}})]},proxy:!0}],null,!1,3645725449)}):e._e()],1):e._e(),e.isReadOnly?e._e():i("AddNewProp",{staticClass:"last-edit",attrs:{bus:e.bus,contact:e.contact}}),e.contact.rev?i("PropertyRev",{staticClass:"last-edit",attrs:{value:e.contact.rev}}):e._e()]:i("EmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","No contact selected"),description:e.t("contacts","Select a contact on the list to begin")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0}],null,!1,3494319139)})],2)},nb=[],ib=H(tb,eb,nb,!1,null,"11311a1c");const ab=ib.exports,sb={name:"ContactsListItem",mixins:[Qe],components:{ListItem:mc,NcAvatar:Bn,CheckIcon:Nl},props:{index:{type:Number,required:!0},source:{type:Object,required:!0},reloadBus:{type:Object,required:!0},onSelectMultipleFromParent:{type:Function,default:()=>{}}},data(){return{avatarUrl:void 0,hoveringAvatar:!1}},computed:{isDraggable(){return!!this.source.dav&&this.source.addressbook.id!=="z-server-generated--system"},id(){return this.source.key.slice(0,-2)},getTel(){return this.source.properties.find(e=>e.name==="tel")?.getFirstValue()}},created(){this.reloadBus.on("reload-avatar",this.reloadAvatarUrl),this.reloadBus.on("delete-avatar",this.deleteAvatar)},destroyed(){this.reloadBus.off("reload-avatar",this.reloadAvatarUrl),this.reloadBus.off("delete-avatar",this.deleteAvatar)},async mounted(){await this.loadAvatarUrl()},methods:{startDrag(e,i){e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("item",JSON.stringify({addressbookId:i.addressbook.id,displayName:i.displayName,groups:i.groups,url:i.url,uid:i.uid}))},reloadAvatarUrl(e){e===this.source.key&&this.loadAvatarUrl()},deleteAvatar(e){e===this.source.key&&(this.avatarUrl=void 0)},async loadAvatarUrl(){if(this.avatarUrl=void 0,this.source.photo){const e=await this.source.getPhotoUrl();if(!e){console.warn("contact has an invalid photo");return}this.avatarUrl=e}else this.source.hasPhoto&&this.source.url&&(this.avatarUrl=`${this.source.url}?photo`)},selectContact(){this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:this.source.key}})},onSelectMultiple(){this.onSelectMultipleFromParent(this.source,this.index)},onSelectMultipleRange(){this.onSelectMultipleFromParent(this.source,this.index,!0)}}};var ob=function(){var e=this,i=e._self._c;return i("div",{staticClass:"contacts-list__item-wrapper",attrs:{draggable:e.isDraggable},on:{dragstart:function(a){return e.startDrag(a,e.source)},click:function(a){return!a.shiftKey||a.ctrlKey||a.altKey||a.metaKey?null:(a.preventDefault(),e.onSelectMultipleRange.apply(null,arguments))}}},[i("ListItem",{key:e.source.key,staticClass:"list-item-style envelope",attrs:{id:e.id,name:e.source.displayName,to:{name:"contact",params:{selectedGroup:e.selectedGroup,selectedContact:e.source.key}}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("div",{staticClass:"contacts-list__item-icon",on:{click:function(a){return a.ctrlKey||a.shiftKey||a.altKey||a.metaKey?null:(a.preventDefault(),e.onSelectMultiple.apply(null,arguments))},mouseenter:function(a){e.hoveringAvatar=!0},mouseleave:function(a){e.hoveringAvatar=!1}}},[!e.source.isMultiSelected&&!e.hoveringAvatar&&e.source.addressbook.id==="z-server-generated--system"?i("NcAvatar",{attrs:{user:e.source.uid,"show-user-status":!1,size:40}}):e._e(),!e.source.isMultiSelected&&!e.hoveringAvatar&&e.source.addressbook.id!=="z-server-generated--system"?i("NcAvatar",{attrs:{"display-name":e.source.displayName,url:e.avatarUrl,size:40}}):e._e(),e.source.isMultiSelected||e.hoveringAvatar?i("CheckIcon",{class:{"contacts-list__item-avatar-selected":e.source.isMultiSelected,"contacts-list__item-avatar-hovered":!e.source.isMultiSelected},attrs:{size:28}}):e._e()],1)]},proxy:!0},{key:"subname",fn:function(){return[i("div",{staticClass:"envelope__subtitle"},[i("span",{staticClass:"envelope__subtitle__subject"},[e._v(" "+e._s(e.source.email?e.source.email:e.getTel)+" ")])])]},proxy:!0}])})],1)},rb=[],cb=H(sb,ob,rb,!1,null,"c17616de");const lb=cb.exports,ub={name:"CloseThickIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var db=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon close-thick-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M20 6.91L17.09 4L12 9.09L6.91 4L4 6.91L9.09 12L4 17.09L6.91 20L12 14.91L17.09 20L20 17.09L14.91 12L20 6.91Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},hb=[],pb=H(ub,db,hb,!1,null,null);const fb=pb.exports,mb={name:"SetMergeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var gb=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon set-merge-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M2 7V9H7V7H2M12 9V11H9V13H12V15L15 12L12 9M17 9V15H22V9H17M2 11V13H7V11H2M2 15V17H7V15H2Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},yb=[],vb=H(mb,gb,yb,!1,null,null);const El=vb.exports,_b={name:"CheckCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var bb=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon check-circle-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M12 20C7.59 20 4 16.41 4 12S7.59 4 12 4 20 7.59 20 12 16.41 20 12 20M16.59 7.58L10 14.17L7.41 11.59L6 13L10 17L18 9L16.59 7.58Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Cb=[],wb=H(_b,bb,Cb,!1,null,null);const kb=wb.exports,xb={name:"CloseCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Sb=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon close-circle-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M14.59,8L12,10.59L9.41,8L8,9.41L10.59,12L8,14.59L9.41,16L12,13.41L14.59,16L16,14.59L13.41,12L16,9.41L14.59,8Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Mb=[],Ab=H(xb,Sb,Mb,!1,null,null);const Nb=Ab.exports,Ob={name:"DomainIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Db=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon domain-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M18,15H16V17H18M18,11H16V13H18M20,19H12V17H14V15H12V13H14V11H12V9H20M10,7H8V5H10M10,11H8V9H10M10,15H8V13H10M10,19H8V17H10M6,7H4V5H6M6,11H4V9H6M6,15H4V13H6M6,19H4V17H6M12,7V3H2V21H22V7H12Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Lb=[],Tb=H(Ob,Db,Lb,!1,null,null);const Or=Tb.exports,Eb={name:"BadgeAccountOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ib=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon badge-account-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M17,3H14V5H17V21H7V5H10V3H7A2,2 0 0,0 5,5V21A2,2 0 0,0 7,23H17A2,2 0 0,0 19,21V5A2,2 0 0,0 17,3M12,7A2,2 0 0,1 14,9A2,2 0 0,1 12,11A2,2 0 0,1 10,9A2,2 0 0,1 12,7M16,15H8V14C8,12.67 10.67,12 12,12C13.33,12 16,12.67 16,14V15M16,18H8V17H16V18M12,20H8V19H12V20M13,5H11V1H13V5Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Pb=[],zb=H(Eb,Ib,Pb,!1,null,null);const Dr=zb.exports,Bb={name:"Merging",components:{ContactDetailsProperty:lc,NcCheckboxRadioSwitch:fi,IconCheckCircleOutline:kb,IconCloseCircleOutline:Nb,IconSetMerge:El,NcNoteCard:dc,NcButton:Ht,IconDomain:Or,IconAccount:ai,IconBadgeAccount:Dr,NcSelect:fn,NcLoadingIcon:Jt},props:{contacts:{type:Map,required:!0}},data(){return{bus:Gs(),resolvedConflicts:new Map,conflictsToResolve:0,sortedProperties:[],simpleProperties:["fn","org","title"],simplePropertyDescriptions:{fn:{description:this.t("contacts","Name"),icon:ai},org:{description:this.t("contacts","Company"),icon:Or},title:{description:this.t("contacts","Title"),icon:Dr}},chosenAddressBook:null,selectedGroups:[],isLoading:!1}},computed:{contactsList(){return Array.from(this.contacts.values()).map(e=>e)},dividedProperties(){const[e,i]=this.contactsList;if(!e||!i)return{};const a=this.sortProperties(e),s=this.sortProperties(i),o=this.groupedProperties(a),r=this.groupedProperties(s);return[o,r]},usedProperties(){const e=this.dividedProperties.flatMap(i=>Object.keys(i));return[...new Set(e)].filter(i=>{const a=this.dividedProperties[0][i]?this.dividedProperties[0][i].map(o=>this.getPropertyValue(o)):[],s=this.dividedProperties[1][i]?this.dividedProperties[1][i].map(o=>this.getPropertyValue(o)):[];return!a.every(o=>o==null||o==="")||!s.every(o=>o==null||o==="")})},conflictInformation(){const e={};return this.usedProperties.forEach(i=>{if((this.dividedProperties[0][i]??[]).every(a=>this.checkIfPropertyEmpty(a))){e[i]={type:"onlyInSecond",value:this.dividedProperties[1][i].map(a=>this.getPropertyValue(a))};return}if((this.dividedProperties[1][i]??[]).every(a=>this.checkIfPropertyEmpty(a))){e[i]={type:"onlyInFirst",value:this.dividedProperties[0][i].map(a=>this.getPropertyValue(a))};return}if(((a,s)=>a.length===s.length&&a.every((o,r)=>o===s[r]))((this.dividedProperties[0][i]??[]).map(a=>this.getPropertyValue(a)),(this.dividedProperties[1][i]??[]).map(a=>this.getPropertyValue(a)))){e[i]={type:"equal",value:this.dividedProperties[0][i].map(a=>this.getPropertyValue(a))};return}if(ve.properties[i]?.multiple===!0){e[i]={type:"conflictWithMultipleValues",value:null};return}e[i]={type:"conflict",value:null}}),e},addressBookSelect(){return{placeholder:this.t("contacts","Select address book"),options:[{id:0,label:this.contactsList[0].addressbook.displayName},{id:1,label:this.contactsList[1].addressbook.displayName}]}}},mounted(){this.calculateConflictsToResolve(),this.sortedProperties=this.sortUsedProperties(),this.contactsList[0].addressbook.id===this.contactsList[1].addressbook.id&&(this.chosenAddressBook={id:0,label:this.contactsList[0].addressbook.displayName}),this.selectedGroups=this.selectedGroups.concat(this.contactsList[0].groups),this.selectedGroups=this.selectedGroups.concat(this.contactsList[1].groups)},methods:{resolveConflict(e,i){e===this.resolvedConflicts.get(i)?this.resolvedConflicts.set(i,void 0):this.resolvedConflicts.set(i,e),this.$forceUpdate(),this.calculateConflictsToResolve()},resolveMultiConflict(e,i){if(this.resolvedConflicts.has(i)){const a=this.resolvedConflicts.get(i);a.has(e)?a.delete(e):a.add(e),this.resolvedConflicts.set(i,a)}else{const a=new Set;a.add(e),this.resolvedConflicts.set(i,a)}this.$forceUpdate(),this.calculateConflictsToResolve()},canDisplay(e){const i=ve.properties[e.name.split(".").pop()],a=i&&i.force?i.force:e.getDefaultType();return i&&a!=="unknown"},sortProperties(e){return e.properties.slice(0).sort((i,a)=>{const s=i.name.split(".").pop(),o=a.name.split(".").pop();return ve.fieldOrder.indexOf(s)-ve.fieldOrder.indexOf(o)})},groupedProperties(e){return e.reduce((i,a)=>!this.canDisplay(a)&&a.name!=="title"&&a.name!=="org"&&a.name!=="fn"?i:a.name==="bday"||a.name==="deathdate"||a.name==="anniversary"?(i.lifeEvents||(i.lifeEvents=[]),i.lifeEvents.push(a),i):(i[a.name]||(i[a.name]=[]),i[a.name].push(a),i),{})},calculateConflictsToResolve(){let e=0;this.usedProperties.forEach(i=>{this.conflictInformation[i]?.type==="conflict"&&this.resolvedConflicts.get(i)===void 0&&e++,this.conflictInformation[i]?.type==="conflictWithMultipleValues"&&!this.resolvedConflicts.get(i)?.size&&e++}),this.chosenAddressBook===null&&e++,this.conflictsToResolve=e},getPropertyValue(e){return e.isMultiValue?e.isStructuredValue?e.getValues()[0]:e.getValues():e.getFirstValue()},checkIfPropertyEmpty(e){if(e===void 0)return!0;const i=this.getPropertyValue(e);return i===""||i===null||Array.isArray(i)&&i.length===0?!0:Array.isArray(i)?i.every(a=>a===""||a===void 0):!1},sortUsedProperties(){return this.usedProperties.sort((e,i)=>{const a=this.conflictInformation[e]?.type,s=this.conflictInformation[i]?.type;return a==="conflict"&&s!=="conflict"?-1:s==="conflict"&&a!=="conflict"?1:0})},async mergeContacts(){this.isLoading=!0;const e=this.contactsList[0],i={};this.usedProperties.forEach(a=>{if(this.conflictInformation[a]?.type==="conflict"){const s=this.resolvedConflicts.get(a);s!==void 0&&(i[a]=[this.dividedProperties[s][a]])}else if(this.conflictInformation[a]?.type==="conflictWithMultipleValues"){const s=this.resolvedConflicts.get(a);s?.size&&(i[a]=Array.from(s).map(o=>this.dividedProperties[o][a]))}else this.conflictInformation[a]?.type==="onlyInSecond"?i[a]=[this.dividedProperties[1][a]]:i[a]=[this.dividedProperties[0][a]]}),this.usedProperties.forEach(a=>{i[a]!==void 0&&i[a].length>0&&i[a].flat().forEach((s,o)=>{o===0?e.vCard.updatePropertyWithValue(a,this.getPropertyValue(s)):e.vCard.addProperty(s)})}),e.groups=this.selectedGroups,e.addressbook=this.contactsList[this.chosenAddressBook.id].addressbook,await this.$store.dispatch("updateContact",e),await this.$store.dispatch("deleteContact",{contact:this.contactsList[1]}),this.$emit("finished",e)}}};var $b=function(){var e=this,i=e._self._c;return i("div",{staticClass:"merging"},[i("div",{staticClass:"merging__title"},[i("h3",[e._v(e._s(e.t("contacts","Confirm merging contacts")))]),i("div",{staticClass:"merging-title__addressbooks"},[e.chosenAddressBook===null?i("IconCloseCircleOutline",{staticClass:"needs-action",attrs:{size:20}}):e._e(),i("NcSelect",e._b({attrs:{disabled:e.contactsList[0].addressbook.id===e.contactsList[1].addressbook.id,title:e.t("contacts","Select address book")},on:{"update:modelValue":e.calculateConflictsToResolve},model:{value:e.chosenAddressBook,callback:function(a){e.chosenAddressBook=a},expression:"chosenAddressBook"}},"NcSelect",e.addressBookSelect,!1))],1)]),e.conflictsToResolve?i("NcNoteCard",{attrs:{type:"warning",text:e.t("contacts","The selected contacts have conflicting information. Choose which information to keep")}}):i("NcNoteCard",{attrs:{type:"success",text:e.t("contacts","Contacts can be merged")}}),i("div",{staticClass:"merging__conflicts"},e._l(e.sortedProperties,function(a,s){return i("div",{key:a,class:["merging__conflicts__row",{conflict:e.conflictInformation[a]?.type==="conflict"||e.conflictInformation[a]?.type==="conflictWithMultipleValues",last:s===e.sortedProperties.length-1}]},[(e.conflictInformation[a]?.type!=="conflict"||e.resolvedConflicts.get(a)!==void 0)&&(e.conflictInformation[a]?.type!=="conflictWithMultipleValues"||e.resolvedConflicts.get(a)?.size)?i("IconCheckCircleOutline",{attrs:{size:20}}):e._e(),e.conflictInformation[a]?.type==="conflict"&&e.resolvedConflicts.get(a)===void 0?i("IconCloseCircleOutline",{staticClass:"needs-action",attrs:{size:20}}):e._e(),e.conflictInformation[a]?.type==="conflictWithMultipleValues"&&!e.resolvedConflicts.get(a)?.size?i("IconCloseCircleOutline",{staticClass:"needs-action",attrs:{size:20}}):e._e(),e.conflictInformation[a]?.type==="conflict"?i("NcCheckboxRadioSwitch",{attrs:{checked:e.resolvedConflicts.get(a)===0,type:"radio"},on:{"update:checked":function(o){return e.resolveConflict(0,a)}}}):e._e(),e.conflictInformation[a]?.type==="conflictWithMultipleValues"?i("NcCheckboxRadioSwitch",{attrs:{checked:e.resolvedConflicts.get(a)?.has(0)},on:{"update:checked":function(o){return e.resolveMultiConflict(0,a)}}}):e._e(),e.conflictInformation[a]?.type!=="onlyInSecond"?i("div",{class:["merging__conflicts__property",{"no-conflict":e.conflictInformation[a]?.type!=="conflict"&&e.conflictInformation[a]?.type!=="conflictWithMultipleValues"}]},[e.simpleProperties.includes(a)?i("div",{staticClass:"simple-property"},[i("div",{staticClass:"simple-property__title"},[i(e.simplePropertyDescriptions[a]?.icon||"span",{tag:"component",attrs:{size:20}}),i("h3",[e._v(e._s(e.simplePropertyDescriptions[a]?.description||a))])],1),e._l(e.dividedProperties[0][a],function(o){return i("span",{key:o.jCal},[e._v(e._s(o.getFirstValue()))])})],2):i("div",e._l(e.dividedProperties[0][a],function(o,r){return i("ContactDetailsProperty",{key:o.jCal,attrs:{"is-first-property":r===0,"is-last-property":!1,property:o,contact:e.contactsList[0],"local-contact":e.contactsList[0],contacts:e.contacts,bus:e.bus,"is-read-only":!0}})}),1)]):e._e(),e.conflictInformation[a]?.type==="onlyInSecond"?i("div",{staticClass:"merging-conflicts__filler"}):e._e(),e.conflictInformation[a]?.type==="conflict"?i("NcCheckboxRadioSwitch",{attrs:{checked:e.resolvedConflicts.get(a)===1,type:"radio"},on:{"update:checked":function(o){return e.resolveConflict(1,a)}}}):e._e(),e.conflictInformation[a]?.type==="conflictWithMultipleValues"?i("NcCheckboxRadioSwitch",{attrs:{checked:e.resolvedConflicts.get(a)?.has(1)},on:{"update:checked":function(o){return e.resolveMultiConflict(1,a)}}}):e._e(),e.conflictInformation[a]?.type!=="onlyInFirst"?i("div",{class:["merging__conflicts__property",{"no-conflict":e.conflictInformation[a]?.type!=="conflict"&&e.conflictInformation[a]?.type!=="conflictWithMultipleValues"}]},[e.simpleProperties.includes(a)?i("div",{staticClass:"simple-property"},[i("div",{staticClass:"simple-property__title"},[i(e.simplePropertyDescriptions[a]?.icon||"span",{tag:"component",attrs:{size:20}}),i("h3",[e._v(e._s(e.simplePropertyDescriptions[a]?.description||a))])],1),e._l(e.dividedProperties[1][a],function(o){return i("span",{key:o.jCal},[e._v(e._s(o.getFirstValue()))])})],2):i("div",e._l(e.dividedProperties[1][a],function(o,r){return i("ContactDetailsProperty",{key:o.jCal,attrs:{"is-first-property":r===0,"is-last-property":!1,property:o,contact:e.contactsList[1],"local-contact":e.contactsList[1],contacts:e.contacts,bus:e.bus,"is-read-only":!0}})}),1)]):e._e()],1)}),0),e.contactsList[0].groups.length||e.contactsList[1].groups.length?i("div",{staticClass:"merging__groups"},[i("h4",[e._v(e._s(e.t("contacts","Groups")))]),i("NcSelect",{attrs:{options:e.contactsList[0].groups.concat(e.contactsList[1].groups),multiple:!0,placeholder:e.t("contacts","Select groups to add the merged contact to"),disabled:!e.contactsList[0].groups.length&&!e.contactsList[1].groups.length},on:{"update:modelValue":e.calculateConflictsToResolve},model:{value:e.selectedGroups,callback:function(a){e.selectedGroups=a},expression:"selectedGroups"}})],1):e._e(),i("div",{staticClass:"merging__actions"},[i("NcButton",{attrs:{disabled:e.conflictsToResolve!==0,variant:"secondary"},on:{click:e.mergeContacts},scopedSlots:e._u([{key:"icon",fn:function(){return[e.isLoading?i("NcLoadingIcon",{attrs:{size:20}}):i("IconSetMerge",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Merge contacts"))+" ")])],1)],1)},Rb=[],Hb=H(Bb,$b,Rb,!1,null,"e1ae7a69");const Yb=Hb.exports,Vb='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-cancel" viewBox="0 0 24 24"><path d="M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C10.1 4 8.4 4.6 7.1 5.7L18.3 16.9C19.3 15.5 20 13.8 20 12C20 7.6 16.4 4 12 4M16.9 18.3L5.7 7.1C4.6 8.4 4 10.1 4 12C4 16.4 7.6 20 12 20C13.9 20 15.6 19.4 16.9 18.3Z" /></svg>',Ub="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20id='mdi-delete-outline'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M6,19A2,2%200%200,0%208,21H16A2,2%200%200,0%2018,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z'%20/%3e%3c/svg%3e",Gb={name:"ContactsList",mixins:[Qe],components:{AppContentList:gh,NcNoteCard:dc,VirtualList:kc,NcButton:Ht,IconSelect:fb,IconDelete:Pe,IconSetMerge:El,NcDialog:yd,NcModal:Je,Merging:Yb,NcLoadingIcon:Jt},props:{list:{type:Array,required:!0},contacts:{type:Object,required:!0},searchQuery:{type:String,default:""},reloadBus:{type:Object,required:!0}},data(){return{ContactsListItem:lb,query:"",multiSelectedContacts:new Map,refreshKey:0,showDeleteConfirmationDialog:!1,buttons:[{label:t("contacts","Cancel"),icon:Vb,callback:()=>{this.showDeleteConfirmationDialog=!1}},{label:t("contacts","Delete"),type:"primary",icon:Ub,callback:()=>{this.deleteAllMultiSelected()}}],lastToggledIndex:void 0,isMerging:!1,isMergingLoading:!1}},computed:{filteredList(){const e=this.list.filter(i=>this.matchSearch(this.contacts[i.key])).map(i=>this.contacts[i.key]);return e.forEach((i,a)=>{i.isMultiSelected=this.multiSelectedContacts.has(a)}),e},isMultiSelecting(){return this.multiSelectedContacts.size>0},readOnlyMultiSelectedCount(){let e=0;return this.multiSelectedContacts.forEach(i=>{i.addressbook.readOnly&&e++}),e},isAtLeastOneEditable(){return this.readOnlyMultiSelectedCount!==this.multiSelectedContacts.size},areTwoEditable(){return this.multiSelectedContacts.size-this.readOnlyMultiSelectedCount===2},deleteActionTitle(){return this.isAtLeastOneEditable?n("contacts","Delete {number} contact","Delete {number} contacts",this.multiSelectedContacts.size,{number:this.multiSelectedContacts.size}):t("contacts","Please select at least one editable contact to delete")},mergeActionTitle(){return this.areTwoEditable?t("contacts","Merge contacts"):t("contacts","Please select two editable contacts to merge")}},watch:{selectedContact(e){this.$nextTick(()=>{this.scrollToContact(e)})},list(e,i){e.length!==0&&i.length===0&&this.selectedContact&&this.$nextTick(()=>{this.scrollToContact(this.selectedContact)})}},mounted(){this.query=this.searchQuery},methods:{selectContact(e){if(this.list.length>0&&e<this.list.length){const i=e===0?this.list[e+1]:this.list[e-1];i&&this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:i.key}})}},scrollToContact(e){const i=this.$el.querySelector("#"+e.slice(0,-2));if(!(i&&i.getBoundingClientRect().y>50)){const a=this.list.findIndex(s=>s.key===e);a>-1&&this.$refs.scroller.scrollToIndex(a)}if(i){const a=i.getBoundingClientRect().y+this.itemHeight-(this.$el.offsetHeight+50);if(a>0){const s=this.$refs.scroller.$el;s.scrollToOffset(s.scrollTop+a)}}},matchSearch(e){return this.query.trim()!==""?e.searchData.toString().toLowerCase().search(this.query.trim().toLowerCase())!==-1:!0},onSelectMultiple(e,i,a=!1){a&&this.lastToggledIndex!==i&&this.onSelectRange(i)||(this.multiSelectedContacts.has(i)?this.multiSelectedContacts.delete(i):this.multiSelectedContacts.set(i,e),this.lastToggledIndex=i,this.$set(this,"multiSelectedContacts",new Map(this.multiSelectedContacts)))},onSelectRange(e){const i=this.lastToggledIndex??void 0;if(i===void 0)return!1;const a=Math.min(i,e),s=Math.max(i,e),o=this.multiSelectedContacts.has(e),r=new Map(this.multiSelectedContacts);for(let c=a;c<=s;c++)o?r.delete(c):r.set(c,this.filteredList[c]);return this.lastToggledIndex=e,this.$set(this,"multiSelectedContacts",r),!0},unselectAllMultiSelected(){this.$set(this,"multiSelectedContacts",new Map),this.lastToggledIndex=void 0},attemptDeleteAllMultiSelected(){this.showDeleteConfirmationDialog=!0},deleteAllMultiSelected(){this.multiSelectedContacts.forEach(async e=>{e.addressbook.readOnly||(await new Promise(i=>setTimeout(i,500)),await this.$store.dispatch("deleteContact",{contact:e}))}),this.unselectAllMultiSelected(),this.showDeleteConfirmationDialog=!1},async initiateContactMerging(){this.isMergingLoading=!0;const e=Array.from(this.multiSelectedContacts.values());for(const i of e)await this.$store.dispatch("fetchFullContact",{contact:i});this.isMergingLoading=!1,this.isMerging=!0},async finishContactMerging(e){await this.$store.dispatch("fetchFullContact",{contact:e,forceReFetch:!0}),this.unselectAllMultiSelected(),this.isMerging=!1,await this.$router.push({name:"root"})}}};var Fb=function(){var e=this,i=e._self._c;return i("AppContentList",{staticClass:"content-list",attrs:{"data-testid":"contacts-list"}},[i("NcDialog",{attrs:{open:e.showDeleteConfirmationDialog,name:e.n("contacts","Delete {number} contact","Delete {number} contacts",e.multiSelectedContacts.size,{number:e.multiSelectedContacts.size}),buttons:e.buttons,"no-close":""}},[e._v(" "+e._s(e.t("contacts","Are you sure you want to proceed?"))+" "),e.readOnlyMultiSelectedCount?i("NcNoteCard",{attrs:{type:"info",text:e.n("contacts","Please note that {number} contact is read only and will not be deleted","Please note that {number} contacts are read only and will not be deleted",e.readOnlyMultiSelectedCount,{number:e.readOnlyMultiSelectedCount})}}):e._e()],1),e.isMerging?i("NcModal",{attrs:{name:e.t("contacts","Merge contacts"),size:"large"},on:{close:function(a){e.isMerging=!1}}},[i("Merging",{attrs:{contacts:e.multiSelectedContacts},on:{finished:e.finishContactMerging}})],1):e._e(),i("div",{staticClass:"contacts-list__header"},[i("div",{staticClass:"search-contacts-field"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],attrs:{type:"text",placeholder:e.t("contacts","Search contacts …")},domProps:{value:e.query},on:{input:function(a){a.target.composing||(e.query=a.target.value)}}})])]),i("transition",{attrs:{name:"contacts-list__multiselect-header"}},[e.isMultiSelecting?i("div",{staticClass:"contacts-list__multiselect-header"},[i("NcButton",{attrs:{type:"tertiary",title:e.t("contacts","Unselect {number}",{number:e.multiSelectedContacts.size}),"close-after-click":!0},on:{click:function(a){return a.preventDefault(),e.unselectAllMultiSelected.apply(null,arguments)}}},[i("IconSelect",{attrs:{size:16}})],1),i("NcButton",{attrs:{type:"tertiary",disabled:!e.isAtLeastOneEditable,title:e.deleteActionTitle,"close-after-click":!0},on:{click:function(a){return a.preventDefault(),e.attemptDeleteAllMultiSelected.apply(null,arguments)}}},[i("IconDelete",{attrs:{size:16}})],1),e.isMergingLoading?i("NcLoadingIcon",{attrs:{size:20}}):i("NcButton",{attrs:{type:"tertiary",disabled:!e.areTwoEditable,title:e.mergeActionTitle,"close-after-click":!0},on:{click:function(a){return a.preventDefault(),e.initiateContactMerging.apply(null,arguments)}}},[i("IconSetMerge",{attrs:{size:20}})],1)],1):e._e()]),i("VirtualList",{ref:"scroller",staticClass:"contacts-list",attrs:{"data-key":"key","data-sources":e.filteredList,"data-component":e.ContactsListItem,"estimate-size":68,"extra-props":{reloadBus:e.reloadBus,onSelectMultipleFromParent:e.onSelectMultiple,onSelectRangeFromParent:e.onSelectRange}}})],1)},jb=[],Wb=H(Gb,Fb,jb,!1,null,"9bdc3316");const qb=Wb.exports,Xb={name:"ContactsContent",components:{AppContent:$s,Button:Ht,ContactDetails:ab,ContactsList:qb,EmptyContent:Xe,IconContact:mn,IconLoading:Jt},mixins:[Qe],props:{loading:{type:Boolean,default:!0},contactsList:{type:Array,required:!0}},data(){return{searchQuery:"",reloadBus:Gs()}},computed:{contacts(){return this.$store.getters.getContacts},groups(){return this.$store.getters.getGroups},sortedContacts(){return this.$store.getters.getSortedContacts},isRealGroup(){return this.groups.findIndex(e=>e.name===this.selectedGroup)>-1},isEmptyGroup(){return this.contactsList.length===0},showDetails(){return!!this.selectedContact}},methods:{addContactsToGroup(e){De("contacts:group:append",e)},newContact(){this.$emit("new-contact")},hideDetails(){this.$router.push({name:"group",params:{selectedGroup:this.selectedGroup}})}}};var Zb=function(){var e=this,i=e._self._c;return e.loading?i("AppContent",[i("EmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","Loading contacts …")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)})],1):e.isEmptyGroup&&!e.isRealGroup?i("AppContent",[i("EmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","There are no contacts yet")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0},{key:"desc",fn:function(){return[i("Button",{attrs:{type:"primary"},on:{click:e.newContact}},[e._v(" "+e._s(e.t("contacts","Create contact"))+" ")])]},proxy:!0}])})],1):e.isEmptyGroup&&e.isRealGroup?i("AppContent",[i("EmptyContent",{staticClass:"empty-content",attrs:{name:e.t("contacts","There are no contacts in this group")},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0},{key:"desc",fn:function(){return[e.contacts.length===0?i("Button",{attrs:{type:"primary"},on:{click:function(a){return e.addContactsToGroup(e.selectedGroup)}}},[e._v(" "+e._s(e.t("contacts","Create contacts"))+" ")]):i("Button",{attrs:{type:"primary"},on:{click:function(a){return e.addContactsToGroup(e.selectedGroup)}}},[e._v(" "+e._s(e.t("contacts","Add contacts"))+" ")])]},proxy:!0}])})],1):i("AppContent",{attrs:{"show-details":e.showDetails},on:{"update:showDetails":e.hideDetails},scopedSlots:e._u([{key:"list",fn:function(){return[i("ContactsList",{attrs:{list:e.contactsList,contacts:e.contacts,"search-query":e.searchQuery,"reload-bus":e.reloadBus}})]},proxy:!0}])},[i("ContactDetails",{attrs:{"contact-key":e.selectedContact,contacts:e.sortedContacts,"reload-bus":e.reloadBus}})],1)},Kb=[],Jb=H(Xb,Zb,Kb,!1,null,"11e58ea1");const Qb=Jb.exports,tC={name:"ProcessingScreen",components:{EmptyContent:Xe,IconContact:mn},props:{total:{type:Number,required:!0},progress:{type:Number,required:!0},desc:{type:String,required:!0},title:{type:String,required:!0}}};var eC=function(){var e=this,i=e._self._c;return i("div",[i("EmptyContent",{staticClass:"processing-screen__wrapper",attrs:{description:e.desc,name:e.title},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0}])}),i("div",{staticClass:"processing-screen__progress"},[i("progress",{attrs:{max:e.total},domProps:{value:e.progress}})])],1)},nC=[],iC=H(tC,eC,nC,!1,null,"dd942720");const Il=iC.exports,aC={name:"AddToGroupView",components:{ProcessingScreen:Il,Button:Ht},props:{failed:{type:Number,default:0},progress:{type:Number,default:0},success:{type:Number,default:0},total:{type:Number,default:0},name:{type:String,default:""}},computed:{progressHeader(){return n("contacts","{success} contact added to {name}","{success} contacts added to {name}",this.success,{success:this.success,name:this.name})},finishedHeader(){return n("contacts","Adding {success} contact to {name}","Adding {success} contacts to {name}",this.success,{success:this.success,name:this.name})},messageFailed(){return n("contacts","{count} error","{count} errors",this.failed,{count:this.failed})}},methods:{onClose(){this.$emit("close")}}};var sC=function(){var e=this,i=e._self._c;return i("div",[i("ProcessingScreen",{attrs:{progress:e.progress,total:e.total,desc:e.failed>0?e.messageFailed:"",title:e.total===e.progress?e.finishedHeader:e.progressHeader}}),i("div",{staticClass:"close__button"},[e.total===e.progress?i("Button",{staticClass:"primary",on:{click:e.onClose}},[e._v(" "+e._s(e.t("contacts","Close"))+" ")]):e._e()],1)],1)},oC=[],rC=H(aC,sC,oC,!1,null,"13da812b");const cC=rC.exports,lC=async function(e,i){const a=e.groups;return a.push(i),ce.patch(e.url,{},{headers:{"X-PROPERTY":"CATEGORIES","X-PROPERTY-REPLACE":a.map(s=>encodeURIComponent(s)).join(",")}})},uC={name:"ContactsPicker",components:{AddToGroupView:cC,EntityPicker:xc,Modal:Je},data(){return{showPicker:!1,pickerforGroup:null,pickerData:[],pickerTypes:[{id:"contact",label:t("contacts","Contacts")}],isProcessing:!1,isProcessDone:!1,processStatus:{failed:0,progress:0,success:0,total:0,name:""},passedGroupName:""}},computed:{contacts(){return this.$store.getters.getContacts},groups(){return this.$store.getters.getGroups},sortedContacts(){return this.$store.getters.getSortedContacts}},mounted(){ii("contacts:group:append",this.addContactsToGroup)},methods:{addContactsToGroup(e){if(console.debug("Contacts picker opened for group",e),this.passedGroupName=e.name?e.name:e,typeof e=="string"&&(e=this.groups.find(i=>i.name===e),!e)){console.error("Cannot add contact to an undefined group",e);return}this.pickerData=this.sortedContacts.map(({key:i})=>{const a=this.contacts[i];return{id:a.key,label:a.displayName,type:"contact",readOnly:a.addressbook.readOnly,groups:a.groups}}).filter(i=>!i.readOnly).filter(i=>i.groups.indexOf(e.name)===-1),this.showPicker=!0,this.pickerforGroup=e},onContactPickerClose(){this.pickerData=[],this.showPicker=!1},onContactPickerPick(e){console.debug("Adding",e,"to group",this.pickerforGroup);const i=this.pickerforGroup.name;this.isProcessing=!0,this.showPicker=!1,this.processStatus.total=e.length,this.processStatus.name=this.pickerforGroup.name,this.processStatus.progress=0,this.processStatus.failed=0;const a=Ud(3),s=[];e.map(async o=>{try{const r=this.contacts[o.id];s.push(a(()=>lC(r,i).then(()=>{this.$store.dispatch("addContactToGroup",{contact:r,groupName:i}),this.processStatus.progress++,this.processStatus.success++}).catch(c=>{this.processStatus.progress++,this.processStatus.error++,console.error(c)})))}catch(r){console.error(r)}}),Promise.all(s).then(()=>{this.isProcessDone=!0,this.showPicker=!1,this.$router.push({name:"group",params:{selectedGroup:typeof this.passedGroupName=="string"?this.passedGroupName:this.passedGroupName.name}}),this.processStatus.failed===0&&setTimeout(this.closeProcess,3e3)})},closeProcess(){this.pickerforGroup=null,this.isProcessing=!1,this.isProcessDone=!1,this.processStatus.failed=0,this.processStatus.progress=0,this.processStatus.success=0,this.processStatus.total=0,!(this.passedGroupName===""||this.passedGroupName===void 0)&&this.$router.push({name:"group",params:{selectedGroup:typeof this.passedGroupName=="string"?this.passedGroupName:this.passedGroupName.name}})}}};var dC=function(){var e=this,i=e._self._c;return e.isProcessing||e.isProcessDone?i("Modal",{attrs:{"clear-view-delay":-1,"can-close":e.isProcessDone},on:{close:e.closeProcess}},[i("AddToGroupView",e._b({on:{close:e.closeProcess}},"AddToGroupView",e.processStatus,!1))],1):e.showPicker?i("EntityPicker",{attrs:{"confirm-label":e.t("contacts","Add to {group}",{group:e.pickerforGroup.name}),"data-types":e.pickerTypes,"data-set":e.pickerData,"empty-data-set-description":e.t("contacts","Please note that you can only add contacts from writable address books to contact groups. Contacts from read-only address books, such as the system address book, cannot be added.")},on:{close:e.onContactPickerClose,submit:e.onContactPickerPick}}):e._e()},hC=[],pC=H(uC,dC,hC,!1,null,null);const fC=pC.exports,mC={name:"ImportView",components:{ProcessingScreen:Il,Button:Ht},computed:{importState(){return this.$store.getters.getImportState},addressbook(){return this.importState.addressbook},total(){return this.importState.total},accepted(){return this.importState.accepted},failed(){return this.importState.denied},progress(){return this.accepted+this.failed},importingHeader(){return n("contacts","Importing %n contact into {addressbook}","Importing %n contacts into {addressbook}",this.total,{addressbook:this.addressbook})},importedHeader(){return n("contacts","Done importing %n contact into {addressbook}","Done importing %n contacts into {addressbook}",this.total,{addressbook:this.addressbook})},importFailed(){return n("contacts","{count} error","{count} errors",this.failed,{count:this.failed})}},methods:{onClose(){this.$emit("close")}}};var gC=function(){var e=this,i=e._self._c;return i("div",[i("ProcessingScreen",{attrs:{progress:e.progress,total:e.total,desc:e.failed>0?e.importFailed:"",title:e.total===e.progress?e.importedHeader:e.importingHeader}}),i("div",{staticClass:"close__button"},[e.total===e.progress?i("Button",{staticClass:"primary",on:{click:e.onClose}},[e._v(" "+e._s(e.t("contacts","Close"))+" ")]):e._e()],1)],1)},yC=[],vC=H(mC,gC,yC,!1,null,"bb652b08");const _C=vC.exports,bC={name:"LocationEnterIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var CC=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon location-enter-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M14 12L10 8V11H2V13H10V16M22 12A10 10 0 0 1 2.46 15H4.59A8 8 0 1 0 4.59 9H2.46A10 10 0 0 1 22 12Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},wC=[],kC=H(bC,CC,wC,!1,null,null);const xC=kC.exports,SC={name:"AccountStarOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var MC=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon account-star-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M15,4A4,4 0 0,1 19,8A4,4 0 0,1 15,12A4,4 0 0,1 11,8A4,4 0 0,1 15,4M15,5.9A2.1,2.1 0 0,0 12.9,8A2.1,2.1 0 0,0 15,10.1C16.16,10.1 17.1,9.16 17.1,8C17.1,6.84 16.16,5.9 15,5.9M15,13C17.67,13 23,14.33 23,17V20H7V17C7,14.33 12.33,13 15,13M15,14.9C12,14.9 8.9,16.36 8.9,17V18.1H21.1V17C21.1,16.36 17.97,14.9 15,14.9M5,13.28L2.5,14.77L3.18,11.96L1,10.08L3.87,9.83L5,7.19L6.11,9.83L9,10.08L6.8,11.96L7.45,14.77L5,13.28Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},AC=[],NC=H(SC,MC,AC,!1,null,null);const OC=NC.exports,DC={name:"AccountGroupIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var LC=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon account-group-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},TC=[],EC=H(DC,LC,TC,!1,null,null);const IC=EC.exports,PC={name:"CircleNavigationItem",components:{ActionButton:Ke,ActionLink:ya,ActionText:Bs,NcCounterBubble:_a,AppNavigationItem:Hs,ExitToApp:Cc,IconCog:js,IconDelete:Pe,LocationEnter:xC,AccountStar:OC,AccountGroup:IC,AccountGroupOutline:ba,IconLoading:Jt},mixins:[_c],props:{circle:{type:sc,required:!0}},computed:{memberCount(){const e=Object.keys(this.circle?.members||[]).length;return e===0&&this.circle.population>0?this.circle.population:e}}};var zC=function(){var e=this,i=e._self._c;return i("AppNavigationItem",{key:e.circle.key,attrs:{name:e.circle.displayName,to:e.circle.router},scopedSlots:e._u([{key:"icon",fn:function(){return[e.circle.isOwner?i("AccountStar",{attrs:{size:20}}):e.circle.isMember?i("AccountGroup",{attrs:{size:20}}):i("AccountGroupOutline",{attrs:{size:20}})]},proxy:!0},{key:"actions",fn:function(){return[e.loadingAction?i("ActionText",{scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)},[e._v(" "+e._s(e.t("contacts","Loading …"))+" ")]):[e.circle.canManageMembers?i("ActionButton",{attrs:{"close-after-click":!0},on:{click:e.addMemberToCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconCog",{attrs:{size:20}})]},proxy:!0}],null,!1,4087142664)},[e._v(" "+e._s(e.t("contacts","Manage team"))+" ")]):e._e(),i("ActionLink",{attrs:{href:e.circleUrl,icon:e.copyLinkIcon},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.copyToClipboard(e.circleUrl)}}},[e._v(" "+e._s(e.copyButtonText)+" ")]),e.circle.canLeave?i("ActionButton",{on:{click:e.confirmLeaveCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("ExitToApp",{attrs:{size:16}})]},proxy:!0}],null,!1,3893118231)},[e._v(" "+e._s(e.t("contacts","Leave team"))+" ")]):!e.circle.isMember&&e.circle.canJoin?i("ActionButton",{attrs:{disabled:e.loadingJoin},on:{click:e.joinCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("LocationEnter",{attrs:{size:16}})]},proxy:!0}])},[e._v(" "+e._s(e.joinButtonTitle)+" ")]):e._e(),e.circle.canDelete?i("ActionButton",{on:{click:e.confirmDeleteCircle},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)},[e._v(" "+e._s(e.t("contacts","Delete team"))+" ")]):e._e()]]},proxy:!0},{key:"counter",fn:function(){return[e.memberCount>0?i("NcCounterBubble",[e._v(" "+e._s(e.memberCount)+" ")]):e._e()]},proxy:!0}])})},BC=[],$C=H(PC,zC,BC,!1,null,null);const RC=$C.exports,HC={name:"AccountMultiplePlusOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var YC=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon account-multiple-plus-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M13 11A3 3 0 1 0 10 8A3 3 0 0 0 13 11M13 7A1 1 0 1 1 12 8A1 1 0 0 1 13 7M17.11 10.86A5 5 0 0 0 17.11 5.14A2.91 2.91 0 0 1 18 5A3 3 0 0 1 18 11A2.91 2.91 0 0 1 17.11 10.86M13 13C7 13 7 17 7 17V19H19V17S19 13 13 13M9 17C9 16.71 9.32 15 13 15C16.5 15 16.94 16.56 17 17M24 17V19H21V17A5.6 5.6 0 0 0 19.2 13.06C24 13.55 24 17 24 17M8 12H5V15H3V12H0V10H3V7H5V10H8Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},VC=[],UC=H(HC,YC,VC,!1,null,null);const GC=UC.exports,FC={name:"ShareVariantOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var jC=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon share-variant-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12S8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5S19.66 2 18 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12S4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.34C15.11 18.55 15.08 18.77 15.08 19C15.08 20.61 16.39 21.91 18 21.91S20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08M18 4C18.55 4 19 4.45 19 5S18.55 6 18 6 17 5.55 17 5 17.45 4 18 4M6 13C5.45 13 5 12.55 5 12S5.45 11 6 11 7 11.45 7 12 6.55 13 6 13M18 20C17.45 20 17 19.55 17 19S17.45 18 18 18 19 18.45 19 19 18.55 20 18 20Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},WC=[],qC=H(FC,jC,WC,!1,null,null);const XC=qC.exports,Lr=hn("contacts","isGroupSharingEnabled",!1),ZC={name:"SettingsAddressbookSharee",components:{Button:Ht,IconDelete:Pe,IconGroup:mn,IconLoading:Jt,IconUser:ai},props:{addressbook:{type:Object,required:!0},sharee:{type:Object,required:!0}},data(){return{loading:!1}},computed:{writeable(){return this.sharee.writeable},uid(){return this.sharee.id+this.addressbook.id+Math.floor(Math.random()*1e3)}},methods:{async deleteSharee(){if(this.loading)return!1;this.loading=!0;try{await this.$store.dispatch("removeSharee",{addressbook:this.addressbook,uri:this.sharee.uri})}catch(e){console.error(e),tt(t("contacts","Unable to delete the share"))}finally{this.loading=!1}},async editSharee(){if(this.loading)return!1;this.loading=!0;try{await this.$store.dispatch("toggleShareeWritable",{addressbook:this.addressbook,uri:this.sharee.uri,writeable:!this.sharee.writeable})}catch(e){console.error(e),tt(t("contacts","Unable to change permissions"))}finally{this.loading=!1}}}};var KC=function(){var e=this,i=e._self._c;return i("li",{staticClass:"addressbook-sharee"},[e.loading?i("IconLoading",{attrs:{size:20}}):e.sharee.isGroup&&!e.loading?i("IconGroup"):!e.sharee.isGroup&&!e.loading?i("IconUser"):e._e(),i("span",{staticClass:"addressbook-sharee__identifier",attrs:{title:e.sharee.displayName}},[e._v(" "+e._s(e.sharee.displayName)+" ")]),i("span",{staticClass:"addressbook-sharee__utils"},[i("input",{staticClass:"checkbox",attrs:{id:e.uid,disabled:e.loading,name:"editable",type:"checkbox"},domProps:{checked:e.writeable},on:{change:e.editSharee}}),i("label",{attrs:{for:e.uid,title:e.t("contacts","can edit")}},[e._v(" "+e._s(e.t("contacts","can edit"))+" ")]),i("Button",{class:{"addressbook-sharee__utils--disabled":e.loading},attrs:{href:"#",title:"Delete"},on:{click:e.deleteSharee},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDelete",{attrs:{size:20}})]},proxy:!0}])})],1)],1)},JC=[],QC=H(ZC,KC,JC,!1,null,"11add268");const tw=QC.exports;function Tr(e){return decodeURIComponent(e.replace(/\+/g," "))}const ew={name:"SettingsAddressbookShare",components:{NcSelect:fn,addressBookSharee:tw},props:{addressbook:{type:Object,default(){return{}}}},data(){return{isLoading:!1,inputGiven:!1,usersOrGroups:[]}},computed:{placeholder(){return Lr?t("contacts","Share with users or groups"):t("contacts","Share with users")},noResult(){return t("contacts","No users or groups")}},mounted(){document.getElementById("users-groups-search").focus()},methods:{shareAddressbook({user:e,displayName:i,uri:a,isGroup:s}){this.$store.dispatch("shareAddressbook",{addressbook:this.addressbook,user:e,displayName:i,uri:a,isGroup:s})},findSharee:ec(async function(e){if(this.isLoading=!0,this.usersOrGroups=[],e.length>0){const i=await Pi.principalPropertySearchByDisplayname(e);this.usersOrGroups=i.filter(a=>{const s=["INDIVIDUAL"];return Lr&&s.push("GROUP"),s.includes(a.calendarUserType)&&!this.addressbook.shares.some(o=>o.uri===a.principalScheme)}).map(a=>{const s=a.calendarUserType==="GROUP";return{user:Tr(a[s?"groupId":"userId"]),displayName:a.displayname,icon:s?"icon-group":"icon-user",uri:Tr(a.principalScheme),isGroup:s}}),this.isLoading=!1,this.inputGiven=!0}else this.inputGiven=!1,this.isLoading=!1},500)}};var nw=function(){var e=this,i=e._self._c;return i("div",{staticClass:"addressbook-shares"},[i("NcSelect",{class:{showContent:e.inputGiven,"icon-loading":e.isLoading},attrs:{id:"users-groups-search",options:e.usersOrGroups,searchable:!0,"internal-search":!1,"max-height":600,"show-no-results":!0,placeholder:e.placeholder,"user-select":!0,"open-direction":"bottom","track-by":"user",label:"displayName"},on:{search:e.findSharee,input:e.shareAddressbook}}),e.addressbook.shares.length>0?i("ul",{staticClass:"addressbook-shares__list"},e._l(e.addressbook.shares,function(a){return i("address-book-sharee",{key:a.uri,attrs:{sharee:a,addressbook:e.addressbook}})}),1):e._e()],1)},iw=[],aw=H(ew,nw,iw,!1,null,"20508be5");const sw=aw.exports,ow={name:"SettingsAddressbook",components:{ActionButton:Ke,ActionCheckbox:Gd,ActionInput:Ys,ActionLink:ya,Actions:Ze,Button:Ht,IconDelete:Pe,IconDownload:xa,IconRename:Vs,IconContactPlus:GC,IconShare:XC,IconLoading:Jt,ShareAddressBook:sw},mixins:[vc],props:{addressbook:{type:Object,default(){return{}}}},data(){return{deleteAddressbookLoading:!1,editingName:!1,menuOpen:!1,renameLoading:!1,shareOpen:!1,toggleEnabledLoading:!1}},computed:{enabled(){return this.addressbook.enabled},hasShares(){return this.addressbook.shares.length>0},addressbooks(){return this.$store.getters.getAddressbooks},hasMultipleAddressbooks(){return this.addressbooks.length>1},sharedWithTooltip(){return this.hasShares?n("contacts","Shared with {num} entity","Shared with {num} entities",this.addressbook.shares.length,{num:this.addressbook.shares.length}):""},copyButtonText(){return this.copied?this.copySuccess?t("contacts","Copied"):t("contacts","Cannot copy"):t("contacts","Copy link")},addressbookUrl(){return window.location.origin+this.addressbook.url},contacts(){return Object.values(this.addressbook.contacts)},groups(){const e=this.contacts.flatMap(i=>i.vCard.getAllProperties("categories").map(a=>a.getFirstValue()));return[...new Set(e)]},contactsCount(){return this.contacts.length},groupsCount(){return this.groups.length},principalUrl(){return hc().currentUserPrincipal.principalUrl}},watch:{menuOpen(){this.menuOpen===!1&&(this.editingName=!1)}},mounted(){this.popupItem=this.$el},methods:{closeMenu(){this.menuOpen=!1},toggleMenu(){this.menuOpen=!this.menuOpen},toggleShare(){this.shareOpen=!this.shareOpen},async toggleAddressbookEnabled(){this.toggleEnabledLoading=!0;try{await this.$store.dispatch("toggleAddressbookEnabled",this.addressbook)}catch(e){console.error(e),tt(t("contacts","Toggling of address book was not successful"))}finally{this.toggleEnabledLoading=!1}},confirmDeletion(){window.OC.dialogs.confirm(t("contacts","This will delete the address book and every contacts within it"),t("contacts","Delete {addressbook}?",{addressbook:this.addressbook.displayName}),this.deleteAddressbook,!0)},confirmUnshare(){window.OC.dialogs.confirm(t("contacts","This will unshare the address book and every contacts within it"),t("contacts","Unshare {addressbook}?",{addressbook:this.addressbook.displayName}),this.deleteAddressbook,!0)},async deleteAddressbook(e){if(e){this.deleteAddressbookLoading=!0;try{await this.$store.dispatch("deleteAddressbook",this.addressbook)}catch(i){console.error(i),tt(t("contacts","Deletion of address book was not successful."))}finally{this.deleteAddressbookLoading=!1}}},renameAddressbook(){this.editingName=!0},async updateAddressbookName(){const e=this.addressbook,i=this.$refs.renameInput.$el.querySelector('input[type="text"]').value;this.renameLoading=!0;try{await this.$store.dispatch("renameAddressbook",{addressbook:e,newName:i})}catch(a){console.error(a),tt(t("contacts","Renaming of address book was not successful."))}finally{this.editingName=!1,this.renameLoading=!1,this.menuOpen=!1}}}};var rw=function(){var e=this,i=e._self._c;return i("div",{staticClass:"settings-addressbook-list"},[i("IconContactPlus",{staticClass:"settings-line__icon"}),i("li",{staticClass:"addressbook",class:{"addressbook--disabled":!e.addressbook.enabled}},[i("div",{staticClass:"addressbook__content"},[i("span",{staticClass:"addressbook__name",attrs:{title:e.addressbook.displayName}},[e._v(" "+e._s(e.addressbook.enabled?e.addressbook.displayName:e.t("contacts","{addressbookname} (Disabled)",{addressbookname:e.addressbook.displayName}))+" ")]),e.addressbook.dav.description?i("div",{staticClass:"addressbook__description"},[e._v(" "+e._s(e.addressbook.dav.description)+" ")]):e._e(),e.addressbook.enabled?i("div",{staticClass:"addressbook__count-wrapper"},[i("span",{staticClass:"addressbook__count"},[e._v(e._s(e.n("contacts","%n contact","%n contacts",e.contactsCount)))]),i("span",{staticClass:"addressbook__count"},[e._v("- "+e._s(e.n("contacts","%n group","%n groups",e.groupsCount)))])]):e._e()]),e.addressbook.readOnly?e._e():i("Button",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.sharedWithTooltip,expression:"sharedWithTooltip",modifiers:{top:!0}}],staticClass:"addressbook__share",class:{"addressbook__share--shared":e.hasShares},attrs:{name:e.sharedWithTooltip,href:"#"},on:{click:e.toggleShare},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconShare",{attrs:{size:20}})]},proxy:!0}],null,!1,165512238)}),i("Actions",{staticClass:"addressbook__menu",attrs:{"menu-align":"right"}},[i("ActionLink",{attrs:{href:e.addressbook.url,icon:e.copyLinkIcon},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.copyToClipboard(e.addressbookUrl)}}},[e._v(" "+e._s(e.copyButtonText)+" ")]),i("ActionLink",{attrs:{href:e.addressbook.url+"?export"},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDownload",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Download"))+" ")]),e.addressbook.writeProps?[e.toggleEnabledLoading?i("ActionButton",{scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconLoading",{attrs:{size:20}})]},proxy:!0}],null,!1,3081367109)},[e._v(" "+e._s(e.t("contacts","Show"))+" ")]):i("ActionCheckbox",{attrs:{checked:e.enabled},on:{change:function(a){return a.stopPropagation(),a.preventDefault(),e.toggleAddressbookEnabled.apply(null,arguments)}}},[e._v(" "+e._s(e.t("contacts","Show"))+" ")])]:e._e(),e.addressbook.readOnly?e._e():[e.editingName?i("ActionInput",{ref:"renameInput",attrs:{disabled:e.renameLoading,value:e.addressbook.displayName},on:{submit:e.updateAddressbookName},scopedSlots:e._u([{key:"icon",fn:function(){return[e.renameLoading?i("IconLoading",{attrs:{size:20}}):e._e(),i("IconRename",{attrs:{size:20}})]},proxy:!0}],null,!1,1193466029)}):i("ActionButton",{on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.renameAddressbook.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconRename",{attrs:{size:20}})]},proxy:!0}],null,!1,4207163347)},[e._v(" "+e._s(e.t("contacts","Rename"))+" ")])],e.hasMultipleAddressbooks&&e.addressbook.owner!==e.principalUrl&&e.addressbook.owner!=="/remote.php/dav/principals/system/system/"?i("ActionButton",{on:{click:e.confirmUnshare},scopedSlots:e._u([{key:"icon",fn:function(){return[e.deleteAddressbookLoading?i("IconLoading",{attrs:{size:20}}):e._e(),i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,4278421522)},[e._v(" "+e._s(e.t("contacts","Unshare from me"))+" ")]):e.hasMultipleAddressbooks&&e.addressbook.owner!=="/remote.php/dav/principals/system/system/"?i("ActionButton",{on:{click:e.confirmDeletion},scopedSlots:e._u([{key:"icon",fn:function(){return[e.deleteAddressbookLoading?i("IconLoading",{attrs:{size:20}}):e._e(),i("IconDelete",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Delete"))+" ")]):e._e()],2),e.shareOpen&&!e.addressbook.readOnly?i("ShareAddressBook",{attrs:{addressbook:e.addressbook}}):e._e()],1)],1)},cw=[],lw=H(ow,rw,cw,!1,null,"6d644da8");const uw=lw.exports,dw={name:"LoadingIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var hw=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon loading-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},pw=[],fw=H(dw,hw,pw,!1,null,null);const mw=fw.exports,gw={name:"SettingsNewAddressbook",components:{NcTextField:nc,IconAdd:mi,IconLoading:mw},data(){return{loading:!1,displayName:"",addressBookRegex:"[^/\\\\]+"}},methods:{addAddressbook(){this.displayName!==""&&(this.loading=!0,this.$store.dispatch("appendAddressbook",{displayName:this.displayName}).then(()=>{this.displayName="",this.loading=!1}).catch(e=>{console.error(e),tt(t("contacts","An error occurred, unable to create the address book")),this.loading=!1}))}}};var yw=function(){var e=this,i=e._self._c;return i("div",{staticClass:"new-addressbook-entry"},[e.loading?i("IconLoading",{attrs:{size:20}}):e._e(),i("NcTextField",{staticClass:"new-addressbook",attrs:{value:e.displayName,disabled:e.loading,label:e.t("contacts","Add new address book"),pattern:e.addressBookRegex,"show-trailing-button":!0,"trailing-button-label":e.t("contacts","Add"),"trailing-button-icon":"arrowRight",type:"text",autocomplete:"off",autocorrect:"off",spellcheck:"false"},on:{"update:value":function(a){e.displayName=a},"trailing-button-click":e.addAddressbook}},[i("IconAdd",{attrs:{size:20}})],1)],1)},vw=[],_w=H(gw,yw,vw,!1,null,null);const bw=_w.exports,Cw={name:"AlertCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ww=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon alert-circle-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},kw=[],xw=H(Cw,ww,kw,!1,null,null);const Pl=xw.exports,Sw=ce.CancelToken,Mw=rc(t("contacts","Choose a vCard file to import")).setMultiSelect(!1).setType(1).allowDirectories(!1).addMimeTypeFilter("text/vcard").build(),Aw={name:"SettingsImportContacts",components:{Button:Ht,Modal:Je,NcSelect:fn,IconUpload:Ol,IconError:Pl,IconFolder:Dl,IconLoading:Jt},data(){return{cancelRequest:()=>{},importDestination:!1,isOpened:!1,loading:!1}},computed:{addressbooks(){return this.$store.getters.getAddressbooks},availableAddressbooks(){return this.addressbooks.filter(e=>!e.readOnly&&e.enabled)},options(){return this.availableAddressbooks.map(e=>({id:e.id,displayName:e.displayName}))},selectedAddressbook:{get(){return this.importDestination?this.availableAddressbooks.find(e=>e.id===this.importDestination.id):this.availableAddressbooks[0]},set(e){this.importDestination=e}},selectedAddressbookOption:{get(){return this.options.find(e=>e.id===this.selectedAddressbook.id)},set(e){this.selectedAddressbook=this.availableAddressbooks.find(i=>i.id===e.id)}},isSingleAddressbook(){return this.options.length===1},isNoAddressbookAvailable(){return this.options.length<1},importState(){return this.$store.getters.getImportState},isImporting(){return this.importState.stage!=="default"}},async mounted(){if(this.$route.name==="import"){const e=this.$route.query.file;await this.processLocalFile(e),this.$router.push({name:"group",params:{selectedGroup:t("contacts","All contacts")}})}},methods:{processFile(e){this.loading=!0,this.$store.dispatch("changeStage","parsing");const i=e.target.files[0],a=new FileReader,s=this.selectedAddressbook;this.$store.dispatch("setAddressbook",s.displayName),a.onload=()=>{this.isOpened=!1,this.$store.dispatch("importContactsIntoAddressbook",{vcf:a.result,addressbook:s}),e.target.value="",this.resetState()},a.readAsText(i)},async processLocalFile(e){console.debug("Importing",e);try{this.cancelRequest();const i=Sw.source();this.cancelRequest=i.cancel;const a=await ce.get(Jr(`dav/files/${Qr().uid}`)+Xd(e),{cancelToken:i.token}),s=this.selectedAddressbook;this.$store.dispatch("changeStage","parsing"),this.$store.dispatch("setAddressbook",s.displayName),a.data&&await this.$store.dispatch("importContactsIntoAddressbook",{vcf:a.data,addressbook:s})}catch(i){console.error("Something wrong happened while processing local file",i)}},toggleModal(){this.isOpened=!this.isOpened,this.isOpened||this.cancelRequest()},clickImportInput(){this.$refs["contact-import-input"].click()},async openPicker(){try{this.cancelRequest();const e=await Mw.pick();e&&(this.loading=!0,await this.processLocalFile(e)),this.resetState()}catch(e){this.loading=!1,console.error("Something wrong happened while picking a file",e)}},resetState(){this.cancelRequest=()=>{},this.importDestination=!1,this.isOpened=!1,this.loading=!1}}};var Nw=function(){var e=this,i=e._self._c;return i("div",{staticClass:"import-contact"},[e.isNoAddressbookAvailable?i("Button",{staticClass:"button import-contact__button-disabled import-contact__multiselect-label import-contact__multiselect--no-select",attrs:{id:"upload",for:"contact-import"},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconError",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("contacts","Importing is disabled because there are no address books available"))+" ")]):[i("Button",{staticClass:"import-contact__button-main",on:{click:e.toggleModal},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconUpload",{attrs:{size:20}})]},proxy:!0}],null,!1,337456192)},[e._v(" "+e._s(e.t("contacts","Import contacts"))+" ")]),e.isOpened?i("Modal",{ref:"modal",staticClass:"import-contact__modal",attrs:{name:e.t("contacts","Import contacts")},on:{close:e.toggleModal}},[i("section",{staticClass:"import-contact__modal-addressbook"},[i("h2",[e._v(e._s(e.t("contacts","Import contacts")))]),e.isSingleAddressbook?e._e():i("NcSelect",{staticClass:"import-contact__modal-addressbook__select",attrs:{id:"select-addressbook","allow-empty":!1,clearable:!1,options:e.options,disabled:e.isSingleAddressbook||e.isImporting,placeholder:e.t("contacts","Contacts"),label:"displayName"},scopedSlots:e._u([{key:"selected-option",fn:function({displayName:a}){return[i("span",[e._v(e._s(e.t("contacts","Import into the {addressbookName} address book",{addressbookName:a})))])]}}],null,!1,3598663645),model:{value:e.selectedAddressbookOption,callback:function(a){e.selectedAddressbookOption=a},expression:"selectedAddressbookOption"}})],1),i("section",{staticClass:"import-contact__modal-pick"},[i("input",{ref:"contact-import-input",staticClass:"hidden-visually",attrs:{id:"contact-import",disabled:e.loading||e.isImporting,type:"file"},on:{change:e.processFile}}),i("Button",{staticClass:"import-contact__button import-contact__button--local",attrs:{disabled:e.loading},on:{click:e.clickImportInput},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconUpload",{attrs:{size:20}})]},proxy:!0}],null,!1,337456192)},[e._v(" "+e._s(e.t("contacts","Select local file"))+" ")]),i("Button",{staticClass:"import-contact__button import-contact__button--files",attrs:{type:"primary",disabled:e.loading},on:{click:e.openPicker},scopedSlots:e._u([{key:"icon",fn:function(){return[e.loading?i("IconLoading",{attrs:{size:20}}):e._e(),i("IconFolder",{attrs:{size:20}})]},proxy:!0}],null,!1,457734779)},[e._v(" "+e._s(e.t("contacts","Import from files"))+" ")])],1)]):e._e()]],2)},Ow=[],Dw=H(Aw,Nw,Ow,!1,null,"540b9ece");const zl=Dw.exports,Lw={name:"FormatListBulletedSquareIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Tw=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon format-list-bulleted-square-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M3,4H7V8H3V4M9,5V7H21V5H9M3,10H7V14H3V10M9,11V13H21V11H9M3,16H7V20H3V16M9,17V19H21V17H9"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Ew=[],Iw=H(Lw,Tw,Ew,!1,null,null);const Pw=Iw.exports,zw={name:"SettingsSortContacts",components:{NcSelect:fn,IconList:Pw},computed:{options(){return[{label:t("contacts","First name"),key:"firstName"},{label:t("contacts","Last name"),key:"lastName"},{label:t("contacts","Phonetic first name"),key:"phoneticFirstName"},{label:t("contacts","Phonetic last name"),key:"phoneticLastName"},{label:t("contacts","Display name"),key:"displayName"},{label:t("contacts","Last modified"),key:"rev"}]},orderKey(){return this.$store.getters.getOrderKey},orderKeyOption(){return this.options.filter(e=>e.key===this.orderKey)[0]}},methods:{sortContacts(e){const i=e&&e.key?e.key:"displayName";this.$store.commit("setOrder",i),this.$store.commit("sortContacts"),localStorage.setItem("orderKey",i)},formatSortByLabel(e){return t("contacts","Sort by {sorting}",{sorting:e.label})}}};var Bw=function(){var e=this,i=e._self._c;return i("div",{staticClass:"sort-contacts"},[i("IconList",{staticClass:"settings-line__icon"}),i("NcSelect",{attrs:{id:"sort-by",value:e.orderKeyOption,searchable:!1,"allow-empty":!1,options:e.options,"custom-label":e.formatSortByLabel,"track-by":"key",label:"label"},on:{input:e.sortContacts}})],1)},$w=[],Rw=H(zw,Bw,$w,!1,null,"8819b273");const Hw=Rw.exports,Yw={name:"ContactsSettings",components:{AppSettingsDialog:vd,AppSettingsSection:zh,SettingsAddressbook:uw,SettingsNewAddressbook:bw,SettingsImportContacts:zl,SettingsSortContacts:Hw,CheckboxRadioSwitch:fi},props:{open:{required:!0,type:Boolean}},data(){return{CONTACTS_SETTINGS:pc,allowSocialSync:hn("contacts","allowSocialSync")!=="no",enableSocialSync:hn("contacts","enableSocialSync")!=="no",enableSocialSyncLoading:!1,showSettings:!1}},computed:{addressbooks(){return this.$store.getters.getAddressbooks}},watch:{showSettings(e){e||this.$emit("update:open",e)},async open(e){e&&await this.onOpen()}},methods:{onClickImport(e){this.$emit("clicked",e)},async toggleSocialSync(){this.enableSocialSync=!this.enableSocialSync,this.enableSocialSyncLoading=!0;let e="yes";this.enableSocialSync?e="yes":e="no";try{await ce.put(ga("apps/contacts/api/v1/social/config/user/enableSocialSync"),{allow:e})}finally{this.enableSocialSyncLoading=!1}},onLoad(){this.$emit("file-loaded",!1)},async onOpen(){this.showSettings=!0}}};var Vw=function(){var e=this,i=e._self._c;return i("AppSettingsDialog",{attrs:{id:"app-settings-dialog",name:e.t("contacts","Contacts settings"),"show-navigation":!0,open:e.showSettings},on:{"update:open":function(a){e.showSettings=a}}},[i("AppSettingsSection",{attrs:{id:"general-settings",name:e.t("contacts","General settings")}},[i("CheckboxRadioSwitch",{staticClass:"social-sync__checkbox contacts-settings-modal__form__row",attrs:{checked:e.enableSocialSync,loading:e.enableSocialSyncLoading,disabled:e.enableSocialSyncLoading},on:{"update:checked":e.toggleSocialSync}},[i("div",{staticClass:"social-sync__checkbox__label"},[i("span",[e._v(" "+e._s(e.t("contacts","Update avatars from social media"))+" "),i("em",[e._v(e._s(e.t("contacts","(refreshed once per week)")))])])])]),i("SettingsSortContacts",{staticClass:"contacts-settings-modal__form__row"})],1),i("AppSettingsSection",{attrs:{id:"address-books",name:e.t("contacts","Address books")}},[i("div",{staticClass:"contacts-settings-modal__form"},[i("div",{staticClass:"contacts-settings-modal__form__row"},[i("ul",{staticClass:"addressbook-list",attrs:{id:"addressbook-list"}},e._l(e.addressbooks,function(a){return i("SettingsAddressbook",{key:a.id,attrs:{addressbook:a}})}),1)]),i("SettingsNewAddressbook",{staticClass:"contacts-settings-modal__form__row settings-new-addressbook",attrs:{addressbooks:e.addressbooks}}),i("SettingsImportContacts",{staticClass:"contacts-settings-modal__form__row",attrs:{addressbooks:e.addressbooks},on:{clicked:e.onClickImport,"file-loaded":e.onLoad}})],1)])],1)},Uw=[],Gw=H(Yw,Vw,Uw,!1,null,"96a6fb67");const Fw=Gw.exports;var Bl={exports:{}};(function(e,i){(function(a,s){e.exports=s()})(Ps,function(){return function a(s,o,r){var c=window,l="application/octet-stream",h=r||l,u=s,m=!o&&!r&&u,g=document.createElement("a"),b=function(it){return String(it)},k=c.Blob||c.MozBlob||c.WebKitBlob||b,A=o||"download",T,B;if(k=k.call?k.bind(c):Blob,String(this)==="true"&&(u=[u,h],h=u[0],u=u[1]),m&&m.length<2048&&(A=m.split("/").pop().split("?")[0],g.href=m,g.href.indexOf(m)!==-1)){var z=new XMLHttpRequest;return z.open("GET",m,!0),z.responseType="blob",z.onload=function(it){a(it.target.response,A,l)},setTimeout(function(){z.send()},0),z}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(u))if(u.length>1024*1024*1.999&&k!==b)u=st(u),h=u.type||l;else return navigator.msSaveBlob?navigator.msSaveBlob(st(u),A):ut(u);else if(/([\x80-\xff])/.test(u)){var j=0,F=new Uint8Array(u.length),X=F.length;for(j;j<X;++j)F[j]=u.charCodeAt(j);u=new k([F],{type:h})}T=u instanceof k?u:new k([u],{type:h});function st(it){var yt=it.split(/[:;,]/),vt=yt[1],_t=yt[2]=="base64"?atob:decodeURIComponent,S=_t(yt.pop()),x=S.length,w=0,y=new Uint8Array(x);for(w;w<x;++w)y[w]=S.charCodeAt(w);return new k([y],{type:vt})}function ut(it,yt){if("download"in g)return g.href=it,g.setAttribute("download",A),g.className="download-js-link",g.innerHTML="downloading...",g.style.display="none",document.body.appendChild(g),setTimeout(function(){g.click(),document.body.removeChild(g),yt===!0&&setTimeout(function(){c.URL.revokeObjectURL(g.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(it)&&(it="data:"+it.replace(/^data:([\w\/\-\+]+)/,l)),window.open(it)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=it),!0;var vt=document.createElement("iframe");document.body.appendChild(vt),!yt&&/^data:/.test(it)&&(it="data:"+it.replace(/^data:([\w\/\-\+]+)/,l)),vt.src=it,setTimeout(function(){document.body.removeChild(vt)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(T,A);if(c.URL)ut(c.URL.createObjectURL(T),!0);else{if(typeof T=="string"||T.constructor===b)try{return ut("data:"+h+";base64,"+c.btoa(T))}catch{return ut("data:"+h+","+encodeURIComponent(T))}B=new FileReader,B.onload=function(it){ut(this.result)},B.readAsDataURL(T)}return!0}})})(Bl);var jw=Bl.exports;const Ww=ma(jw);var $l;function V(){return $l.apply(null,arguments)}function qw(e){$l=e}function le(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function dn(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function lt(e,i){return Object.prototype.hasOwnProperty.call(e,i)}function so(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var i;for(i in e)if(lt(e,i))return!1;return!0}function Ft(e){return e===void 0}function Ie(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function yi(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function Rl(e,i){var a=[],s,o=e.length;for(s=0;s<o;++s)a.push(i(e[s],s));return a}function je(e,i){for(var a in i)lt(i,a)&&(e[a]=i[a]);return lt(i,"toString")&&(e.toString=i.toString),lt(i,"valueOf")&&(e.valueOf=i.valueOf),e}function Ce(e,i,a,s){return nu(e,i,a,s,!0).utc()}function Xw(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function K(e){return e._pf==null&&(e._pf=Xw()),e._pf}var Ms;Array.prototype.some?Ms=Array.prototype.some:Ms=function(e){var i=Object(this),a=i.length>>>0,s;for(s=0;s<a;s++)if(s in i&&e.call(this,i[s],s,i))return!0;return!1};function oo(e){var i=null,a=!1,s=e._d&&!isNaN(e._d.getTime());if(s&&(i=K(e),a=Ms.call(i.parsedDateParts,function(o){return o!=null}),s=i.overflow<0&&!i.empty&&!i.invalidEra&&!i.invalidMonth&&!i.invalidWeekday&&!i.weekdayMismatch&&!i.nullInput&&!i.invalidFormat&&!i.userInvalidated&&(!i.meridiem||i.meridiem&&a),e._strict&&(s=s&&i.charsLeftOver===0&&i.unusedTokens.length===0&&i.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=s;else return s;return e._isValid}function Sa(e){var i=Ce(NaN);return e!=null?je(K(i),e):K(i).userInvalidated=!0,i}var Er=V.momentProperties=[],Ka=!1;function ro(e,i){var a,s,o,r=Er.length;if(Ft(i._isAMomentObject)||(e._isAMomentObject=i._isAMomentObject),Ft(i._i)||(e._i=i._i),Ft(i._f)||(e._f=i._f),Ft(i._l)||(e._l=i._l),Ft(i._strict)||(e._strict=i._strict),Ft(i._tzm)||(e._tzm=i._tzm),Ft(i._isUTC)||(e._isUTC=i._isUTC),Ft(i._offset)||(e._offset=i._offset),Ft(i._pf)||(e._pf=K(i)),Ft(i._locale)||(e._locale=i._locale),r>0)for(a=0;a<r;a++)s=Er[a],o=i[s],Ft(o)||(e[s]=o);return e}function vi(e){ro(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Ka===!1&&(Ka=!0,V.updateOffset(this),Ka=!1)}function ue(e){return e instanceof vi||e!=null&&e._isAMomentObject!=null}function Hl(e){V.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function ee(e,i){var a=!0;return je(function(){if(V.deprecationHandler!=null&&V.deprecationHandler(null,e),a){var s=[],o,r,c,l=arguments.length;for(r=0;r<l;r++){if(o="",typeof arguments[r]=="object"){o+=`
[`+r+"] ";for(c in arguments[0])lt(arguments[0],c)&&(o+=c+": "+arguments[0][c]+", ");o=o.slice(0,-2)}else o=arguments[r];s.push(o)}Hl(e+`
Arguments: `+Array.prototype.slice.call(s).join("")+`
`+new Error().stack),a=!1}return i.apply(this,arguments)},i)}var Ir={};function Yl(e,i){V.deprecationHandler!=null&&V.deprecationHandler(e,i),Ir[e]||(Hl(i),Ir[e]=!0)}V.suppressDeprecationWarnings=!1,V.deprecationHandler=null;function we(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function Zw(e){var i,a;for(a in e)lt(e,a)&&(i=e[a],we(i)?this[a]=i:this["_"+a]=i);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function As(e,i){var a=je({},e),s;for(s in i)lt(i,s)&&(dn(e[s])&&dn(i[s])?(a[s]={},je(a[s],e[s]),je(a[s],i[s])):i[s]!=null?a[s]=i[s]:delete a[s]);for(s in e)lt(e,s)&&!lt(i,s)&&dn(e[s])&&(a[s]=je({},a[s]));return a}function co(e){e!=null&&this.set(e)}var Ns;Object.keys?Ns=Object.keys:Ns=function(e){var i,a=[];for(i in e)lt(e,i)&&a.push(i);return a};var Kw={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Jw(e,i,a){var s=this._calendar[e]||this._calendar.sameElse;return we(s)?s.call(i,a):s}function ge(e,i,a){var s=""+Math.abs(e),o=i-s.length,r=e>=0;return(r?a?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+s}var lo=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Li=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ja={},On={};function W(e,i,a,s){var o=s;typeof s=="string"&&(o=function(){return this[s]()}),e&&(On[e]=o),i&&(On[i[0]]=function(){return ge(o.apply(this,arguments),i[1],i[2])}),a&&(On[a]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function Qw(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function tk(e){var i=e.match(lo),a,s;for(a=0,s=i.length;a<s;a++)On[i[a]]?i[a]=On[i[a]]:i[a]=Qw(i[a]);return function(o){var r="",c;for(c=0;c<s;c++)r+=we(i[c])?i[c].call(o,e):i[c];return r}}function Fi(e,i){return e.isValid()?(i=Vl(i,e.localeData()),Ja[i]=Ja[i]||tk(i),Ja[i](e)):e.localeData().invalidDate()}function Vl(e,i){var a=5;function s(o){return i.longDateFormat(o)||o}for(Li.lastIndex=0;a>=0&&Li.test(e);)e=e.replace(Li,s),Li.lastIndex=0,a-=1;return e}var ek={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function nk(e){var i=this._longDateFormat[e],a=this._longDateFormat[e.toUpperCase()];return i||!a?i:(this._longDateFormat[e]=a.match(lo).map(function(s){return s==="MMMM"||s==="MM"||s==="DD"||s==="dddd"?s.slice(1):s}).join(""),this._longDateFormat[e])}var ik="Invalid date";function ak(){return this._invalidDate}var sk="%d",ok=/\d{1,2}/;function rk(e){return this._ordinal.replace("%d",e)}var ck={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function lk(e,i,a,s){var o=this._relativeTime[a];return we(o)?o(e,i,a,s):o.replace(/%d/i,e)}function uk(e,i){var a=this._relativeTime[e>0?"future":"past"];return we(a)?a(i):a.replace(/%s/i,i)}var Pr={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ie(e){return typeof e=="string"?Pr[e]||Pr[e.toLowerCase()]:void 0}function uo(e){var i={},a,s;for(s in e)lt(e,s)&&(a=ie(s),a&&(i[a]=e[s]));return i}var dk={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function hk(e){var i=[],a;for(a in e)lt(e,a)&&i.push({unit:a,priority:dk[a]});return i.sort(function(s,o){return s.priority-o.priority}),i}var Ul=/\d/,Zt=/\d\d/,Gl=/\d{3}/,Os=/\d{4}/,ra=/[+-]?\d{6}/,bt=/\d\d?/,zr=/\d\d\d\d?/,Br=/\d\d\d\d\d\d?/,ji=/\d{1,3}/,Ds=/\d{1,4}/,ca=/[+-]?\d{1,6}/,Sn=/\d+/,la=/[+-]?\d+/,pk=/Z|[+-]\d\d:?\d\d/gi,Wi=/Z|[+-]\d\d(?::?\d\d)?/gi,fk=/[+-]?\d+(\.\d{1,3})?/,_i=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,zn=/^[1-9]\d?/,ho=/^([1-9]\d|\d)/,ua;ua={};function U(e,i,a){ua[e]=we(i)?i:function(s,o){return s&&a?a:i}}function mk(e,i){return lt(ua,e)?ua[e](i._strict,i._locale):new RegExp(gk(e))}function gk(e){return Le(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(i,a,s,o,r){return a||s||o||r}))}function Le(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function te(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function nt(e){var i=+e,a=0;return i!==0&&isFinite(i)&&(a=te(i)),a}var Ls={};function ft(e,i){var a,s=i,o;for(typeof e=="string"&&(e=[e]),Ie(i)&&(s=function(r,c){c[i]=nt(r)}),o=e.length,a=0;a<o;a++)Ls[e[a]]=s}function li(e,i){ft(e,function(a,s,o,r){o._w=o._w||{},i(a,o._w,o,r)})}function yk(e,i,a){i!=null&&lt(Ls,e)&&Ls[e](i,a._a,a,e)}function Ma(e){return e%4===0&&e%100!==0||e%400===0}var Rt=0,Ne=1,ye=2,Et=3,re=4,Oe=5,ln=6,vk=7,_k=8;W("Y",0,0,function(){var e=this.year();return e<=9999?ge(e,4):"+"+e}),W(0,["YY",2],0,function(){return this.year()%100}),W(0,["YYYY",4],0,"year"),W(0,["YYYYY",5],0,"year"),W(0,["YYYYYY",6,!0],0,"year"),U("Y",la),U("YY",bt,Zt),U("YYYY",Ds,Os),U("YYYYY",ca,ra),U("YYYYYY",ca,ra),ft(["YYYYY","YYYYYY"],Rt),ft("YYYY",function(e,i){i[Rt]=e.length===2?V.parseTwoDigitYear(e):nt(e)}),ft("YY",function(e,i){i[Rt]=V.parseTwoDigitYear(e)}),ft("Y",function(e,i){i[Rt]=parseInt(e,10)});function ni(e){return Ma(e)?366:365}V.parseTwoDigitYear=function(e){return nt(e)+(nt(e)>68?1900:2e3)};var $r=Rn("FullYear",!0);function bk(){return Ma(this.year())}function Rn(e,i){return function(a){return a!=null?(Fl(this,e,a),V.updateOffset(this,i),this):ui(this,e)}}function ui(e,i){if(!e.isValid())return NaN;var a=e._d,s=e._isUTC;switch(i){case"Milliseconds":return s?a.getUTCMilliseconds():a.getMilliseconds();case"Seconds":return s?a.getUTCSeconds():a.getSeconds();case"Minutes":return s?a.getUTCMinutes():a.getMinutes();case"Hours":return s?a.getUTCHours():a.getHours();case"Date":return s?a.getUTCDate():a.getDate();case"Day":return s?a.getUTCDay():a.getDay();case"Month":return s?a.getUTCMonth():a.getMonth();case"FullYear":return s?a.getUTCFullYear():a.getFullYear();default:return NaN}}function Fl(e,i,a){var s,o,r,c,l;if(!(!e.isValid()||isNaN(a))){switch(s=e._d,o=e._isUTC,i){case"Milliseconds":return void(o?s.setUTCMilliseconds(a):s.setMilliseconds(a));case"Seconds":return void(o?s.setUTCSeconds(a):s.setSeconds(a));case"Minutes":return void(o?s.setUTCMinutes(a):s.setMinutes(a));case"Hours":return void(o?s.setUTCHours(a):s.setHours(a));case"Date":return void(o?s.setUTCDate(a):s.setDate(a));case"FullYear":break;default:return}r=a,c=e.month(),l=e.date(),l=l===29&&c===1&&!Ma(r)?28:l,o?s.setUTCFullYear(r,c,l):s.setFullYear(r,c,l)}}function Ck(e){return e=ie(e),we(this[e])?this[e]():this}function wk(e,i){if(typeof e=="object"){e=uo(e);var a=hk(e),s,o=a.length;for(s=0;s<o;s++)this[a[s].unit](e[a[s].unit])}else if(e=ie(e),we(this[e]))return this[e](i);return this}function kk(e,i){return(e%i+i)%i}var At;Array.prototype.indexOf?At=Array.prototype.indexOf:At=function(e){var i;for(i=0;i<this.length;++i)if(this[i]===e)return i;return-1};function po(e,i){if(isNaN(e)||isNaN(i))return NaN;var a=kk(i,12);return e+=(i-a)/12,a===1?Ma(e)?29:28:31-a%7%2}W("M",["MM",2],"Mo",function(){return this.month()+1}),W("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),W("MMMM",0,0,function(e){return this.localeData().months(this,e)}),U("M",bt,zn),U("MM",bt,Zt),U("MMM",function(e,i){return i.monthsShortRegex(e)}),U("MMMM",function(e,i){return i.monthsRegex(e)}),ft(["M","MM"],function(e,i){i[Ne]=nt(e)-1}),ft(["MMM","MMMM"],function(e,i,a,s){var o=a._locale.monthsParse(e,s,a._strict);o!=null?i[Ne]=o:K(a).invalidMonth=e});var xk="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),jl="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Wl=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Sk=_i,Mk=_i;function Ak(e,i){return e?le(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Wl).test(i)?"format":"standalone"][e.month()]:le(this._months)?this._months:this._months.standalone}function Nk(e,i){return e?le(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Wl.test(i)?"format":"standalone"][e.month()]:le(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Ok(e,i,a){var s,o,r,c=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=Ce([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return a?i==="MMM"?(o=At.call(this._shortMonthsParse,c),o!==-1?o:null):(o=At.call(this._longMonthsParse,c),o!==-1?o:null):i==="MMM"?(o=At.call(this._shortMonthsParse,c),o!==-1?o:(o=At.call(this._longMonthsParse,c),o!==-1?o:null)):(o=At.call(this._longMonthsParse,c),o!==-1?o:(o=At.call(this._shortMonthsParse,c),o!==-1?o:null))}function Dk(e,i,a){var s,o,r;if(this._monthsParseExact)return Ok.call(this,e,i,a);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++)if(o=Ce([2e3,s]),a&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!a&&!this._monthsParse[s]&&(r="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),a&&i==="MMMM"&&this._longMonthsParse[s].test(e)||a&&i==="MMM"&&this._shortMonthsParse[s].test(e)||!a&&this._monthsParse[s].test(e))return s}function ql(e,i){if(!e.isValid())return e;if(typeof i=="string"){if(/^\d+$/.test(i))i=nt(i);else if(i=e.localeData().monthsParse(i),!Ie(i))return e}var a=i,s=e.date();return s=s<29?s:Math.min(s,po(e.year(),a)),e._isUTC?e._d.setUTCMonth(a,s):e._d.setMonth(a,s),e}function Rr(e){return e!=null?(ql(this,e),V.updateOffset(this,!0),this):ui(this,"Month")}function Lk(){return po(this.year(),this.month())}function Tk(e){return this._monthsParseExact?(lt(this,"_monthsRegex")||Xl.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(lt(this,"_monthsShortRegex")||(this._monthsShortRegex=Sk),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Ek(e){return this._monthsParseExact?(lt(this,"_monthsRegex")||Xl.call(this),e?this._monthsStrictRegex:this._monthsRegex):(lt(this,"_monthsRegex")||(this._monthsRegex=Mk),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function Xl(){function e(h,u){return u.length-h.length}var i=[],a=[],s=[],o,r,c,l;for(o=0;o<12;o++)r=Ce([2e3,o]),c=Le(this.monthsShort(r,"")),l=Le(this.months(r,"")),i.push(c),a.push(l),s.push(l),s.push(c);i.sort(e),a.sort(e),s.sort(e),this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function Ik(e,i,a,s,o,r,c){var l;return e<100&&e>=0?(l=new Date(e+400,i,a,s,o,r,c),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,i,a,s,o,r,c),l}function di(e){var i,a;return e<100&&e>=0?(a=Array.prototype.slice.call(arguments),a[0]=e+400,i=new Date(Date.UTC.apply(null,a)),isFinite(i.getUTCFullYear())&&i.setUTCFullYear(e)):i=new Date(Date.UTC.apply(null,arguments)),i}function da(e,i,a){var s=7+i-a,o=(7+di(e,0,s).getUTCDay()-i)%7;return-o+s-1}function Zl(e,i,a,s,o){var r=(7+a-s)%7,c=da(e,s,o),l=1+7*(i-1)+r+c,h,u;return l<=0?(h=e-1,u=ni(h)+l):l>ni(e)?(h=e+1,u=l-ni(e)):(h=e,u=l),{year:h,dayOfYear:u}}function hi(e,i,a){var s=da(e.year(),i,a),o=Math.floor((e.dayOfYear()-s-1)/7)+1,r,c;return o<1?(c=e.year()-1,r=o+Te(c,i,a)):o>Te(e.year(),i,a)?(r=o-Te(e.year(),i,a),c=e.year()+1):(c=e.year(),r=o),{week:r,year:c}}function Te(e,i,a){var s=da(e,i,a),o=da(e+1,i,a);return(ni(e)-s+o)/7}W("w",["ww",2],"wo","week"),W("W",["WW",2],"Wo","isoWeek"),U("w",bt,zn),U("ww",bt,Zt),U("W",bt,zn),U("WW",bt,Zt),li(["w","ww","W","WW"],function(e,i,a,s){i[s.substr(0,1)]=nt(e)});function Pk(e){return hi(e,this._week.dow,this._week.doy).week}var zk={dow:0,doy:6};function Bk(){return this._week.dow}function $k(){return this._week.doy}function Rk(e){var i=this.localeData().week(this);return e==null?i:this.add((e-i)*7,"d")}function Hk(e){var i=hi(this,1,4).week;return e==null?i:this.add((e-i)*7,"d")}W("d",0,"do","day"),W("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),W("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),W("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),W("e",0,0,"weekday"),W("E",0,0,"isoWeekday"),U("d",bt),U("e",bt),U("E",bt),U("dd",function(e,i){return i.weekdaysMinRegex(e)}),U("ddd",function(e,i){return i.weekdaysShortRegex(e)}),U("dddd",function(e,i){return i.weekdaysRegex(e)}),li(["dd","ddd","dddd"],function(e,i,a,s){var o=a._locale.weekdaysParse(e,s,a._strict);o!=null?i.d=o:K(a).invalidWeekday=e}),li(["d","e","E"],function(e,i,a,s){i[s]=nt(e)});function Yk(e,i){return typeof e!="string"?e:isNaN(e)?(e=i.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Vk(e,i){return typeof e=="string"?i.weekdaysParse(e)%7||7:isNaN(e)?null:e}function fo(e,i){return e.slice(i,7).concat(e.slice(0,i))}var Uk="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Kl="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Gk="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Fk=_i,jk=_i,Wk=_i;function qk(e,i){var a=le(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(i)?"format":"standalone"];return e===!0?fo(a,this._week.dow):e?a[e.day()]:a}function Xk(e){return e===!0?fo(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Zk(e){return e===!0?fo(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Kk(e,i,a){var s,o,r,c=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=Ce([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return a?i==="dddd"?(o=At.call(this._weekdaysParse,c),o!==-1?o:null):i==="ddd"?(o=At.call(this._shortWeekdaysParse,c),o!==-1?o:null):(o=At.call(this._minWeekdaysParse,c),o!==-1?o:null):i==="dddd"?(o=At.call(this._weekdaysParse,c),o!==-1||(o=At.call(this._shortWeekdaysParse,c),o!==-1)?o:(o=At.call(this._minWeekdaysParse,c),o!==-1?o:null)):i==="ddd"?(o=At.call(this._shortWeekdaysParse,c),o!==-1||(o=At.call(this._weekdaysParse,c),o!==-1)?o:(o=At.call(this._minWeekdaysParse,c),o!==-1?o:null)):(o=At.call(this._minWeekdaysParse,c),o!==-1||(o=At.call(this._weekdaysParse,c),o!==-1)?o:(o=At.call(this._shortWeekdaysParse,c),o!==-1?o:null))}function Jk(e,i,a){var s,o,r;if(this._weekdaysParseExact)return Kk.call(this,e,i,a);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++)if(o=Ce([2e3,1]).day(s),a&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),a&&i==="dddd"&&this._fullWeekdaysParse[s].test(e)||a&&i==="ddd"&&this._shortWeekdaysParse[s].test(e)||a&&i==="dd"&&this._minWeekdaysParse[s].test(e)||!a&&this._weekdaysParse[s].test(e))return s}function Qk(e){if(!this.isValid())return e!=null?this:NaN;var i=ui(this,"Day");return e!=null?(e=Yk(e,this.localeData()),this.add(e-i,"d")):i}function t5(e){if(!this.isValid())return e!=null?this:NaN;var i=(this.day()+7-this.localeData()._week.dow)%7;return e==null?i:this.add(e-i,"d")}function e5(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var i=Vk(e,this.localeData());return this.day(this.day()%7?i:i-7)}else return this.day()||7}function n5(e){return this._weekdaysParseExact?(lt(this,"_weekdaysRegex")||mo.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(lt(this,"_weekdaysRegex")||(this._weekdaysRegex=Fk),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function i5(e){return this._weekdaysParseExact?(lt(this,"_weekdaysRegex")||mo.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(lt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=jk),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function a5(e){return this._weekdaysParseExact?(lt(this,"_weekdaysRegex")||mo.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(lt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Wk),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function mo(){function e(m,g){return g.length-m.length}var i=[],a=[],s=[],o=[],r,c,l,h,u;for(r=0;r<7;r++)c=Ce([2e3,1]).day(r),l=Le(this.weekdaysMin(c,"")),h=Le(this.weekdaysShort(c,"")),u=Le(this.weekdays(c,"")),i.push(l),a.push(h),s.push(u),o.push(l),o.push(h),o.push(u);i.sort(e),a.sort(e),s.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+i.join("|")+")","i")}function Qa(){return this.hours()%12||12}function s5(){return this.hours()||24}W("H",["HH",2],0,"hour"),W("h",["hh",2],0,Qa),W("k",["kk",2],0,s5),W("hmm",0,0,function(){return""+Qa.apply(this)+ge(this.minutes(),2)}),W("hmmss",0,0,function(){return""+Qa.apply(this)+ge(this.minutes(),2)+ge(this.seconds(),2)}),W("Hmm",0,0,function(){return""+this.hours()+ge(this.minutes(),2)}),W("Hmmss",0,0,function(){return""+this.hours()+ge(this.minutes(),2)+ge(this.seconds(),2)});function Hr(e,i){W(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),i)})}Hr("a",!0),Hr("A",!1);function Yr(e,i){return i._meridiemParse}U("a",Yr),U("A",Yr),U("H",bt,ho),U("h",bt,zn),U("k",bt,zn),U("HH",bt,Zt),U("hh",bt,Zt),U("kk",bt,Zt),U("hmm",zr),U("hmmss",Br),U("Hmm",zr),U("Hmmss",Br),ft(["H","HH"],Et),ft(["k","kk"],function(e,i,a){var s=nt(e);i[Et]=s===24?0:s}),ft(["a","A"],function(e,i,a){a._isPm=a._locale.isPM(e),a._meridiem=e}),ft(["h","hh"],function(e,i,a){i[Et]=nt(e),K(a).bigHour=!0}),ft("hmm",function(e,i,a){var s=e.length-2;i[Et]=nt(e.substr(0,s)),i[re]=nt(e.substr(s)),K(a).bigHour=!0}),ft("hmmss",function(e,i,a){var s=e.length-4,o=e.length-2;i[Et]=nt(e.substr(0,s)),i[re]=nt(e.substr(s,2)),i[Oe]=nt(e.substr(o)),K(a).bigHour=!0}),ft("Hmm",function(e,i,a){var s=e.length-2;i[Et]=nt(e.substr(0,s)),i[re]=nt(e.substr(s))}),ft("Hmmss",function(e,i,a){var s=e.length-4,o=e.length-2;i[Et]=nt(e.substr(0,s)),i[re]=nt(e.substr(s,2)),i[Oe]=nt(e.substr(o))});function o5(e){return(e+"").toLowerCase().charAt(0)==="p"}var r5=/[ap]\.?m?\.?/i,c5=Rn("Hours",!0);function l5(e,i,a){return e>11?a?"pm":"PM":a?"am":"AM"}var Jl={calendar:Kw,longDateFormat:ek,invalidDate:ik,ordinal:sk,dayOfMonthOrdinalParse:ok,relativeTime:ck,months:xk,monthsShort:jl,week:zk,weekdays:Uk,weekdaysMin:Gk,weekdaysShort:Kl,meridiemParse:r5},kt={},Xn={},pi;function u5(e,i){var a,s=Math.min(e.length,i.length);for(a=0;a<s;a+=1)if(e[a]!==i[a])return a;return s}function Vr(e){return e&&e.toLowerCase().replace("_","-")}function d5(e){for(var i=0,a,s,o,r;i<e.length;){for(r=Vr(e[i]).split("-"),a=r.length,s=Vr(e[i+1]),s=s?s.split("-"):null;a>0;){if(o=Aa(r.slice(0,a).join("-")),o)return o;if(s&&s.length>=a&&u5(r,s)>=a-1)break;a--}i++}return pi}function h5(e){return!!(e&&e.match("^[^/\\\\]*$"))}function Aa(e){var i=null,a;if(kt[e]===void 0&&typeof module<"u"&&module&&module.exports&&h5(e))try{i=pi._abbr,a=require,a("./locale/"+e),qe(i)}catch{kt[e]=null}return kt[e]}function qe(e,i){var a;return e&&(Ft(i)?a=ze(e):a=go(e,i),a?pi=a:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),pi._abbr}function go(e,i){if(i!==null){var a,s=Jl;if(i.abbr=e,kt[e]!=null)Yl("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=kt[e]._config;else if(i.parentLocale!=null)if(kt[i.parentLocale]!=null)s=kt[i.parentLocale]._config;else if(a=Aa(i.parentLocale),a!=null)s=a._config;else return Xn[i.parentLocale]||(Xn[i.parentLocale]=[]),Xn[i.parentLocale].push({name:e,config:i}),null;return kt[e]=new co(As(s,i)),Xn[e]&&Xn[e].forEach(function(o){go(o.name,o.config)}),qe(e),kt[e]}else return delete kt[e],null}function p5(e,i){if(i!=null){var a,s,o=Jl;kt[e]!=null&&kt[e].parentLocale!=null?kt[e].set(As(kt[e]._config,i)):(s=Aa(e),s!=null&&(o=s._config),i=As(o,i),s==null&&(i.abbr=e),a=new co(i),a.parentLocale=kt[e],kt[e]=a),qe(e)}else kt[e]!=null&&(kt[e].parentLocale!=null?(kt[e]=kt[e].parentLocale,e===qe()&&qe(e)):kt[e]!=null&&delete kt[e]);return kt[e]}function ze(e){var i;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return pi;if(!le(e)){if(i=Aa(e),i)return i;e=[e]}return d5(e)}function f5(){return Ns(kt)}function yo(e){var i,a=e._a;return a&&K(e).overflow===-2&&(i=a[Ne]<0||a[Ne]>11?Ne:a[ye]<1||a[ye]>po(a[Rt],a[Ne])?ye:a[Et]<0||a[Et]>24||a[Et]===24&&(a[re]!==0||a[Oe]!==0||a[ln]!==0)?Et:a[re]<0||a[re]>59?re:a[Oe]<0||a[Oe]>59?Oe:a[ln]<0||a[ln]>999?ln:-1,K(e)._overflowDayOfYear&&(i<Rt||i>ye)&&(i=ye),K(e)._overflowWeeks&&i===-1&&(i=vk),K(e)._overflowWeekday&&i===-1&&(i=_k),K(e).overflow=i),e}var m5=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,g5=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,y5=/Z|[+-]\d\d(?::?\d\d)?/,Ti=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ts=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],v5=/^\/?Date\((-?\d+)/i,_5=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,b5={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Ql(e){var i,a,s=e._i,o=m5.exec(s)||g5.exec(s),r,c,l,h,u=Ti.length,m=ts.length;if(o){for(K(e).iso=!0,i=0,a=u;i<a;i++)if(Ti[i][1].exec(o[1])){c=Ti[i][0],r=Ti[i][2]!==!1;break}if(c==null){e._isValid=!1;return}if(o[3]){for(i=0,a=m;i<a;i++)if(ts[i][1].exec(o[3])){l=(o[2]||" ")+ts[i][0];break}if(l==null){e._isValid=!1;return}}if(!r&&l!=null){e._isValid=!1;return}if(o[4])if(y5.exec(o[4]))h="Z";else{e._isValid=!1;return}e._f=c+(l||"")+(h||""),_o(e)}else e._isValid=!1}function C5(e,i,a,s,o,r){var c=[w5(e),jl.indexOf(i),parseInt(a,10),parseInt(s,10),parseInt(o,10)];return r&&c.push(parseInt(r,10)),c}function w5(e){var i=parseInt(e,10);return i<=49?2e3+i:i<=999?1900+i:i}function k5(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function x5(e,i,a){if(e){var s=Kl.indexOf(e),o=new Date(i[0],i[1],i[2]).getDay();if(s!==o)return K(a).weekdayMismatch=!0,a._isValid=!1,!1}return!0}function S5(e,i,a){if(e)return b5[e];if(i)return 0;var s=parseInt(a,10),o=s%100,r=(s-o)/100;return r*60+o}function tu(e){var i=_5.exec(k5(e._i)),a;if(i){if(a=C5(i[4],i[3],i[2],i[5],i[6],i[7]),!x5(i[1],a,e))return;e._a=a,e._tzm=S5(i[8],i[9],i[10]),e._d=di.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),K(e).rfc2822=!0}else e._isValid=!1}function M5(e){var i=v5.exec(e._i);if(i!==null){e._d=new Date(+i[1]);return}if(Ql(e),e._isValid===!1)delete e._isValid;else return;if(tu(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:V.createFromInputFallback(e)}V.createFromInputFallback=ee("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function xn(e,i,a){return e??i??a}function A5(e){var i=new Date(V.now());return e._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()]}function vo(e){var i,a,s=[],o,r,c;if(!e._d){for(o=A5(e),e._w&&e._a[ye]==null&&e._a[Ne]==null&&N5(e),e._dayOfYear!=null&&(c=xn(e._a[Rt],o[Rt]),(e._dayOfYear>ni(c)||e._dayOfYear===0)&&(K(e)._overflowDayOfYear=!0),a=di(c,0,e._dayOfYear),e._a[Ne]=a.getUTCMonth(),e._a[ye]=a.getUTCDate()),i=0;i<3&&e._a[i]==null;++i)e._a[i]=s[i]=o[i];for(;i<7;i++)e._a[i]=s[i]=e._a[i]==null?i===2?1:0:e._a[i];e._a[Et]===24&&e._a[re]===0&&e._a[Oe]===0&&e._a[ln]===0&&(e._nextDay=!0,e._a[Et]=0),e._d=(e._useUTC?di:Ik).apply(null,s),r=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Et]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==r&&(K(e).weekdayMismatch=!0)}}function N5(e){var i,a,s,o,r,c,l,h,u;i=e._w,i.GG!=null||i.W!=null||i.E!=null?(r=1,c=4,a=xn(i.GG,e._a[Rt],hi(Ct(),1,4).year),s=xn(i.W,1),o=xn(i.E,1),(o<1||o>7)&&(h=!0)):(r=e._locale._week.dow,c=e._locale._week.doy,u=hi(Ct(),r,c),a=xn(i.gg,e._a[Rt],u.year),s=xn(i.w,u.week),i.d!=null?(o=i.d,(o<0||o>6)&&(h=!0)):i.e!=null?(o=i.e+r,(i.e<0||i.e>6)&&(h=!0)):o=r),s<1||s>Te(a,r,c)?K(e)._overflowWeeks=!0:h!=null?K(e)._overflowWeekday=!0:(l=Zl(a,s,o,r,c),e._a[Rt]=l.year,e._dayOfYear=l.dayOfYear)}V.ISO_8601=function(){},V.RFC_2822=function(){};function _o(e){if(e._f===V.ISO_8601){Ql(e);return}if(e._f===V.RFC_2822){tu(e);return}e._a=[],K(e).empty=!0;var i=""+e._i,a,s,o,r,c,l=i.length,h=0,u,m;for(o=Vl(e._f,e._locale).match(lo)||[],m=o.length,a=0;a<m;a++)r=o[a],s=(i.match(mk(r,e))||[])[0],s&&(c=i.substr(0,i.indexOf(s)),c.length>0&&K(e).unusedInput.push(c),i=i.slice(i.indexOf(s)+s.length),h+=s.length),On[r]?(s?K(e).empty=!1:K(e).unusedTokens.push(r),yk(r,s,e)):e._strict&&!s&&K(e).unusedTokens.push(r);K(e).charsLeftOver=l-h,i.length>0&&K(e).unusedInput.push(i),e._a[Et]<=12&&K(e).bigHour===!0&&e._a[Et]>0&&(K(e).bigHour=void 0),K(e).parsedDateParts=e._a.slice(0),K(e).meridiem=e._meridiem,e._a[Et]=O5(e._locale,e._a[Et],e._meridiem),u=K(e).era,u!==null&&(e._a[Rt]=e._locale.erasConvertYear(u,e._a[Rt])),vo(e),yo(e)}function O5(e,i,a){var s;return a==null?i:e.meridiemHour!=null?e.meridiemHour(i,a):(e.isPM!=null&&(s=e.isPM(a),s&&i<12&&(i+=12),!s&&i===12&&(i=0)),i)}function D5(e){var i,a,s,o,r,c,l=!1,h=e._f.length;if(h===0){K(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<h;o++)r=0,c=!1,i=ro({},e),e._useUTC!=null&&(i._useUTC=e._useUTC),i._f=e._f[o],_o(i),oo(i)&&(c=!0),r+=K(i).charsLeftOver,r+=K(i).unusedTokens.length*10,K(i).score=r,l?r<s&&(s=r,a=i):(s==null||r<s||c)&&(s=r,a=i,c&&(l=!0));je(e,a||i)}function L5(e){if(!e._d){var i=uo(e._i),a=i.day===void 0?i.date:i.day;e._a=Rl([i.year,i.month,a,i.hour,i.minute,i.second,i.millisecond],function(s){return s&&parseInt(s,10)}),vo(e)}}function T5(e){var i=new vi(yo(eu(e)));return i._nextDay&&(i.add(1,"d"),i._nextDay=void 0),i}function eu(e){var i=e._i,a=e._f;return e._locale=e._locale||ze(e._l),i===null||a===void 0&&i===""?Sa({nullInput:!0}):(typeof i=="string"&&(e._i=i=e._locale.preparse(i)),ue(i)?new vi(yo(i)):(yi(i)?e._d=i:le(a)?D5(e):a?_o(e):E5(e),oo(e)||(e._d=null),e))}function E5(e){var i=e._i;Ft(i)?e._d=new Date(V.now()):yi(i)?e._d=new Date(i.valueOf()):typeof i=="string"?M5(e):le(i)?(e._a=Rl(i.slice(0),function(a){return parseInt(a,10)}),vo(e)):dn(i)?L5(e):Ie(i)?e._d=new Date(i):V.createFromInputFallback(e)}function nu(e,i,a,s,o){var r={};return(i===!0||i===!1)&&(s=i,i=void 0),(a===!0||a===!1)&&(s=a,a=void 0),(dn(e)&&so(e)||le(e)&&e.length===0)&&(e=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=o,r._l=a,r._i=e,r._f=i,r._strict=s,T5(r)}function Ct(e,i,a,s){return nu(e,i,a,s,!1)}var I5=ee("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ct.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Sa()}),P5=ee("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ct.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Sa()});function iu(e,i){var a,s;if(i.length===1&&le(i[0])&&(i=i[0]),!i.length)return Ct();for(a=i[0],s=1;s<i.length;++s)(!i[s].isValid()||i[s][e](a))&&(a=i[s]);return a}function z5(){var e=[].slice.call(arguments,0);return iu("isBefore",e)}function B5(){var e=[].slice.call(arguments,0);return iu("isAfter",e)}var $5=function(){return Date.now?Date.now():+new Date},Zn=["year","quarter","month","week","day","hour","minute","second","millisecond"];function R5(e){var i,a=!1,s,o=Zn.length;for(i in e)if(lt(e,i)&&!(At.call(Zn,i)!==-1&&(e[i]==null||!isNaN(e[i]))))return!1;for(s=0;s<o;++s)if(e[Zn[s]]){if(a)return!1;parseFloat(e[Zn[s]])!==nt(e[Zn[s]])&&(a=!0)}return!0}function H5(){return this._isValid}function Y5(){return de(NaN)}function Na(e){var i=uo(e),a=i.year||0,s=i.quarter||0,o=i.month||0,r=i.week||i.isoWeek||0,c=i.day||0,l=i.hour||0,h=i.minute||0,u=i.second||0,m=i.millisecond||0;this._isValid=R5(i),this._milliseconds=+m+u*1e3+h*6e4+l*1e3*60*60,this._days=+c+r*7,this._months=+o+s*3+a*12,this._data={},this._locale=ze(),this._bubble()}function qi(e){return e instanceof Na}function Ts(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function V5(e,i,a){var s=Math.min(e.length,i.length),o=Math.abs(e.length-i.length),r=0,c;for(c=0;c<s;c++)nt(e[c])!==nt(i[c])&&r++;return r+o}function Ur(e,i){W(e,0,0,function(){var a=this.utcOffset(),s="+";return a<0&&(a=-a,s="-"),s+ge(~~(a/60),2)+i+ge(~~a%60,2)})}Ur("Z",":"),Ur("ZZ",""),U("Z",Wi),U("ZZ",Wi),ft(["Z","ZZ"],function(e,i,a){a._useUTC=!0,a._tzm=bo(Wi,e)});var U5=/([\+\-]|\d\d)/gi;function bo(e,i){var a=(i||"").match(e),s,o,r;return a===null?null:(s=a[a.length-1]||[],o=(s+"").match(U5)||["-",0,0],r=+(o[1]*60)+nt(o[2]),r===0?0:o[0]==="+"?r:-r)}function Co(e,i){var a,s;return i._isUTC?(a=i.clone(),s=(ue(e)||yi(e)?e.valueOf():Ct(e).valueOf())-a.valueOf(),a._d.setTime(a._d.valueOf()+s),V.updateOffset(a,!1),a):Ct(e).local()}function Es(e){return-Math.round(e._d.getTimezoneOffset())}V.updateOffset=function(){};function G5(e,i,a){var s=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=bo(Wi,e),e===null)return this}else Math.abs(e)<16&&!a&&(e=e*60);return!this._isUTC&&i&&(o=Es(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),s!==e&&(!i||this._changeInProgress?su(this,de(e-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,V.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?s:Es(this)}function F5(e,i){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,i),this):-this.utcOffset()}function j5(e){return this.utcOffset(0,e)}function W5(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Es(this),"m")),this}function q5(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=bo(pk,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function X5(e){return this.isValid()?(e=e?Ct(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Z5(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function K5(){if(!Ft(this._isDSTShifted))return this._isDSTShifted;var e={},i;return ro(e,this),e=eu(e),e._a?(i=e._isUTC?Ce(e._a):Ct(e._a),this._isDSTShifted=this.isValid()&&V5(e._a,i.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function J5(){return this.isValid()?!this._isUTC:!1}function Q5(){return this.isValid()?this._isUTC:!1}function Gr(){return this.isValid()?this._isUTC&&this._offset===0:!1}var t4=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,e4=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function de(e,i){var a=e,s=null,o,r,c;return qi(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:Ie(e)||!isNaN(+e)?(a={},i?a[i]=+e:a.milliseconds=+e):(s=t4.exec(e))?(o=s[1]==="-"?-1:1,a={y:0,d:nt(s[ye])*o,h:nt(s[Et])*o,m:nt(s[re])*o,s:nt(s[Oe])*o,ms:nt(Ts(s[ln]*1e3))*o}):(s=e4.exec(e))?(o=s[1]==="-"?-1:1,a={y:on(s[2],o),M:on(s[3],o),w:on(s[4],o),d:on(s[5],o),h:on(s[6],o),m:on(s[7],o),s:on(s[8],o)}):a==null?a={}:typeof a=="object"&&("from"in a||"to"in a)&&(c=n4(Ct(a.from),Ct(a.to)),a={},a.ms=c.milliseconds,a.M=c.months),r=new Na(a),qi(e)&&lt(e,"_locale")&&(r._locale=e._locale),qi(e)&&lt(e,"_isValid")&&(r._isValid=e._isValid),r}de.fn=Na.prototype,de.invalid=Y5;function on(e,i){var a=e&&parseFloat(e.replace(",","."));return(isNaN(a)?0:a)*i}function Fr(e,i){var a={};return a.months=i.month()-e.month()+(i.year()-e.year())*12,e.clone().add(a.months,"M").isAfter(i)&&--a.months,a.milliseconds=+i-+e.clone().add(a.months,"M"),a}function n4(e,i){var a;return e.isValid()&&i.isValid()?(i=Co(i,e),e.isBefore(i)?a=Fr(e,i):(a=Fr(i,e),a.milliseconds=-a.milliseconds,a.months=-a.months),a):{milliseconds:0,months:0}}function au(e,i){return function(a,s){var o,r;return s!==null&&!isNaN(+s)&&(Yl(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=a,a=s,s=r),o=de(a,s),su(this,o,e),this}}function su(e,i,a,s){var o=i._milliseconds,r=Ts(i._days),c=Ts(i._months);e.isValid()&&(s=s??!0,c&&ql(e,ui(e,"Month")+c*a),r&&Fl(e,"Date",ui(e,"Date")+r*a),o&&e._d.setTime(e._d.valueOf()+o*a),s&&V.updateOffset(e,r||c))}var i4=au(1,"add"),a4=au(-1,"subtract");function ou(e){return typeof e=="string"||e instanceof String}function s4(e){return ue(e)||yi(e)||ou(e)||Ie(e)||r4(e)||o4(e)||e===null||e===void 0}function o4(e){var i=dn(e)&&!so(e),a=!1,s=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,r,c=s.length;for(o=0;o<c;o+=1)r=s[o],a=a||lt(e,r);return i&&a}function r4(e){var i=le(e),a=!1;return i&&(a=e.filter(function(s){return!Ie(s)&&ou(e)}).length===0),i&&a}function c4(e){var i=dn(e)&&!so(e),a=!1,s=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,r;for(o=0;o<s.length;o+=1)r=s[o],a=a||lt(e,r);return i&&a}function l4(e,i){var a=e.diff(i,"days",!0);return a<-6?"sameElse":a<-1?"lastWeek":a<0?"lastDay":a<1?"sameDay":a<2?"nextDay":a<7?"nextWeek":"sameElse"}function u4(e,i){arguments.length===1&&(arguments[0]?s4(arguments[0])?(e=arguments[0],i=void 0):c4(arguments[0])&&(i=arguments[0],e=void 0):(e=void 0,i=void 0));var a=e||Ct(),s=Co(a,this).startOf("day"),o=V.calendarFormat(this,s)||"sameElse",r=i&&(we(i[o])?i[o].call(this,a):i[o]);return this.format(r||this.localeData().calendar(o,this,Ct(a)))}function d4(){return new vi(this)}function h4(e,i){var a=ue(e)?e:Ct(e);return this.isValid()&&a.isValid()?(i=ie(i)||"millisecond",i==="millisecond"?this.valueOf()>a.valueOf():a.valueOf()<this.clone().startOf(i).valueOf()):!1}function p4(e,i){var a=ue(e)?e:Ct(e);return this.isValid()&&a.isValid()?(i=ie(i)||"millisecond",i==="millisecond"?this.valueOf()<a.valueOf():this.clone().endOf(i).valueOf()<a.valueOf()):!1}function f4(e,i,a,s){var o=ue(e)?e:Ct(e),r=ue(i)?i:Ct(i);return this.isValid()&&o.isValid()&&r.isValid()?(s=s||"()",(s[0]==="("?this.isAfter(o,a):!this.isBefore(o,a))&&(s[1]===")"?this.isBefore(r,a):!this.isAfter(r,a))):!1}function m4(e,i){var a=ue(e)?e:Ct(e),s;return this.isValid()&&a.isValid()?(i=ie(i)||"millisecond",i==="millisecond"?this.valueOf()===a.valueOf():(s=a.valueOf(),this.clone().startOf(i).valueOf()<=s&&s<=this.clone().endOf(i).valueOf())):!1}function g4(e,i){return this.isSame(e,i)||this.isAfter(e,i)}function y4(e,i){return this.isSame(e,i)||this.isBefore(e,i)}function v4(e,i,a){var s,o,r;if(!this.isValid())return NaN;if(s=Co(e,this),!s.isValid())return NaN;switch(o=(s.utcOffset()-this.utcOffset())*6e4,i=ie(i),i){case"year":r=Xi(this,s)/12;break;case"month":r=Xi(this,s);break;case"quarter":r=Xi(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-o)/864e5;break;case"week":r=(this-s-o)/6048e5;break;default:r=this-s}return a?r:te(r)}function Xi(e,i){if(e.date()<i.date())return-Xi(i,e);var a=(i.year()-e.year())*12+(i.month()-e.month()),s=e.clone().add(a,"months"),o,r;return i-s<0?(o=e.clone().add(a-1,"months"),r=(i-s)/(s-o)):(o=e.clone().add(a+1,"months"),r=(i-s)/(o-s)),-(a+r)||0}V.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",V.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function _4(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function b4(e){if(!this.isValid())return null;var i=e!==!0,a=i?this.clone().utc():this;return a.year()<0||a.year()>9999?Fi(a,i?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):we(Date.prototype.toISOString)?i?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Fi(a,"Z")):Fi(a,i?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function C4(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",i="",a,s,o,r;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",i="Z"),a="["+e+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",r=i+'[")]',this.format(a+s+o+r)}function w4(e){e||(e=this.isUtc()?V.defaultFormatUtc:V.defaultFormat);var i=Fi(this,e);return this.localeData().postformat(i)}function k4(e,i){return this.isValid()&&(ue(e)&&e.isValid()||Ct(e).isValid())?de({to:this,from:e}).locale(this.locale()).humanize(!i):this.localeData().invalidDate()}function x4(e){return this.from(Ct(),e)}function S4(e,i){return this.isValid()&&(ue(e)&&e.isValid()||Ct(e).isValid())?de({from:this,to:e}).locale(this.locale()).humanize(!i):this.localeData().invalidDate()}function M4(e){return this.to(Ct(),e)}function ru(e){var i;return e===void 0?this._locale._abbr:(i=ze(e),i!=null&&(this._locale=i),this)}var cu=ee("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function lu(){return this._locale}var ha=1e3,Dn=60*ha,pa=60*Dn,uu=(365*400+97)*24*pa;function Ln(e,i){return(e%i+i)%i}function du(e,i,a){return e<100&&e>=0?new Date(e+400,i,a)-uu:new Date(e,i,a).valueOf()}function hu(e,i,a){return e<100&&e>=0?Date.UTC(e+400,i,a)-uu:Date.UTC(e,i,a)}function A4(e){var i,a;if(e=ie(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(a=this._isUTC?hu:du,e){case"year":i=a(this.year(),0,1);break;case"quarter":i=a(this.year(),this.month()-this.month()%3,1);break;case"month":i=a(this.year(),this.month(),1);break;case"week":i=a(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":i=a(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":i=a(this.year(),this.month(),this.date());break;case"hour":i=this._d.valueOf(),i-=Ln(i+(this._isUTC?0:this.utcOffset()*Dn),pa);break;case"minute":i=this._d.valueOf(),i-=Ln(i,Dn);break;case"second":i=this._d.valueOf(),i-=Ln(i,ha);break}return this._d.setTime(i),V.updateOffset(this,!0),this}function N4(e){var i,a;if(e=ie(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(a=this._isUTC?hu:du,e){case"year":i=a(this.year()+1,0,1)-1;break;case"quarter":i=a(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":i=a(this.year(),this.month()+1,1)-1;break;case"week":i=a(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":i=a(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":i=a(this.year(),this.month(),this.date()+1)-1;break;case"hour":i=this._d.valueOf(),i+=pa-Ln(i+(this._isUTC?0:this.utcOffset()*Dn),pa)-1;break;case"minute":i=this._d.valueOf(),i+=Dn-Ln(i,Dn)-1;break;case"second":i=this._d.valueOf(),i+=ha-Ln(i,ha)-1;break}return this._d.setTime(i),V.updateOffset(this,!0),this}function O4(){return this._d.valueOf()-(this._offset||0)*6e4}function D4(){return Math.floor(this.valueOf()/1e3)}function L4(){return new Date(this.valueOf())}function T4(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function E4(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function I4(){return this.isValid()?this.toISOString():null}function P4(){return oo(this)}function z4(){return je({},K(this))}function B4(){return K(this).overflow}function $4(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}W("N",0,0,"eraAbbr"),W("NN",0,0,"eraAbbr"),W("NNN",0,0,"eraAbbr"),W("NNNN",0,0,"eraName"),W("NNNNN",0,0,"eraNarrow"),W("y",["y",1],"yo","eraYear"),W("y",["yy",2],0,"eraYear"),W("y",["yyy",3],0,"eraYear"),W("y",["yyyy",4],0,"eraYear"),U("N",es),U("NN",es),U("NNN",es),U("NNNN",X4),U("NNNNN",Z4),ft(["N","NN","NNN","NNNN","NNNNN"],function(e,i,a,s){var o=a._locale.erasParse(e,s,a._strict);o?K(a).era=o:K(a).invalidEra=e}),U("y",Sn),U("yy",Sn),U("yyy",Sn),U("yyyy",Sn),U("yo",K4),ft(["y","yy","yyy","yyyy"],Rt),ft(["yo"],function(e,i,a,s){var o;a._locale._eraYearOrdinalRegex&&(o=e.match(a._locale._eraYearOrdinalRegex)),a._locale.eraYearOrdinalParse?i[Rt]=a._locale.eraYearOrdinalParse(e,o):i[Rt]=parseInt(e,10)});function R4(e,i){var a,s,o,r=this._eras||ze("en")._eras;for(a=0,s=r.length;a<s;++a){switch(typeof r[a].since){case"string":o=V(r[a].since).startOf("day"),r[a].since=o.valueOf();break}switch(typeof r[a].until){case"undefined":r[a].until=1/0;break;case"string":o=V(r[a].until).startOf("day").valueOf(),r[a].until=o.valueOf();break}}return r}function H4(e,i,a){var s,o,r=this.eras(),c,l,h;for(e=e.toUpperCase(),s=0,o=r.length;s<o;++s)if(c=r[s].name.toUpperCase(),l=r[s].abbr.toUpperCase(),h=r[s].narrow.toUpperCase(),a)switch(i){case"N":case"NN":case"NNN":if(l===e)return r[s];break;case"NNNN":if(c===e)return r[s];break;case"NNNNN":if(h===e)return r[s];break}else if([c,l,h].indexOf(e)>=0)return r[s]}function Y4(e,i){var a=e.since<=e.until?1:-1;return i===void 0?V(e.since).year():V(e.since).year()+(i-e.offset)*a}function V4(){var e,i,a,s=this.localeData().eras();for(e=0,i=s.length;e<i;++e)if(a=this.clone().startOf("day").valueOf(),s[e].since<=a&&a<=s[e].until||s[e].until<=a&&a<=s[e].since)return s[e].name;return""}function U4(){var e,i,a,s=this.localeData().eras();for(e=0,i=s.length;e<i;++e)if(a=this.clone().startOf("day").valueOf(),s[e].since<=a&&a<=s[e].until||s[e].until<=a&&a<=s[e].since)return s[e].narrow;return""}function G4(){var e,i,a,s=this.localeData().eras();for(e=0,i=s.length;e<i;++e)if(a=this.clone().startOf("day").valueOf(),s[e].since<=a&&a<=s[e].until||s[e].until<=a&&a<=s[e].since)return s[e].abbr;return""}function F4(){var e,i,a,s,o=this.localeData().eras();for(e=0,i=o.length;e<i;++e)if(a=o[e].since<=o[e].until?1:-1,s=this.clone().startOf("day").valueOf(),o[e].since<=s&&s<=o[e].until||o[e].until<=s&&s<=o[e].since)return(this.year()-V(o[e].since).year())*a+o[e].offset;return this.year()}function j4(e){return lt(this,"_erasNameRegex")||wo.call(this),e?this._erasNameRegex:this._erasRegex}function W4(e){return lt(this,"_erasAbbrRegex")||wo.call(this),e?this._erasAbbrRegex:this._erasRegex}function q4(e){return lt(this,"_erasNarrowRegex")||wo.call(this),e?this._erasNarrowRegex:this._erasRegex}function es(e,i){return i.erasAbbrRegex(e)}function X4(e,i){return i.erasNameRegex(e)}function Z4(e,i){return i.erasNarrowRegex(e)}function K4(e,i){return i._eraYearOrdinalRegex||Sn}function wo(){var e=[],i=[],a=[],s=[],o,r,c,l,h,u=this.eras();for(o=0,r=u.length;o<r;++o)c=Le(u[o].name),l=Le(u[o].abbr),h=Le(u[o].narrow),i.push(c),e.push(l),a.push(h),s.push(c),s.push(l),s.push(h);this._erasRegex=new RegExp("^("+s.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+i.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+a.join("|")+")","i")}W(0,["gg",2],0,function(){return this.weekYear()%100}),W(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Ei(e,i){W(0,[e,e.length],0,i)}Ei("gggg","weekYear"),Ei("ggggg","weekYear"),Ei("GGGG","isoWeekYear"),Ei("GGGGG","isoWeekYear"),U("G",la),U("g",la),U("GG",bt,Zt),U("gg",bt,Zt),U("GGGG",Ds,Os),U("gggg",Ds,Os),U("GGGGG",ca,ra),U("ggggg",ca,ra),li(["gggg","ggggg","GGGG","GGGGG"],function(e,i,a,s){i[s.substr(0,2)]=nt(e)}),li(["gg","GG"],function(e,i,a,s){i[s]=V.parseTwoDigitYear(e)});function J4(e){return pu.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Q4(e){return pu.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function tx(){return Te(this.year(),1,4)}function ex(){return Te(this.isoWeekYear(),1,4)}function nx(){var e=this.localeData()._week;return Te(this.year(),e.dow,e.doy)}function ix(){var e=this.localeData()._week;return Te(this.weekYear(),e.dow,e.doy)}function pu(e,i,a,s,o){var r;return e==null?hi(this,s,o).year:(r=Te(e,s,o),i>r&&(i=r),ax.call(this,e,i,a,s,o))}function ax(e,i,a,s,o){var r=Zl(e,i,a,s,o),c=di(r.year,0,r.dayOfYear);return this.year(c.getUTCFullYear()),this.month(c.getUTCMonth()),this.date(c.getUTCDate()),this}W("Q",0,"Qo","quarter"),U("Q",Ul),ft("Q",function(e,i){i[Ne]=(nt(e)-1)*3});function sx(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}W("D",["DD",2],"Do","date"),U("D",bt,zn),U("DD",bt,Zt),U("Do",function(e,i){return e?i._dayOfMonthOrdinalParse||i._ordinalParse:i._dayOfMonthOrdinalParseLenient}),ft(["D","DD"],ye),ft("Do",function(e,i){i[ye]=nt(e.match(bt)[0])});var jr=Rn("Date",!0);W("DDD",["DDDD",3],"DDDo","dayOfYear"),U("DDD",ji),U("DDDD",Gl),ft(["DDD","DDDD"],function(e,i,a){a._dayOfYear=nt(e)});function ox(e){var i=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?i:this.add(e-i,"d")}W("m",["mm",2],0,"minute"),U("m",bt,ho),U("mm",bt,Zt),ft(["m","mm"],re);var rx=Rn("Minutes",!1);W("s",["ss",2],0,"second"),U("s",bt,ho),U("ss",bt,Zt),ft(["s","ss"],Oe);var cx=Rn("Seconds",!1);W("S",0,0,function(){return~~(this.millisecond()/100)}),W(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),W(0,["SSS",3],0,"millisecond"),W(0,["SSSS",4],0,function(){return this.millisecond()*10}),W(0,["SSSSS",5],0,function(){return this.millisecond()*100}),W(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),W(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),W(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),W(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),U("S",ji,Ul),U("SS",ji,Zt),U("SSS",ji,Gl);var We,fu;for(We="SSSS";We.length<=9;We+="S")U(We,Sn);function lx(e,i){i[ln]=nt(("0."+e)*1e3)}for(We="S";We.length<=9;We+="S")ft(We,lx);fu=Rn("Milliseconds",!1),W("z",0,0,"zoneAbbr"),W("zz",0,0,"zoneName");function ux(){return this._isUTC?"UTC":""}function dx(){return this._isUTC?"Coordinated Universal Time":""}var $=vi.prototype;$.add=i4,$.calendar=u4,$.clone=d4,$.diff=v4,$.endOf=N4,$.format=w4,$.from=k4,$.fromNow=x4,$.to=S4,$.toNow=M4,$.get=Ck,$.invalidAt=B4,$.isAfter=h4,$.isBefore=p4,$.isBetween=f4,$.isSame=m4,$.isSameOrAfter=g4,$.isSameOrBefore=y4,$.isValid=P4,$.lang=cu,$.locale=ru,$.localeData=lu,$.max=P5,$.min=I5,$.parsingFlags=z4,$.set=wk,$.startOf=A4,$.subtract=a4,$.toArray=T4,$.toObject=E4,$.toDate=L4,$.toISOString=b4,$.inspect=C4,typeof Symbol<"u"&&Symbol.for!=null&&($[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),$.toJSON=I4,$.toString=_4,$.unix=D4,$.valueOf=O4,$.creationData=$4,$.eraName=V4,$.eraNarrow=U4,$.eraAbbr=G4,$.eraYear=F4,$.year=$r,$.isLeapYear=bk,$.weekYear=J4,$.isoWeekYear=Q4,$.quarter=$.quarters=sx,$.month=Rr,$.daysInMonth=Lk,$.week=$.weeks=Rk,$.isoWeek=$.isoWeeks=Hk,$.weeksInYear=nx,$.weeksInWeekYear=ix,$.isoWeeksInYear=tx,$.isoWeeksInISOWeekYear=ex,$.date=jr,$.day=$.days=Qk,$.weekday=t5,$.isoWeekday=e5,$.dayOfYear=ox,$.hour=$.hours=c5,$.minute=$.minutes=rx,$.second=$.seconds=cx,$.millisecond=$.milliseconds=fu,$.utcOffset=G5,$.utc=j5,$.local=W5,$.parseZone=q5,$.hasAlignedHourOffset=X5,$.isDST=Z5,$.isLocal=J5,$.isUtcOffset=Q5,$.isUtc=Gr,$.isUTC=Gr,$.zoneAbbr=ux,$.zoneName=dx,$.dates=ee("dates accessor is deprecated. Use date instead.",jr),$.months=ee("months accessor is deprecated. Use month instead",Rr),$.years=ee("years accessor is deprecated. Use year instead",$r),$.zone=ee("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",F5),$.isDSTShifted=ee("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",K5);function hx(e){return Ct(e*1e3)}function px(){return Ct.apply(null,arguments).parseZone()}function Wr(e){return e}var ct=co.prototype;ct.calendar=Jw,ct.longDateFormat=nk,ct.invalidDate=ak,ct.ordinal=rk,ct.preparse=Wr,ct.postformat=Wr,ct.relativeTime=lk,ct.pastFuture=uk,ct.set=Zw,ct.eras=R4,ct.erasParse=H4,ct.erasConvertYear=Y4,ct.erasAbbrRegex=W4,ct.erasNameRegex=j4,ct.erasNarrowRegex=q4,ct.months=Ak,ct.monthsShort=Nk,ct.monthsParse=Dk,ct.monthsRegex=Ek,ct.monthsShortRegex=Tk,ct.week=Pk,ct.firstDayOfYear=$k,ct.firstDayOfWeek=Bk,ct.weekdays=qk,ct.weekdaysMin=Zk,ct.weekdaysShort=Xk,ct.weekdaysParse=Jk,ct.weekdaysRegex=n5,ct.weekdaysShortRegex=i5,ct.weekdaysMinRegex=a5,ct.isPM=o5,ct.meridiem=l5;function fa(e,i,a,s){var o=ze(),r=Ce().set(s,i);return o[a](r,e)}function mu(e,i,a){if(Ie(e)&&(i=e,e=void 0),e=e||"",i!=null)return fa(e,i,a,"month");var s,o=[];for(s=0;s<12;s++)o[s]=fa(e,s,a,"month");return o}function ko(e,i,a,s){typeof e=="boolean"?(Ie(i)&&(a=i,i=void 0),i=i||""):(i=e,a=i,e=!1,Ie(i)&&(a=i,i=void 0),i=i||"");var o=ze(),r=e?o._week.dow:0,c,l=[];if(a!=null)return fa(i,(a+r)%7,s,"day");for(c=0;c<7;c++)l[c]=fa(i,(c+r)%7,s,"day");return l}function fx(e,i){return mu(e,i,"months")}function mx(e,i){return mu(e,i,"monthsShort")}function gx(e,i,a){return ko(e,i,a,"weekdays")}function yx(e,i,a){return ko(e,i,a,"weekdaysShort")}function vx(e,i,a){return ko(e,i,a,"weekdaysMin")}qe("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var i=e%10,a=nt(e%100/10)===1?"th":i===1?"st":i===2?"nd":i===3?"rd":"th";return e+a}}),V.lang=ee("moment.lang is deprecated. Use moment.locale instead.",qe),V.langData=ee("moment.langData is deprecated. Use moment.localeData instead.",ze);var Se=Math.abs;function _x(){var e=this._data;return this._milliseconds=Se(this._milliseconds),this._days=Se(this._days),this._months=Se(this._months),e.milliseconds=Se(e.milliseconds),e.seconds=Se(e.seconds),e.minutes=Se(e.minutes),e.hours=Se(e.hours),e.months=Se(e.months),e.years=Se(e.years),this}function gu(e,i,a,s){var o=de(i,a);return e._milliseconds+=s*o._milliseconds,e._days+=s*o._days,e._months+=s*o._months,e._bubble()}function bx(e,i){return gu(this,e,i,1)}function Cx(e,i){return gu(this,e,i,-1)}function qr(e){return e<0?Math.floor(e):Math.ceil(e)}function wx(){var e=this._milliseconds,i=this._days,a=this._months,s=this._data,o,r,c,l,h;return e>=0&&i>=0&&a>=0||e<=0&&i<=0&&a<=0||(e+=qr(Is(a)+i)*864e5,i=0,a=0),s.milliseconds=e%1e3,o=te(e/1e3),s.seconds=o%60,r=te(o/60),s.minutes=r%60,c=te(r/60),s.hours=c%24,i+=te(c/24),h=te(yu(i)),a+=h,i-=qr(Is(h)),l=te(a/12),a%=12,s.days=i,s.months=a,s.years=l,this}function yu(e){return e*4800/146097}function Is(e){return e*146097/4800}function kx(e){if(!this.isValid())return NaN;var i,a,s=this._milliseconds;if(e=ie(e),e==="month"||e==="quarter"||e==="year")switch(i=this._days+s/864e5,a=this._months+yu(i),e){case"month":return a;case"quarter":return a/3;case"year":return a/12}else switch(i=this._days+Math.round(Is(this._months)),e){case"week":return i/7+s/6048e5;case"day":return i+s/864e5;case"hour":return i*24+s/36e5;case"minute":return i*1440+s/6e4;case"second":return i*86400+s/1e3;case"millisecond":return Math.floor(i*864e5)+s;default:throw new Error("Unknown unit "+e)}}function Be(e){return function(){return this.as(e)}}var vu=Be("ms"),xx=Be("s"),Sx=Be("m"),Mx=Be("h"),Ax=Be("d"),Nx=Be("w"),Ox=Be("M"),Dx=Be("Q"),Lx=Be("y"),Tx=vu;function Ex(){return de(this)}function Ix(e){return e=ie(e),this.isValid()?this[e+"s"]():NaN}function gn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Px=gn("milliseconds"),zx=gn("seconds"),Bx=gn("minutes"),$x=gn("hours"),Rx=gn("days"),Hx=gn("months"),Yx=gn("years");function Vx(){return te(this.days()/7)}var Me=Math.round,Mn={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Ux(e,i,a,s,o){return o.relativeTime(i||1,!!a,e,s)}function Gx(e,i,a,s){var o=de(e).abs(),r=Me(o.as("s")),c=Me(o.as("m")),l=Me(o.as("h")),h=Me(o.as("d")),u=Me(o.as("M")),m=Me(o.as("w")),g=Me(o.as("y")),b=r<=a.ss&&["s",r]||r<a.s&&["ss",r]||c<=1&&["m"]||c<a.m&&["mm",c]||l<=1&&["h"]||l<a.h&&["hh",l]||h<=1&&["d"]||h<a.d&&["dd",h];return a.w!=null&&(b=b||m<=1&&["w"]||m<a.w&&["ww",m]),b=b||u<=1&&["M"]||u<a.M&&["MM",u]||g<=1&&["y"]||["yy",g],b[2]=i,b[3]=+e>0,b[4]=s,Ux.apply(null,b)}function Fx(e){return e===void 0?Me:typeof e=="function"?(Me=e,!0):!1}function jx(e,i){return Mn[e]===void 0?!1:i===void 0?Mn[e]:(Mn[e]=i,e==="s"&&(Mn.ss=i-1),!0)}function Wx(e,i){if(!this.isValid())return this.localeData().invalidDate();var a=!1,s=Mn,o,r;return typeof e=="object"&&(i=e,e=!1),typeof e=="boolean"&&(a=e),typeof i=="object"&&(s=Object.assign({},Mn,i),i.s!=null&&i.ss==null&&(s.ss=i.s-1)),o=this.localeData(),r=Gx(this,!a,s,o),a&&(r=o.pastFuture(+this,r)),o.postformat(r)}var ns=Math.abs;function wn(e){return(e>0)-(e<0)||+e}function Ii(){if(!this.isValid())return this.localeData().invalidDate();var e=ns(this._milliseconds)/1e3,i=ns(this._days),a=ns(this._months),s,o,r,c,l=this.asSeconds(),h,u,m,g;return l?(s=te(e/60),o=te(s/60),e%=60,s%=60,r=te(a/12),a%=12,c=e?e.toFixed(3).replace(/\.?0+$/,""):"",h=l<0?"-":"",u=wn(this._months)!==wn(l)?"-":"",m=wn(this._days)!==wn(l)?"-":"",g=wn(this._milliseconds)!==wn(l)?"-":"",h+"P"+(r?u+r+"Y":"")+(a?u+a+"M":"")+(i?m+i+"D":"")+(o||s||e?"T":"")+(o?g+o+"H":"")+(s?g+s+"M":"")+(e?g+c+"S":"")):"P0D"}var at=Na.prototype;at.isValid=H5,at.abs=_x,at.add=bx,at.subtract=Cx,at.as=kx,at.asMilliseconds=vu,at.asSeconds=xx,at.asMinutes=Sx,at.asHours=Mx,at.asDays=Ax,at.asWeeks=Nx,at.asMonths=Ox,at.asQuarters=Dx,at.asYears=Lx,at.valueOf=Tx,at._bubble=wx,at.clone=Ex,at.get=Ix,at.milliseconds=Px,at.seconds=zx,at.minutes=Bx,at.hours=$x,at.days=Rx,at.weeks=Vx,at.months=Hx,at.years=Yx,at.humanize=Wx,at.toISOString=Ii,at.toString=Ii,at.toJSON=Ii,at.locale=ru,at.localeData=lu,at.toIsoString=ee("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ii),at.lang=cu,W("X",0,0,"unix"),W("x",0,0,"valueOf"),U("x",la),U("X",fk),ft("X",function(e,i,a){a._d=new Date(parseFloat(e)*1e3)}),ft("x",function(e,i,a){a._d=new Date(nt(e))});V.version="2.30.1",qw(Ct),V.fn=$,V.min=z5,V.max=B5,V.now=$5,V.utc=Ce,V.unix=hx,V.months=fx,V.isDate=yi,V.locale=qe,V.invalid=Sa,V.duration=de,V.isMoment=ue,V.weekdays=gx,V.parseZone=px,V.localeData=ze,V.isDuration=qi,V.monthsShort=mx,V.weekdaysMin=vx,V.defineLocale=go,V.updateLocale=p5,V.locales=f5,V.weekdaysShort=yx,V.normalizeUnits=ie,V.relativeTimeRounding=Fx,V.relativeTimeThreshold=jx,V.calendarFormat=l4,V.prototype=$,V.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const qx=async function(e,i,a){const s=e.groups;s.push(a);let o=s.map(r=>encodeURIComponent(r));return o=o.filter(r=>r!==encodeURIComponent(i)),ce.patch(e.url,{},{headers:{"X-PROPERTY":"CATEGORIES","X-PROPERTY-REPLACE":o.join(",")}})},Xx=async function(e,i){let a=e.groups.map(s=>encodeURIComponent(s));return a=a.filter(s=>s!==encodeURIComponent(i)),ce.patch(e.url,{},{headers:{"X-PROPERTY":"CATEGORIES","X-PROPERTY-REPLACE":a.join(",")}})},Zx={name:"FolderEditOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Kx=function(){var e=this,i=e._self._c;return i("span",e._b({staticClass:"material-design-icon folder-edit-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[i("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M4 18H12.13L11 19.13V20H4C2.9 20 2 19.11 2 18V6C2 4.89 2.89 4 4 4H10L12 6H20C21.1 6 22 6.89 22 8V10.15C21.74 10.06 21.46 10 21.17 10C20.75 10 20.36 10.11 20 10.3V8H4V18M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96Z"}},[e.title?i("title",[e._v(e._s(e.title))]):e._e()])])])},Jx=[],Qx=H(Zx,Kx,Jx,!1,null,null);const t3=Qx.exports,e3={name:"GroupNavigationItem",components:{ActionButton:Ke,NcCounterBubble:_a,AppNavigationItem:Hs,ActionInput:Ys,IconContact:mn,IconAdd:mi,IconDownload:xa,IconEmail:uc,IconRename:t3,IconDelete:Pe,IconLoading:Jt},props:{group:{type:Object,required:!0}},data(){return{newGroupName:"",renaming:!1,deleting:!1}},computed:{contacts(){return this.$store.getters.getContacts},isEmpty(){return this.group.contacts.length===0}},methods:{isInGroup(e,i){return e.includes(i)},async onDrop(e,i){try{const a=JSON.parse(e.dataTransfer.getData("item")),s=this.$store.getters.getContact(ne.from(`${a.uid}~${a.addressbookId}`,"utf-8").toString("base64"));if(s&&!this.isInGroup(s.groups,i.id)){const o=this.$store.getters.getContact(ne.from(`${a.uid}~${a.addressbookId}`,"utf-8").toString("base64"));await this.$store.dispatch("updateContactGroups",{groupNames:[...s.groups,i.id],contact:o});const r=Object.assign(Object.create(Object.getPrototypeOf(o)),o);r.groups=[...s.groups,i.id],await this.$store.dispatch("updateContact",r)}}catch(a){console.error(a),tt("Tried to drop an invalid contact!")}finally{e.target.closest(".group-drop-area").removeAttribute("drop-active")}},onDragOver(e){e.preventDefault(),e.target.closest(".group-drop-area").setAttribute("drop-active",!0)},onDragLeave(e){e.target.closest(".group-drop-area").removeAttribute("drop-active")},addContactsToGroup(){De("contacts:group:append",this.group.name)},downloadGroup(e){let i={};e.contacts.forEach(s=>{const o=this.contacts[s].addressbook.id;i=Object.assign({[o]:{addressbook:this.contacts[s].addressbook,contacts:[]}},i),i[o].contacts.push(this.contacts[s].url)});const a=Promise.all(Object.keys(i).map(s=>i[s].addressbook.dav.addressbookMultigetExport(i[s].contacts))).then(s=>({groupName:e.name,data:s.map(o=>o.body).join("")}));this.downloadVcardPromise(a)},async downloadVcardPromise(e){e.then(i=>{const a=V().format("YYYY-MM-DD_HH-mm")+"_"+i.groupName+".vcf",s="data:text/plain;charset=utf-8,"+window.encodeURIComponent(i.data);Ww(s,a,"text/vcard")})},emailGroup(e,i="to"){const a=[];e.contacts.filter(s=>this.contacts[s].email!==null).forEach(s=>{const o=this.contacts[s].email.replace(/(.*<)([^>]*)(>)/g,"$2").trim(),r=this.contacts[s].fullName.replace(/[,<>]/g,"").trim();if(o!==""){if(r===null||r===""){a.push(o);return}a.push(`${r} <${o}>`)}}),window.location.href=`mailto:?${i}=${a.map(encodeURIComponent).join(",")}`},async renameGroup(){if(this.newGroupName!==""){this.renaming=!0;for(const e of this.group.contacts){const i=this.$store.getters.getContact(e);if(i===void 0)return;try{await qx(i,this.group.name,this.newGroupName)}catch(a){console.error("Error renaming group",a)}}this.$store.commit("renameGroup",{oldGroupName:this.group.name,newGroupName:this.newGroupName}),this.renaming=!1}},async deleteGroup(){this.deleting=!0;for(const e of this.group.contacts){const i=this.$store.getters.getContact(e);if(i===void 0)return;try{await Xx(i,this.group.name)}catch(a){console.error("Error deleting group",a)}}this.$store.commit("removeGroup",this.group.name),this.deleting=!1}}};var n3=function(){var e=this,i=e._self._c;return e.isEmpty?e._e():i("div",{staticClass:"group-drop-area",attrs:{"data-testid":"group-drop-area"},on:{drop:function(a){return e.onDrop(a,e.group)},dragenter:function(a){a.preventDefault()},dragover:function(a){return e.onDragOver(a)},dragleave:function(a){return e.onDragLeave(a)}}},[i("AppNavigationItem",{key:e.group.key,attrs:{to:e.group.router,name:e.group.name},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0},{key:"actions",fn:function(){return[i("ActionButton",{attrs:{"close-after-click":!0},on:{click:function(a){return e.addContactsToGroup(e.group)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2388353250)},[e._v(" "+e._s(e.t("contacts","Add contacts"))+" ")]),i("ActionInput",{attrs:{value:e.newGroupName,disabled:e.renaming},on:{"update:value":function(a){e.newGroupName=a},submit:e.renameGroup},scopedSlots:e._u([{key:"icon",fn:function(){return[e.renaming?i("IconLoading",{attrs:{size:20}}):i("IconRename",{attrs:{size:20}})]},proxy:!0}],null,!1,1268619769)},[e._v(" "+e._s(e.t("contacts","Rename"))+" ")]),i("ActionButton",{attrs:{"close-after-click":!0},on:{click:function(a){return e.downloadGroup(e.group)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconDownload",{attrs:{size:20}})]},proxy:!0}],null,!1,2487097783)},[e._v(" "+e._s(e.t("contacts","Export"))+" ")]),i("ActionButton",{on:{click:function(a){return e.emailGroup(e.group)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconEmail",{attrs:{size:20}})]},proxy:!0}],null,!1,984773423)},[e._v(" "+e._s(e.t("contacts","Send email"))+" ")]),i("ActionButton",{on:{click:function(a){return e.emailGroup(e.group,"bcc")}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconEmail",{attrs:{size:20}})]},proxy:!0}],null,!1,984773423)},[e._v(" "+e._s(e.t("contacts","Send email as BCC"))+" ")]),i("ActionButton",{attrs:{disabled:e.deleting},on:{click:e.deleteGroup},scopedSlots:e._u([{key:"icon",fn:function(){return[e.deleting?i("IconLoading",{attrs:{size:20}}):i("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,411196473)},[e._v(" "+e._s(e.t("contacts","Delete"))+" ")])]},proxy:!0},{key:"counter",fn:function(){return[e.group.contacts.length>0?i("NcCounterBubble",[e._v(" "+e._s(e.group.contacts.length)+" ")]):e._e()]},proxy:!0}],null,!1,2818531691)})],1)},i3=[],a3=H(e3,n3,i3,!1,null,"eb625904");const s3=a3.exports,o3={name:"NewCircleIntro",components:{CheckboxRadioSwitch:fi,Modal:Je},props:{loading:{type:Boolean,default:!1}},data(){return{circleName:"",isPersonal:!1,isLocal:!1,CIRCLE_DESC:fc}},computed:{isEmptyName(){return this.circleName.trim()===""},isGlobalScale(){return _d().circles?.status?.globalScale!==!1}},mounted(){this.$nextTick(()=>{this.$refs.input.focus(),this.$refs.input.select()})},methods:{onCancel(){this.$emit("close")},onSubmit(){this.$emit("submit",this.circleName,this.isPersonal,this.isLocal)}}};var r3=function(){var e=this,i=e._self._c;return i("Modal",{attrs:{size:"normal"},on:{close:e.onCancel}},[i("div",{staticClass:"entity-picker"},[i("div",{staticClass:"entity-picker__new"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.circleName,expression:"circleName"}],ref:"input",staticClass:"entity-picker__new-input",attrs:{placeholder:e.t("contacts","New team name"),type:"text"},domProps:{value:e.circleName},on:{keypress:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.onSubmit.apply(null,arguments)},input:function(a){a.target.composing||(e.circleName=a.target.value)}}})]),i("div",{staticClass:"entity-picker__content"},[i("p",[e._v(" "+e._s(e.CIRCLE_DESC))]),i("br"),e._e(),e.isGlobalScale?[i("CheckboxRadioSwitch",{attrs:{checked:e.isLocal,disabled:e.loading!==!1},on:{"update:checked":function(a){e.isLocal=a}}},[e._v(" "+e._s(e.t("contacts","Local team"))+" ")]),i("p",[e._v(" "+e._s(e.t("contacts","This team will not be shared with the other instances of the global scale"))+" ")])]:e._e()],2),i("div",{staticClass:"entity-picker__navigation"},[i("button",{staticClass:"navigation__button-left",attrs:{disabled:e.loading},on:{click:e.onCancel}},[e._v(" "+e._s(e.t("contacts","Cancel"))+" ")]),i("button",{staticClass:"navigation__button-right primary",attrs:{disabled:e.isEmptyName||e.loading},on:{click:e.onSubmit}},[e._v(" "+e._s(e.t("contacts","Create team"))+" ")])])])])},c3=[],l3=H(o3,r3,c3,!1,null,"7a3f4598");const u3=l3.exports,d3=hn("contacts","isContactsInteractionEnabled",!1),h3={name:"IconRecentlyContacted",props:{title:{type:String,default:""},size:{type:Number,default:20},fillColor:{type:String,default:"currentColor"}}};var p3=function(e,i){return e("span",i._g(i._b({staticClass:"material-design-icon icon-recently-contacted",class:[i.data.class,i.data.staticClass],attrs:{"aria-hidden":!i.props.title,"aria-label":i.props.title,role:"img"}},"span",i.data.attrs,!1),i.listeners),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:i.props.fillColor,width:i.props.size,height:i.props.size,viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M0 0h24v24H0V0z",fill:"none"}}),e("path",{attrs:{d:"M14 3v10h1V3zM12 13h1V3h-1zM1.7 3a.7.7 0 00-.7.7v8.6c0 .4.3.7.7.7h8.6c.4 0 .7-.3.7-.7V3.7a.7.7 0 00-.7-.7zM6 5a1.6 1.6 0 010 3.2A1.6 1.6 0 016 5zm0 4.4c1 0 3.2.6 3.2 1.6v.6H2.8V11c0-1 2.1-1.6 3.2-1.6z"}})])])},f3=[],m3=H(h3,p3,f3,!0,null,null);const g3=m3.exports,y3={name:"RootNavigation",components:{ActionInput:Ys,ActionText:Bs,NcActionButton:Ke,AppNavigation:Mh,NcCounterBubble:_a,AppNavigationItem:Hs,AppNavigationCaption:Lh,CircleNavigationItem:RC,Cog:js,ContactsSettings:Fw,GroupNavigationItem:s3,IconContact:mn,IconUser:ai,IconAdd:mi,IconError:Pl,IconLoading:Jt,IconRecentlyContacted:g3,NewCircleIntro:u3},mixins:[Qe],props:{loading:{type:Boolean,default:!0},contactsList:{type:Array,required:!0}},data(){return{CIRCLE_DESC:fc,CONTACTS_SETTINGS:pc,ELLIPSIS_COUNT:Ba,GROUP_ALL_CONTACTS:zi,CHART_ALL_CONTACTS:Fd,GROUP_NO_GROUP_CONTACTS:Bi,GROUP_RECENTLY_CONTACTED:$a,isNewGroupMenuOpen:!1,createGroupError:null,isNewCircleModalOpen:!1,createCircleLoading:!1,createCircleError:null,isCirclesEnabled:os,isContactsInteractionEnabled:d3,collapsedGroups:!0,collapsedCircles:!0,showSettings:!1}},computed:{circles(){return this.$store.getters.getCircles},contacts(){return this.$store.getters.getContacts},groups(){return this.$store.getters.getGroups},sortedContacts(){return this.$store.getters.getSortedContacts},ungroupedContacts(){return this.sortedContacts.filter(e=>this.contacts[e.key].groups&&this.contacts[e.key].groups.length===0)},existChart(){return!!Object.keys(this.contacts).filter(e=>this.contacts[e].managersName).length},groupsMenu(){const e=this.groups.map(a=>Object.assign({},a,{id:a.name.replace(" ","_"),key:a.name.replace(" ","_"),router:{name:"group",params:{selectedGroup:a.name}},toString:()=>a.name}));e.sort((a,s)=>Ss(a.toString(),s.toString(),{caseInsensitive:!0}));const i=e.findIndex(a=>a.name===$a);return i>=0&&e.splice(i,1),e},ellipsisGroupsMenu(){return this.isCirclesEnabled&&this.collapsedGroups?this.groupsMenu.slice(0,Ba):this.groupsMenu},circlesMenu(){const e=this.circles||[];return e.sort((i,a)=>i?.initiator?.level!==a?.initiator?.level&&i?.initiator?.level&&a?.initiator?.level?a.initiator.level-i.initiator.level:i.initiator&&!a.initiator?-1:!i.initiator&&a.initiator?1:Ss(i.toString(),a.toString(),{caseInsensitive:!0})),e},ellipsisCirclesMenu(){return this.collapsedCircles?this.circlesMenu.slice(0,Ba):this.circlesMenu},recentlyContactedContacts(){return this.groups.find(e=>e.name===$a)},collapseGroupsTitle(){return this.collapsedGroups?t("contacts","Show all groups"):t("contacts","Collapse groups")},collapseCirclesTitle(){return this.collapsedCircles?t("contacts","Show all teams"):t("contacts","Collapse teams")}},methods:{toggleNewGroupMenu(){this.isNewGroupMenuOpen=!this.isNewGroupMenuOpen},createNewGroup(e){const i=e.target.querySelector("input[type=text]").value.trim();if(i.length===0){tt(t("contacts","Group name cannot be empty"));return}if(this.logger.debug("Creating new group",{groupName:i}),this.groups.find(a=>a.name===i)){this.createGroupError=t("contacts","This group already exists"),De("contacts:group:append",this.groups.find(a=>a.name===i).name);return}this.createGroupError=null,this.logger.debug("Created new local group",{groupName:i});try{this.$store.dispatch("addGroup",i),this.isNewGroupMenuOpen=!1,De("contacts:group:append",i)}catch{tt(t("contacts","An error occurred while creating the group"))}},onToggleGroups(){this.collapsedGroups=!this.collapsedGroups},onToggleCircles(){this.collapsedCircles=!this.collapsedCircles},toggleNewCircleModal(){this.isNewCircleModalOpen=!0},async createNewCircle(e,i,a){if(this.logger.debug("Creating new team",{circleName:e}),this.createCircleLoading=!0,this.circles.find(s=>s.name===e)){this.createCircleError=t("contacts","This team already exists");return}this.createCircleError=null;try{const s=await this.$store.dispatch("createCircle",{circleName:e,isPersonal:i,isLocal:a});this.closeNewCircleIntro(),this.$router.push({name:"circle",params:{selectedCircle:s.id}})}catch{tt(t("contacts","An error happened during the creation of the team"))}finally{this.createCircleLoading=!1}},closeNewCircleIntro(){this.isNewCircleModalOpen=!1},showContactsSettings(){this.showSettings=!0}}};var v3=function(){var e=this,i=e._self._c;return i("AppNavigation",{scopedSlots:e._u([{key:"icon",fn:function(){return[e.loading?i("IconLoading",{attrs:{size:20}}):e._e()]},proxy:!0},{key:"search",fn:function(){return[i("header",{staticClass:"header"},[e._t("default")],2)]},proxy:!0},{key:"list",fn:function(){return[i("AppNavigationItem",{attrs:{id:"everyone",name:e.GROUP_ALL_CONTACTS,to:{name:"group",params:{selectedGroup:e.GROUP_ALL_CONTACTS}}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconContact",{attrs:{size:20}})]},proxy:!0},{key:"counter",fn:function(){return[e.sortedContacts.length?i("NcCounterBubble",[e._v(" "+e._s(e.sortedContacts.length)+" ")]):e._e()]},proxy:!0}])}),e.existChart?i("AppNavigationItem",{attrs:{id:"chart",name:e.CHART_ALL_CONTACTS,to:{name:"chart",params:{selectedChart:e.GROUP_ALL_CONTACTS}},icon:"icon-category-monitoring"}}):e._e(),e.ungroupedContacts.length>0?i("AppNavigationItem",{attrs:{id:"notgrouped",name:e.GROUP_NO_GROUP_CONTACTS,to:{name:"group",params:{selectedGroup:e.GROUP_NO_GROUP_CONTACTS}}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconUser",{attrs:{size:20}})]},proxy:!0},{key:"counter",fn:function(){return[e.ungroupedContacts.length?i("NcCounterBubble",[e._v(" "+e._s(e.ungroupedContacts.length)+" ")]):e._e()]},proxy:!0}],null,!1,754420496)}):e._e(),e.isContactsInteractionEnabled&&e.recentlyContactedContacts&&e.recentlyContactedContacts.contacts.length>0?i("AppNavigationItem",{attrs:{id:"recentlycontacted",name:e.GROUP_RECENTLY_CONTACTED,to:{name:"group",params:{selectedGroup:e.GROUP_RECENTLY_CONTACTED}}},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconRecentlyContacted",{attrs:{size:20}})]},proxy:!0},{key:"counter",fn:function(){return[e.recentlyContactedContacts.contacts.length?i("NcCounterBubble",[e._v(" "+e._s(e.recentlyContactedContacts.contacts.length)+" ")]):e._e()]},proxy:!0}],null,!1,1951174078)}):e._e(),i("AppNavigationCaption",{attrs:{id:"newgroup","force-menu":!0,"menu-open":e.isNewGroupMenuOpen,name:e.t("contacts","Contact groups")},on:{"update:menuOpen":function(a){e.isNewGroupMenuOpen=a},"update:menu-open":function(a){e.isNewGroupMenuOpen=a},click:function(a){return a.preventDefault(),a.stopPropagation(),e.toggleNewGroupMenu.apply(null,arguments)}},scopedSlots:e._u([{key:"actionsTriggerIcon",fn:function(){return[i("IconAdd",{attrs:{size:20}})]},proxy:!0},{key:"actions",fn:function(){return[i("ActionText",{directives:[{name:"show",rawName:"v-show",value:e.isNewGroupMenuOpen,expression:"isNewGroupMenuOpen"}],scopedSlots:e._u([{key:"icon",fn:function(){return[e.createGroupError?i("IconError",{attrs:{size:20}}):e.createGroupError?e._e():i("IconContact",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.createGroupError?e.createGroupError:e.t("contacts","Create a new contact group"))+" ")]),i("ActionInput",{directives:[{name:"show",rawName:"v-show",value:e.isNewGroupMenuOpen,expression:"isNewGroupMenuOpen"}],attrs:{icon:"",placeholder:e.t("contacts","Contact group name")},on:{submit:function(a){return a.preventDefault(),a.stopPropagation(),e.createNewGroup.apply(null,arguments)}}})]},proxy:!0}])}),e._l(e.ellipsisGroupsMenu,function(a){return i("GroupNavigationItem",{key:a.key,attrs:{group:a}})}),e.isCirclesEnabled?[e.groupsMenu.length>e.ELLIPSIS_COUNT?i("AppNavigationItem",{staticClass:"app-navigation__collapse",attrs:{name:e.collapseGroupsTitle,icon:""},on:{click:e.onToggleGroups}}):e._e(),i("AppNavigationCaption",{attrs:{id:"newcircle",name:e.t("contacts","Teams")},scopedSlots:e._u([{key:"actions",fn:function(){return[i("NcActionButton",{on:{click:e.toggleNewCircleModal},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2388353250)},[e._v(" "+e._s(e.t("contacts","Create a new team"))+" ")])]},proxy:!0}],null,!1,640863801)}),e.isNewCircleModalOpen?i("NewCircleIntro",{attrs:{loading:e.createCircleLoading},on:{close:e.closeNewCircleIntro,submit:e.createNewCircle}}):e._e(),e.circlesMenu.length>0?[e._l(e.ellipsisCirclesMenu,function(a){return i("CircleNavigationItem",{key:a.key,attrs:{circle:a}})}),e.circlesMenu.length>e.ELLIPSIS_COUNT?i("AppNavigationItem",{staticClass:"app-navigation__collapse",attrs:{name:e.collapseCirclesTitle,icon:""},on:{click:e.onToggleCircles}}):e._e()]:e._e(),i("p",{staticClass:"app-navigation__circle-desc"},[e._v(" "+e._s(e.CIRCLE_DESC)+" ")])]:e._e()]},proxy:!0},{key:"footer",fn:function(){return[i("div",{staticClass:"contacts-settings"},[i("AppNavigationItem",{attrs:{"aria-label":e.t("contacts","Open the contacts app settings"),name:e.CONTACTS_SETTINGS},on:{click:e.showContactsSettings}},[i("Cog",{attrs:{slot:"icon",size:20},slot:"icon"})],1)],1)]},proxy:!0}],null,!0)},[i("ContactsSettings",{attrs:{open:e.showSettings},on:{"update:open":function(a){e.showSettings=a}}})],1)},_3=[],b3=H(y3,v3,_3,!1,null,"2eae7908");const C3=b3.exports,w3={name:"Contacts",components:{Button:Ht,CircleContent:qf,ChartContent:vv,ContactsContent:Qb,ContactsPicker:fC,Content:bd,ImportView:_C,IconAdd:mi,Modal:Je,RootNavigation:C3,SettingsImportContacts:zl},mixins:[va,Qe],data(){return{appName:Xr,loadingCircles:os,loadingContacts:!0}},computed:{addressbooks(){return this.$store.getters.getAddressbooks},contacts(){return this.$store.getters.getContacts},sortedContacts(){return this.$store.getters.getSortedContacts},groups(){return this.$store.getters.getGroups},circles(){return this.$store.getters.getCircles},orderKey(){return this.$store.getters.getOrderKey},importState(){return this.$store.getters.getImportState},isEmptyGroup(){return this.contactsList.length===0},isChartView(){return!!this.selectedChart},isImporting(){return this.importState.stage!=="default"},isImportDone(){return this.importState.stage==="done"},defaultAddressbook(){return this.addressbooks.find(e=>!e.readOnly&&e.enabled)},contactsList(){if(this.selectedGroup===zi)return this.sortedContacts;if(this.selectedGroup===Bi)return this.ungroupedContacts.map(i=>this.sortedContacts.find(a=>a.key===i.key));if(this.selectedGroup===$i)return[];const e=this.groups.filter(i=>i.name===this.selectedGroup)[0];return e?this.sortedContacts.filter(i=>e.contacts.indexOf(i.key)>=0):[]},isCirclesView(){return this.selectedGroup===$i},ungroupedContacts(){return this.sortedContacts.filter(e=>this.contacts[e.key].groups&&this.contacts[e.key].groups.length===0)}},watch:{selectedGroup(){!this.isMobile&&!this.selectedChart&&this.selectFirstContactIfNone()},selectedContact(){!this.isMobile&&!this.selectedChart&&this.selectFirstContactIfNone()}},mounted(){this.isCirclesEnabled?this.logger.info("Circles frontend enabled"):this.logger.info("No compatible version of circles found")},async beforeMount(){Pi.connect({enableCardDAV:!0}).then(()=>{this.logger.debug("Connected to dav!",{client:Pi}),hc().setCurrentUserPrincipal(Pi),this.$store.dispatch("getAddressbooks").then(e=>{e.filter(i=>!i.readOnly).length===0?this.$store.dispatch("appendAddressbook",{displayName:t("contacts","Contacts")}).then(()=>{this.fetchContacts()}):this.fetchContacts()}),localStorage.getItem("orderKey")&&this.$store.commit("setOrder",localStorage.getItem("orderKey"))}),os&&this.$store.dispatch("getCircles").then(()=>{this.loadingCircles=!1})},methods:{async newContact(){if(this.isCirclesView){De("contacts:circles:append",this.selectedCircle.id);return}const e=new Us(`
				BEGIN:VCARD
				VERSION:4.0
				PRODID:-//Nextcloud Contacts v${Zr}
				END:VCARD
			`.trim().replace(/\t/gm,""),this.defaultAddressbook);e.fullName=t("contacts","Name"),e.rev=Rs.Time.fromJSDate(new Date,!0);const i=ve.properties;for(const a in i)if(i[a].default){const s=i[a].defaultValue;let o=s.value;Array.isArray(o)&&(o=[...o]);const r=e.vCard.addPropertyWithValue(a,o);s.type&&r.setParameter("type",s.type)}[zi,Bi].indexOf(this.selectedGroup)===-1&&(e.groups=[this.selectedGroup]);try{await this.$store.dispatch("addContact",e),await this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:e.key}})}catch(a){tt(t("contacts","Unable to create the contact.")),console.error(a)}},updateSorting(e="displayName"){this.$store.commit("setOrder",e),this.$store.commit("sortContacts")},fetchContacts(){Promise.all(this.addressbooks.map(e=>e.enabled?this.$store.dispatch("getContactsFromAddressBook",{addressbook:e}):Promise.resolve())).then(()=>{this.loadingContacts=!1,!this.isMobile&&!this.selectedChart&&this.selectFirstContactIfNone()})},selectFirstContactIfNone(){if(this.$route.name==="import")return;const e=this.contactsList.findIndex(i=>i.key===this.selectedContact)>-1;if(!this.selectedContact||!e){if(this.selectedContact&&!e&&(tt(t("contacts","Contact not found")),this.$router.push({name:"group",params:{selectedGroup:this.selectedGroup}})),!this.selectedCircle&&!this.groups.find(i=>i.name===this.selectedGroup)&&zi!==this.selectedGroup&&Bi!==this.selectedGroup&&$i!==this.selectedGroup){tt(t("contacts","Group {group} not found",{group:this.selectedGroup})),console.error("Group not found",this.selectedGroup),this.$router.push({name:"root"});return}Object.keys(this.contactsList).length&&this.$router.push({name:"contact",params:{selectedGroup:this.selectedGroup,selectedContact:Object.values(this.contactsList)[0].key}})}},closeImport(){this.$store.dispatch("changeStage","default")}}};var k3=function(){var e=this,i=e._self._c;return i("Content",{attrs:{"app-name":e.appName}},[i("RootNavigation",{attrs:{"contacts-list":e.contactsList,loading:e.loadingContacts||e.loadingCircles,"selected-group":e.selectedGroup,"selected-contact":e.selectedContact}},[i("div",{staticClass:"import-and-new-contact-buttons"},[!e.loadingContacts&&e.isEmptyGroup&&!e.isChartView&&!e.isCirclesView?i("SettingsImportContacts"):e._e(),e.loadingContacts?e._e():i("Button",{attrs:{disabled:!e.defaultAddressbook,type:"secondary",wide:""},on:{click:e.newContact},scopedSlots:e._u([{key:"icon",fn:function(){return[i("IconAdd",{attrs:{size:20}})]},proxy:!0}],null,!1,2388353250)},[e._v(" "+e._s(e.isCirclesView?e.t("contacts","Add member"):e.t("contacts","New contact"))+" ")])],1)]),e.selectedCircle?i("CircleContent",{attrs:{loading:e.loadingCircles}}):e.selectedChart?i("ChartContent",{attrs:{"contacts-list":e.contacts}}):i("ContactsContent",{attrs:{"contacts-list":e.contactsList,loading:e.loadingContacts},on:{"new-contact":e.newContact}}),e.isImporting?i("Modal",{attrs:{"clear-view-delay":-1,"can-close":e.isImportDone},on:{close:e.closeImport}},[i("ImportView",{on:{close:e.closeImport}})],1):e._e(),i("ContactsPicker")],1)},x3=[],S3=H(w3,k3,x3,!1,null,"626a7b8e");const kn=S3.exports;Yt.use(ic);const Zi=new ic({mode:"history",base:ga("/apps/contacts",""),linkActiveClass:"active",routes:[{path:"/",component:kn,props:!0,name:"root",redirect:{name:"group",params:{selectedGroup:t("contacts","All contacts")}},children:[{path:`/${jd}/:selectedChart`,name:"chart",component:kn},{path:"import",name:"import",component:kn},{path:`${$i}/:selectedCircle`,name:"circle",component:kn},{path:":selectedGroup",name:"group",component:kn},{path:":selectedGroup/:selectedContact",name:"contact",component:kn}]}]});Yt.use(Wd);const M3=qd();Yt.directive("Tooltip",Cd),Zd(Xo,Zi),Yt.prototype.t=t,Yt.prototype.n=n,Yt.prototype.appName=Xr,Yt.prototype.appVersion=Zr,Yt.prototype.logger=cc,Yt.prototype.OC=window.OC,Yt.prototype.OCA=window.OCA,window.location.pathname.split("/")[1]==="index.php"&&window.OC.config.modRewriteWorking&&Zi.push({name:"group",params:{selectedGroup:t("contacts","All contacts")}}),new Yt({el:"#content",name:"ContactsApp",router:Zi,store:Xo,render:e=>e(eh),pinia:M3});
//# sourceMappingURL=contacts-main.mjs.map
